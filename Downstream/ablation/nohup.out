2025-03-20 20:55:50,013 - Starting repeat 0
Processing datasets for repeat 0:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-20 20:55:50,014 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10
[I 2025-03-20 20:56:18,145] A new study created in memory with name: no-name-fceba53d-8b09-473e-bd79-7b9c65ccbd5b
[I 2025-03-20 20:56:24,126] Trial 0 finished with value: 1.0013632774353027 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 1.0013632774353027.
[I 2025-03-20 20:56:29,453] Trial 1 finished with value: 0.7415341138839722 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7415341138839722.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:56:31,896] A new study created in memory with name: no-name-625843f0-320b-4b1c-ae81-14b490207e53
[I 2025-03-20 20:56:41,767] Trial 0 finished with value: 0.785085141658783 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.785085141658783.
[I 2025-03-20 20:56:48,777] Trial 1 finished with value: 0.8055115938186646 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.785085141658783.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:56:50,848] A new study created in memory with name: no-name-070b164e-ecbc-4db7-a2fe-a4fcca8d375e
[I 2025-03-20 20:56:55,645] Trial 0 finished with value: 0.748207688331604 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.748207688331604.
[I 2025-03-20 20:57:00,044] Trial 1 finished with value: 0.7081115245819092 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7081115245819092.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:57:01,963] A new study created in memory with name: no-name-beb1ec07-031c-466a-b0f5-0e5682e153bf
[I 2025-03-20 20:57:05,266] Trial 0 finished with value: 0.7418341636657715 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7418341636657715.
[I 2025-03-20 20:57:09,713] Trial 1 finished with value: 0.7884353995323181 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7418341636657715.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:57:11,638] A new study created in memory with name: no-name-6ede37d8-3968-4d23-a711-4d76c0b93b4e
[I 2025-03-20 20:57:16,786] Trial 0 finished with value: 0.780958354473114 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.780958354473114.
[I 2025-03-20 20:57:21,150] Trial 1 finished with value: 0.807841956615448 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.780958354473114.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:57:23,087] A new study created in memory with name: no-name-74f15608-d9b3-4c0d-93fb-9b0465dbb7ea
[I 2025-03-20 20:57:26,306] Trial 0 finished with value: 0.7888789772987366 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7888789772987366.
[I 2025-03-20 20:57:31,418] Trial 1 finished with value: 0.7888696789741516 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7888696789741516.
... storing 'Rank_Label' as categorical
2025-03-20 20:57:33,320 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10
Processing datasets for repeat 0:  10%|█         | 1/10 [01:43<15:29, 103.31s/it]2025-03-20 20:57:33,322 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9
[I 2025-03-20 20:58:07,789] A new study created in memory with name: no-name-931cf3ad-f0ea-44e7-8736-f81b52d8f83b
[I 2025-03-20 20:58:11,115] Trial 0 finished with value: 0.7258363366127014 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7258363366127014.
[I 2025-03-20 20:58:16,347] Trial 1 finished with value: 0.712119460105896 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.712119460105896.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 1.0014
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7415
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 15(3.50%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7851
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 13(3.03%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7482
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7081
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 5 components.
Reject 344(80.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7418
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7810
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 124(28.90%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7889
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7889
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7258
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7121
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:58:18,474] A new study created in memory with name: no-name-084db391-a1bb-47cc-acc5-bf85e81edce0
[I 2025-03-20 20:58:25,654] Trial 0 finished with value: 0.807796835899353 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.807796835899353.
[I 2025-03-20 20:58:30,913] Trial 1 finished with value: 0.708808958530426 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 1 with value: 0.708808958530426.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:58:32,898] A new study created in memory with name: no-name-9101e74f-8922-4498-9b1b-7466de00487a
[I 2025-03-20 20:58:36,272] Trial 0 finished with value: 0.7713267803192139 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7713267803192139.
[I 2025-03-20 20:58:39,062] Trial 1 finished with value: 0.8147287368774414 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7713267803192139.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:58:40,987] A new study created in memory with name: no-name-bc9d9457-81f0-4261-b8ee-f9d41574f833
[I 2025-03-20 20:58:43,742] Trial 0 finished with value: 0.7631946802139282 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7631946802139282.
[I 2025-03-20 20:58:46,622] Trial 1 finished with value: 0.7594331502914429 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7594331502914429.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:58:48,637] A new study created in memory with name: no-name-6bb0057e-06e2-4329-8c52-8275d76af1c5
[I 2025-03-20 20:58:51,270] Trial 0 finished with value: 0.8199859857559204 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8199859857559204.
[I 2025-03-20 20:58:55,194] Trial 1 finished with value: 0.8262131810188293 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8199859857559204.
... storing 'Rank_Label' as categorical
[I 2025-03-20 20:58:57,285] A new study created in memory with name: no-name-92a9dfdb-f3fe-4c55-b340-f7ec103e12ba
[I 2025-03-20 20:59:02,029] Trial 0 finished with value: 0.8253615498542786 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8253615498542786.
[I 2025-03-20 20:59:05,850] Trial 1 finished with value: 0.7285819053649902 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7285819053649902.
... storing 'Rank_Label' as categorical
2025-03-20 20:59:07,757 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9
Processing datasets for repeat 0:  20%|██        | 2/10 [03:17<13:04, 98.09s/it] 2025-03-20 20:59:07,759 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8
[I 2025-03-20 21:09:13,081] A new study created in memory with name: no-name-30b563a3-5386-45cb-ac7d-6987253ae1bc
[I 2025-03-20 21:14:55,927] Trial 0 finished with value: 0.7408097826916239 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7408097826916239.
[I 2025-03-20 21:18:19,159] Trial 1 finished with value: 0.5884913853977037 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 1 with value: 0.5884913853977037.
... storing 'Rank_Label' as categorical
[I 2025-03-20 21:20:07,408] A new study created in memory with name: no-name-1c896715-ad89-42bf-b1f0-16628a87596c
[I 2025-03-20 21:23:39,314] Trial 0 finished with value: 0.8020929383194965 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8020929383194965.
[I 2025-03-20 21:27:10,559] Trial 1 finished with value: 0.5772422085637632 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.5772422085637632.
... storing 'Rank_Label' as categorical
Reject 30(6.99%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8078
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7088
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 68(15.85%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7713
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7632
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7594
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8200
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8254
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7286
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7408
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5885
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8021
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5772
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 10815(46.15%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-20 21:28:57,998] A new study created in memory with name: no-name-0578b62d-b789-4a2d-ab9a-45000b27b5ba
[I 2025-03-20 21:32:42,369] Trial 0 finished with value: 0.7265511440194171 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7265511440194171.
[I 2025-03-20 21:38:02,207] Trial 1 finished with value: 0.5767051085181858 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.5767051085181858.
... storing 'Rank_Label' as categorical
[I 2025-03-20 21:39:50,336] A new study created in memory with name: no-name-5136c2ea-ebdc-4003-b4e4-de92d56c39d3
[I 2025-03-20 21:45:00,310] Trial 0 finished with value: 0.8003573262173197 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8003573262173197.
[I 2025-03-20 21:48:59,121] Trial 1 finished with value: 0.7894430471503217 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7894430471503217.
... storing 'Rank_Label' as categorical
[I 2025-03-20 21:50:46,605] A new study created in memory with name: no-name-2bd99593-64f4-4bca-97e0-61bb0805e937
[I 2025-03-20 21:54:49,380] Trial 0 finished with value: 0.6930182679839756 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6930182679839756.
[I 2025-03-20 21:58:14,854] Trial 1 finished with value: 0.7273076798604883 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6930182679839756.
... storing 'Rank_Label' as categorical
[I 2025-03-20 22:00:03,597] A new study created in memory with name: no-name-8eea2902-1803-45df-8ba4-3f1ced577c53
[I 2025-03-20 22:04:29,748] Trial 0 finished with value: 0.8360361094060151 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8360361094060151.
[I 2025-03-20 22:09:28,872] Trial 1 finished with value: 0.8396762013435364 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8360361094060151.
... storing 'Rank_Label' as categorical
2025-03-20 22:11:56,623 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8
Processing datasets for repeat 0:  30%|███       | 3/10 [1:16:06<3:58:57, 2048.22s/it]2025-03-20 22:11:56,625 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7
[I 2025-03-20 22:21:35,717] A new study created in memory with name: no-name-a1679e0f-b08e-4652-afe5-0a65c8007701
[I 2025-03-20 22:27:01,159] Trial 0 finished with value: 0.5256924706956615 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.5256924706956615.
[I 2025-03-20 22:31:20,435] Trial 1 finished with value: 0.3993804260440495 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 1 with value: 0.3993804260440495.
... storing 'Rank_Label' as categorical
[I 2025-03-20 22:33:08,594] A new study created in memory with name: no-name-26fa5bed-6204-4abd-878e-657eb29c6da0
[I 2025-03-20 22:36:46,193] Trial 0 finished with value: 0.770248936570209 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.770248936570209.
[I 2025-03-20 22:40:21,561] Trial 1 finished with value: 0.7394548188085142 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7394548188085142.
... storing 'Rank_Label' as categorical
[I 2025-03-20 22:42:09,104] A new study created in memory with name: no-name-582c71d8-bb32-45fe-9801-d5174fd80904
[I 2025-03-20 22:45:10,450] Trial 0 finished with value: 0.6024474397949551 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6024474397949551.
[I 2025-03-20 22:50:13,620] Trial 1 finished with value: 0.7819137029025865 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6024474397949551.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7266
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5767
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 6 components.
Reject 16046(68.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8004
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7894
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6930
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 4041(17.24%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8360
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5257
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.3994
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 223(0.95%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7702
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7395
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 3502(14.94%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6024
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2133(9.10%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-20 22:52:00,774] A new study created in memory with name: no-name-55f0bd88-bb87-4277-b0ef-80ef5c5f58c6
[I 2025-03-20 22:56:04,270] Trial 0 finished with value: 0.7848871376203455 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7848871376203455.
[I 2025-03-20 23:00:03,923] Trial 1 finished with value: 0.8505132716634999 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7848871376203455.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:01:59,875] A new study created in memory with name: no-name-dbd9837f-b095-4426-a9ce-527e5d311999
[I 2025-03-20 23:05:01,478] Trial 0 finished with value: 0.7391397564307504 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7391397564307504.
[I 2025-03-20 23:10:06,289] Trial 1 finished with value: 0.7227735726729684 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7227735726729684.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:12:33,709] A new study created in memory with name: no-name-2ab66d7e-2919-4c3e-9cc9-d6f908a48273
[I 2025-03-20 23:15:40,265] Trial 0 finished with value: 0.819511107776476 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.819511107776476.
[I 2025-03-20 23:20:16,578] Trial 1 finished with value: 0.8919611961945243 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.819511107776476.
... storing 'Rank_Label' as categorical
2025-03-20 23:22:11,661 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7
Processing datasets for repeat 0:  40%|████      | 4/10 [2:26:21<4:50:21, 2903.65s/it]2025-03-20 23:22:11,664 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6
[I 2025-03-20 23:22:35,531] A new study created in memory with name: no-name-10f1696e-6937-4d3e-b0cf-bb0503547c17
[I 2025-03-20 23:22:45,566] Trial 0 finished with value: 0.5506894886493683 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.5506894886493683.
[I 2025-03-20 23:22:56,839] Trial 1 finished with value: 0.7323095202445984 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.5506894886493683.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:22:59,867] A new study created in memory with name: no-name-f51274bf-1049-4c21-8c64-b96c6e5fcea0
[I 2025-03-20 23:23:13,252] Trial 0 finished with value: 0.8289366364479065 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8289366364479065.
[I 2025-03-20 23:23:26,260] Trial 1 finished with value: 0.8233476877212524 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.8233476877212524.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:23:30,120] A new study created in memory with name: no-name-6c6f2c3e-c87b-448f-8e62-891109f64450
[I 2025-03-20 23:23:38,000] Trial 0 finished with value: 0.6122747659683228 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6122747659683228.
[I 2025-03-20 23:23:45,942] Trial 1 finished with value: 0.7531068921089172 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6122747659683228.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:23:48,728] A new study created in memory with name: no-name-30b05c0c-e1fe-4c20-b7b9-28834b6d7397
[I 2025-03-20 23:23:55,515] Trial 0 finished with value: 0.7900741398334503 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7900741398334503.
[I 2025-03-20 23:24:05,669] Trial 1 finished with value: 0.8076817393302917 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7900741398334503.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:24:08,618] A new study created in memory with name: no-name-7106f510-8b8f-4e55-93c6-0f1f1c8556c7
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7849
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7391
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7228
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1044(4.46%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8195
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5507
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8289
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8233
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6123
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 83(5.17%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7901
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
[I 2025-03-20 23:24:18,639] Trial 0 finished with value: 0.63088059425354 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.63088059425354.
[I 2025-03-20 23:24:29,034] Trial 1 finished with value: 0.7991664409637451 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.63088059425354.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:24:31,785] A new study created in memory with name: no-name-202990c7-d2b1-4ebc-8c90-b1f428ebcbb0
[I 2025-03-20 23:24:44,022] Trial 0 finished with value: 0.835573822259903 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.835573822259903.
[I 2025-03-20 23:24:50,989] Trial 1 finished with value: 0.7977384924888611 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7977384924888611.
... storing 'Rank_Label' as categorical
2025-03-20 23:24:53,750 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6
Processing datasets for repeat 0:  50%|█████     | 5/10 [2:29:03<2:39:35, 1915.03s/it]2025-03-20 23:24:53,753 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5
[I 2025-03-20 23:25:30,530] A new study created in memory with name: no-name-30b2b7da-913c-4816-93b4-b43a524c9700
[I 2025-03-20 23:25:42,753] Trial 0 finished with value: 0.7220138311386108 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7220138311386108.
[I 2025-03-20 23:25:53,755] Trial 1 finished with value: 0.6954828202724457 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 1 with value: 0.6954828202724457.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:25:56,771] A new study created in memory with name: no-name-093357f0-7357-46fa-87ec-41ba0679ebea
[I 2025-03-20 23:26:09,679] Trial 0 finished with value: 0.629218190908432 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.629218190908432.
[I 2025-03-20 23:26:17,187] Trial 1 finished with value: 0.8447010815143585 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.629218190908432.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:26:20,484] A new study created in memory with name: no-name-0bb5b40a-1abe-4825-839e-1489607f1980
[I 2025-03-20 23:26:31,692] Trial 0 finished with value: 0.6433083713054657 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6433083713054657.
[I 2025-03-20 23:26:38,503] Trial 1 finished with value: 0.7481898069381714 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6433083713054657.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:26:41,282] A new study created in memory with name: no-name-a2d5af8f-168d-4cf3-97c0-26740396b2b2
[I 2025-03-20 23:26:50,920] Trial 0 finished with value: 0.8401156663894653 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8401156663894653.
[I 2025-03-20 23:26:57,982] Trial 1 finished with value: 0.7911027371883392 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7911027371883392.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:27:01,689] A new study created in memory with name: no-name-10c8b74b-b1b6-4900-a9a9-79c3901e2f1b
[I 2025-03-20 23:27:08,878] Trial 0 finished with value: 0.7683761119842529 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7683761119842529.
[I 2025-03-20 23:27:14,787] Trial 1 finished with value: 0.6279039978981018 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6279039978981018.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:27:17,554] A new study created in memory with name: no-name-4244b56d-59ed-41e1-b9e5-3e724d185221
[I 2025-03-20 23:27:28,190] Trial 0 finished with value: 0.8360300660133362 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8360300660133362.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6309
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8356
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7977
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7220
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6955
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6292
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 37(2.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6433
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 1011(63.03%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8401
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7911
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7684
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6279
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 45(2.81%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8360
[I 2025-03-20 23:27:34,592] Trial 1 finished with value: 0.8352706432342529 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.8352706432342529.
... storing 'Rank_Label' as categorical
2025-03-20 23:27:37,361 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data5
Processing datasets for repeat 0:  60%|██████    | 6/10 [2:31:47<1:27:58, 1319.54s/it]2025-03-20 23:27:37,363 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4
[I 2025-03-20 23:28:23,532] A new study created in memory with name: no-name-56151235-68b6-4d75-af67-08b6efc9ddb5
[I 2025-03-20 23:28:28,209] Trial 0 finished with value: 0.661340594291687 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.661340594291687.
[I 2025-03-20 23:28:32,428] Trial 1 finished with value: 0.6619427800178528 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.661340594291687.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:28:35,345] A new study created in memory with name: no-name-54f82be9-a9b7-40f4-8684-a104aa2de948
[I 2025-03-20 23:28:42,832] Trial 0 finished with value: 0.6500229239463806 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6500229239463806.
[I 2025-03-20 23:28:50,051] Trial 1 finished with value: 0.6724112629890442 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6500229239463806.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:28:53,257] A new study created in memory with name: no-name-a1c47a71-bcf2-409c-a500-378636bc3223
[I 2025-03-20 23:28:57,111] Trial 0 finished with value: 0.6930685639381409 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6930685639381409.
[I 2025-03-20 23:29:01,809] Trial 1 finished with value: 0.7671167254447937 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6930685639381409.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:29:04,451] A new study created in memory with name: no-name-3bc91370-a990-4144-9242-9924155fad15
[I 2025-03-20 23:29:07,952] Trial 0 finished with value: 0.7534002065658569 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7534002065658569.
[I 2025-03-20 23:29:12,580] Trial 1 finished with value: 0.7187559008598328 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7187559008598328.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:29:15,404] A new study created in memory with name: no-name-58a34422-ec6c-4fc5-a79a-1290c1e4091d
[I 2025-03-20 23:29:19,377] Trial 0 finished with value: 0.707243025302887 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.707243025302887.
[I 2025-03-20 23:29:23,685] Trial 1 finished with value: 0.7450365424156189 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.707243025302887.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:29:26,348] A new study created in memory with name: no-name-7bde06b8-8fd7-4757-be85-a081d5c46efd
[I 2025-03-20 23:29:29,964] Trial 0 finished with value: 0.7973085045814514 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7973085045814514.
[I 2025-03-20 23:29:32,937] Trial 1 finished with value: 0.8006182312965393 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7973085045814514.
... storing 'Rank_Label' as categorical
2025-03-20 23:29:35,944 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4
Processing datasets for repeat 0:  70%|███████   | 7/10 [2:33:45<46:20, 926.92s/it]   2025-03-20 23:29:35,946 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3
[I 2025-03-20 23:30:19,303] A new study created in memory with name: no-name-2785cd6a-db22-4551-9172-c5603babbad3
[I 2025-03-20 23:30:24,525] Trial 0 finished with value: 0.760472297668457 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.760472297668457.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8353
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6613
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 145(44.75%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6500
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6931
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 24(7.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7534
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7188
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7072
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 117(36.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7973
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7605
[I 2025-03-20 23:30:27,864] Trial 1 finished with value: 0.6908966898918152 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6908966898918152.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:30:30,771] A new study created in memory with name: no-name-796d9abb-75e3-4540-abb8-5c9e2db2533d
[I 2025-03-20 23:30:38,254] Trial 0 finished with value: 0.7568534016609192 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7568534016609192.
[I 2025-03-20 23:30:45,558] Trial 1 finished with value: 0.6996471881866455 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6996471881866455.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:30:49,138] A new study created in memory with name: no-name-bf94aecf-4d07-4582-972d-7828a2248707
[I 2025-03-20 23:30:52,510] Trial 0 finished with value: 0.71131432056427 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.71131432056427.
[I 2025-03-20 23:30:57,330] Trial 1 finished with value: 0.7253050208091736 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.71131432056427.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:31:00,011] A new study created in memory with name: no-name-dfc32c19-739f-4ca4-b1a9-41f865b9e245
[I 2025-03-20 23:31:03,628] Trial 0 finished with value: 0.7597103118896484 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7597103118896484.
[I 2025-03-20 23:31:06,462] Trial 1 finished with value: 0.7827151417732239 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7597103118896484.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:31:09,358] A new study created in memory with name: no-name-71ee3a15-2e69-4719-8924-403ded1f8717
[I 2025-03-20 23:31:13,918] Trial 0 finished with value: 0.7986252903938293 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7986252903938293.
[I 2025-03-20 23:31:16,768] Trial 1 finished with value: 0.7979447841644287 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7979447841644287.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:31:19,430] A new study created in memory with name: no-name-871479c6-e356-4350-a340-a9133a03a417
[I 2025-03-20 23:31:23,645] Trial 0 finished with value: 0.8021728992462158 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8021728992462158.
[I 2025-03-20 23:31:26,960] Trial 1 finished with value: 0.8157910704612732 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8021728992462158.
... storing 'Rank_Label' as categorical
2025-03-20 23:31:29,922 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3
Processing datasets for repeat 0:  80%|████████  | 8/10 [2:35:39<22:16, 668.12s/it]2025-03-20 23:31:29,925 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2
[I 2025-03-20 23:32:00,379] A new study created in memory with name: no-name-ac2204b5-10aa-4094-9e60-bea58bdaf7ab
[I 2025-03-20 23:32:06,955] Trial 0 finished with value: 0.7386294603347778 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7386294603347778.
[I 2025-03-20 23:32:11,639] Trial 1 finished with value: 0.720127284526825 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.720127284526825.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:32:15,233] A new study created in memory with name: no-name-c0bd0de0-01c1-498e-9ad2-54ac128406c8
[I 2025-03-20 23:32:21,611] Trial 0 finished with value: 0.8159600496292114 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8159600496292114.
[I 2025-03-20 23:32:25,531] Trial 1 finished with value: 0.7354972958564758 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 1 with value: 0.7354972958564758.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6909
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 144(44.44%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7569
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6996
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 29(8.95%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7113
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 76(23.46%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7597
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7986
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7979
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8022
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7386
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7201
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 14 components.
Reject 10(1.97%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8160
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7355
Best hyperparameters: ... storing 'Rank_Label' as categorical
[I 2025-03-20 23:32:28,822] A new study created in memory with name: no-name-0f7f9d87-1f17-4a78-b4e2-bae803ef9e99
[I 2025-03-20 23:32:33,886] Trial 0 finished with value: 0.7888907194137573 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7888907194137573.
[I 2025-03-20 23:32:37,673] Trial 1 finished with value: 0.7924458384513855 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7888907194137573.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:32:40,975] A new study created in memory with name: no-name-3ce48a3f-66df-4191-ab2e-343698d8c75d
[I 2025-03-20 23:32:46,589] Trial 0 finished with value: 0.7480624318122864 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7480624318122864.
[I 2025-03-20 23:32:51,395] Trial 1 finished with value: 0.7701716423034668 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7480624318122864.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:32:54,672] A new study created in memory with name: no-name-8b1421cf-d060-410a-904a-4a2640780acf
[I 2025-03-20 23:32:58,255] Trial 0 finished with value: 0.8208761811256409 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8208761811256409.
[I 2025-03-20 23:33:02,002] Trial 1 finished with value: 0.7151221036911011 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7151221036911011.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:33:05,380] A new study created in memory with name: no-name-2ce1c73d-18f8-4e52-aa0a-debb54a912d9
[I 2025-03-20 23:33:09,943] Trial 0 finished with value: 0.790296196937561 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.790296196937561.
[I 2025-03-20 23:33:15,815] Trial 1 finished with value: 0.7940984964370728 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.790296196937561.
... storing 'Rank_Label' as categorical
2025-03-20 23:33:19,118 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2
Processing datasets for repeat 0:  90%|█████████ | 9/10 [2:37:29<08:13, 493.39s/it]2025-03-20 23:33:19,120 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1
[I 2025-03-20 23:33:57,316] A new study created in memory with name: no-name-ea4a31b6-cd54-4544-8f5f-32114cdaad77
[I 2025-03-20 23:34:01,646] Trial 0 finished with value: 0.8075194954872131 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.8075194954872131.
[I 2025-03-20 23:34:06,160] Trial 1 finished with value: 0.7953195571899414 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7953195571899414.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:34:09,745] A new study created in memory with name: no-name-e40d16b0-fc86-42c5-8ec1-7a8fbb7187a0
[I 2025-03-20 23:34:18,042] Trial 0 finished with value: 0.928904116153717 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.928904116153717.
[I 2025-03-20 23:34:25,888] Trial 1 finished with value: 0.7458289265632629 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7458289265632629.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:34:29,203] A new study created in memory with name: no-name-748924aa-50ca-48cf-88cd-671d1326a96b
[I 2025-03-20 23:34:32,915] Trial 0 finished with value: 0.800304651260376 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 0 with value: 0.800304651260376.
[I 2025-03-20 23:34:37,607] Trial 1 finished with value: 0.7137764692306519 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7137764692306519.
{'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 234(46.15%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7889
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7481
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8209
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7151
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 3 components.
Reject 129(25.44%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7903
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8075
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7953
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.9289
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7458
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8003
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7138
Best hyperparameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:34:41,051] A new study created in memory with name: no-name-ee0a9b28-aaff-4e1f-a3a2-5242a4b1aa99
[I 2025-03-20 23:34:43,988] Trial 0 finished with value: 0.7030094861984253 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7030094861984253.
[I 2025-03-20 23:34:48,050] Trial 1 finished with value: 0.7703867554664612 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7030094861984253.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:34:52,061] A new study created in memory with name: no-name-598e2b18-08bb-4e30-9fca-64f79aff7699
[I 2025-03-20 23:34:55,320] Trial 0 finished with value: 0.7891144752502441 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7891144752502441.
[I 2025-03-20 23:34:58,086] Trial 1 finished with value: 0.7960741519927979 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7891144752502441.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:35:01,369] A new study created in memory with name: no-name-251fa496-e82f-4823-b0bb-28851536abba
[I 2025-03-20 23:35:04,359] Trial 0 finished with value: 0.8259671330451965 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8259671330451965.
[I 2025-03-20 23:35:08,338] Trial 1 finished with value: 0.7811257243156433 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7811257243156433.
... storing 'Rank_Label' as categorical
2025-03-20 23:35:11,640 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1
Processing datasets for repeat 0: 100%|██████████| 10/10 [2:39:21<00:00, 375.81s/it]Processing datasets for repeat 0: 100%|██████████| 10/10 [2:39:21<00:00, 956.16s/it]
2025-03-20 23:35:11,644 - Repeat 0 completed
2025-03-20 23:35:11,645 - Starting repeat 1
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 190(37.48%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7030
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7891
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 46(9.07%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_0/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8260
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7811
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 1:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-20 23:35:11,651 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10
[I 2025-03-20 23:35:37,989] A new study created in memory with name: no-name-73a69295-19cb-48e3-951f-271b928a384c
[I 2025-03-20 23:35:41,601] Trial 0 finished with value: 0.7195059061050415 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7195059061050415.
[I 2025-03-20 23:35:46,014] Trial 1 finished with value: 0.7368014454841614 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7195059061050415.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:35:48,159] A new study created in memory with name: no-name-2e4eca5b-4e22-4015-9637-aa1555246ad1
[I 2025-03-20 23:35:53,277] Trial 0 finished with value: 0.7627195119857788 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7627195119857788.
[I 2025-03-20 23:36:00,692] Trial 1 finished with value: 0.7383051514625549 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7383051514625549.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:36:02,563] A new study created in memory with name: no-name-7b965e1d-8ca7-446c-90a1-ef03281fd94a
[I 2025-03-20 23:36:06,929] Trial 0 finished with value: 0.7986593842506409 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7986593842506409.
[I 2025-03-20 23:36:12,238] Trial 1 finished with value: 0.8064578771591187 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7986593842506409.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:36:14,108] A new study created in memory with name: no-name-7dadc71c-5541-4e6e-8075-16c51b3f7b32
[I 2025-03-20 23:36:18,266] Trial 0 finished with value: 0.7452223896980286 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7452223896980286.
[I 2025-03-20 23:36:22,340] Trial 1 finished with value: 0.7870142459869385 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7452223896980286.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:36:24,218] A new study created in memory with name: no-name-dc0436d3-e9f4-45a1-b6f2-ba77634be6b3
[I 2025-03-20 23:36:27,405] Trial 0 finished with value: 0.7887343168258667 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7887343168258667.
[I 2025-03-20 23:36:30,927] Trial 1 finished with value: 0.8267158269882202 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7887343168258667.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:36:32,793] A new study created in memory with name: no-name-4a30c034-6d5e-4860-8fa8-91e8a72e4098
[I 2025-03-20 23:36:36,687] Trial 0 finished with value: 0.7889370918273926 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7889370918273926.
[I 2025-03-20 23:36:40,800] Trial 1 finished with value: 0.7909771800041199 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7889370918273926.
... storing 'Rank_Label' as categorical
2025-03-20 23:36:42,643 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10
Processing datasets for repeat 1:  10%|█         | 1/10 [01:30<13:38, 90.99s/it]2025-03-20 23:36:42,645 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9
[I 2025-03-20 23:37:16,475] A new study created in memory with name: no-name-2d5e8939-f77a-4dc1-b92c-02e8c9603aec
[I 2025-03-20 23:37:19,946] Trial 0 finished with value: 0.8212814331054688 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8212814331054688.
[I 2025-03-20 23:37:23,833] Trial 1 finished with value: 0.7759730219841003 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7759730219841003.
... storing 'Rank_Label' as categorical
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7195
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 10 components.
Reject 384(89.51%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7627
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7383
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 90(20.98%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7987
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8(1.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7452
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7887
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7889
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8213
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7760
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
[I 2025-03-20 23:37:25,904] A new study created in memory with name: no-name-8a1c8ab2-38ab-4922-a58d-3b7a595c2232
[I 2025-03-20 23:37:32,157] Trial 0 finished with value: 0.8080790638923645 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8080790638923645.
[I 2025-03-20 23:37:37,485] Trial 1 finished with value: 0.7358199954032898 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7358199954032898.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:37:39,367] A new study created in memory with name: no-name-de227fa5-09da-4553-82e1-8f682c14dd08
[I 2025-03-20 23:37:42,073] Trial 0 finished with value: 0.8227887153625488 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8227887153625488.
[I 2025-03-20 23:37:45,593] Trial 1 finished with value: 0.7172142267227173 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7172142267227173.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:37:47,458] A new study created in memory with name: no-name-086a9626-e766-4cc0-9331-1db02a851535
[I 2025-03-20 23:37:49,900] Trial 0 finished with value: 0.7733235359191895 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7733235359191895.
[I 2025-03-20 23:37:53,809] Trial 1 finished with value: 0.7691677808761597 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 1 with value: 0.7691677808761597.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:37:55,678] A new study created in memory with name: no-name-1f8fc38e-5fa4-4c3b-965a-e61408531158
[I 2025-03-20 23:37:58,810] Trial 0 finished with value: 0.7978925704956055 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7978925704956055.
[I 2025-03-20 23:38:03,141] Trial 1 finished with value: 0.7382231950759888 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7382231950759888.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:38:05,064] A new study created in memory with name: no-name-f3e9032a-09a5-4bde-9cd1-3c51221216bc
[I 2025-03-20 23:38:08,416] Trial 0 finished with value: 0.8237508535385132 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8237508535385132.
[I 2025-03-20 23:38:13,098] Trial 1 finished with value: 0.8095439076423645 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.8095439076423645.
... storing 'Rank_Label' as categorical
2025-03-20 23:38:14,932 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9
Processing datasets for repeat 1:  20%|██        | 2/10 [03:03<12:14, 91.76s/it]2025-03-20 23:38:14,937 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8
[I 2025-03-20 23:47:53,433] A new study created in memory with name: no-name-86206785-30ca-431a-83d7-81465e5fdd0d
[I 2025-03-20 23:52:44,425] Trial 0 finished with value: 0.6194723689037821 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6194723689037821.
[I 2025-03-20 23:57:33,956] Trial 1 finished with value: 0.6560168629107268 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6194723689037821.
... storing 'Rank_Label' as categorical
[I 2025-03-20 23:59:22,959] A new study created in memory with name: no-name-2f5e8d91-ab5a-4a3c-b009-aa905bc14703
[I 2025-03-21 00:03:33,700] Trial 0 finished with value: 0.576766084069791 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.576766084069791.
[I 2025-03-21 00:08:44,680] Trial 1 finished with value: 0.6054437290067258 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.576766084069791.
... storing 'Rank_Label' as categorical
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8081
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7358
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 27(6.29%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8228
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7172
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 186(43.36%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7733
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7692
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7979
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7382
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 9 components.
Reject 109(25.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8238
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8095
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6195
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 374(1.60%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5768
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 5772(24.63%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 00:10:32,040] A new study created in memory with name: no-name-ea82e630-5a5c-4cf8-aec4-39eb19e90cbd
[I 2025-03-21 00:13:27,764] Trial 0 finished with value: 0.576086409713911 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.576086409713911.
[I 2025-03-21 00:16:26,991] Trial 1 finished with value: 0.6277394761209902 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.576086409713911.
... storing 'Rank_Label' as categorical
[I 2025-03-21 00:18:28,965] A new study created in memory with name: no-name-aa32976b-4e92-4d74-ab6a-c31c917451de
[I 2025-03-21 00:21:56,408] Trial 0 finished with value: 0.812055660330731 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.812055660330731.
[I 2025-03-21 00:26:21,538] Trial 1 finished with value: 0.7998341555180757 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7998341555180757.
... storing 'Rank_Label' as categorical
[I 2025-03-21 00:28:49,682] A new study created in memory with name: no-name-d1d24014-50a9-474f-bda2-51a91a2db4e0
[I 2025-03-21 00:33:47,841] Trial 0 finished with value: 0.6760256964227428 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6760256964227428.
[I 2025-03-21 00:38:13,362] Trial 1 finished with value: 0.6952378179716028 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6760256964227428.
... storing 'Rank_Label' as categorical
[I 2025-03-21 00:40:00,632] A new study created in memory with name: no-name-82094b32-acd8-484d-a230-c8a08ef9966c
[I 2025-03-21 00:43:28,426] Trial 0 finished with value: 0.7863923492638961 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7863923492638961.
[I 2025-03-21 00:47:57,095] Trial 1 finished with value: 0.7636875769366389 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7636875769366389.
... storing 'Rank_Label' as categorical
2025-03-21 00:49:44,101 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8
Processing datasets for repeat 1:  30%|███       | 3/10 [1:14:32<3:54:18, 2008.38s/it]2025-03-21 00:49:44,104 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7
[I 2025-03-21 00:59:09,058] A new study created in memory with name: no-name-42e520a4-a463-4a36-b74d-9b4f10906c1e
[I 2025-03-21 01:02:24,137] Trial 0 finished with value: 0.7547917832498965 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7547917832498965.
[I 2025-03-21 01:06:43,692] Trial 1 finished with value: 0.9827710416006006 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7547917832498965.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:08:31,671] A new study created in memory with name: no-name-74958c2e-bd89-4f66-b965-10e85f6f27c3
[I 2025-03-21 01:12:38,916] Trial 0 finished with value: 0.6706358971803085 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6706358971803085.
[I 2025-03-21 01:17:48,423] Trial 1 finished with value: 0.7952271751735521 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6706358971803085.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:19:57,360] A new study created in memory with name: no-name-8204f065-884d-4f35-a76d-3dd1e8004b53
[I 2025-03-21 01:23:27,907] Trial 0 finished with value: 0.7315983642702517 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7315983642702517.
[I 2025-03-21 01:27:31,177] Trial 1 finished with value: 0.706351409787717 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 1 with value: 0.706351409787717.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:30:02,404] A new study created in memory with name: no-name-f34abfc3-e98a-4927-b6be-2c2ed73ea347
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5761
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 10992(46.91%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8121
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7998
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6760
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 38(0.16%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7864
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7637
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7548
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 3591(15.32%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6706
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 6624(28.27%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7316
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7064
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 11976(51.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
[I 2025-03-21 01:33:33,951] Trial 0 finished with value: 0.7398641109466553 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7398641109466553.
[I 2025-03-21 01:38:35,438] Trial 1 finished with value: 0.8128782821738202 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7398641109466553.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:40:26,820] A new study created in memory with name: no-name-95fd2f0f-5d46-4ff4-817e-c7c1a88a6791
[I 2025-03-21 01:45:00,298] Trial 0 finished with value: 0.7240258144295734 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7240258144295734.
[I 2025-03-21 01:48:01,329] Trial 1 finished with value: 0.6954889375230541 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6954889375230541.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:49:48,635] A new study created in memory with name: no-name-5045bc69-8d6d-4af5-8a64-6749d67e71cc
[I 2025-03-21 01:53:53,065] Trial 0 finished with value: 0.8057023468224899 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8057023468224899.
[I 2025-03-21 01:56:54,932] Trial 1 finished with value: 0.7386964637300243 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7386964637300243.
... storing 'Rank_Label' as categorical
2025-03-21 01:58:43,010 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7
Processing datasets for repeat 1:  40%|████      | 4/10 [2:23:31<4:44:56, 2849.50s/it]2025-03-21 01:58:43,027 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6
[I 2025-03-21 01:59:06,248] A new study created in memory with name: no-name-bef82766-d44b-4e65-9d55-17195ea7a57f
[I 2025-03-21 01:59:16,593] Trial 0 finished with value: 0.7051829993724823 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7051829993724823.
[I 2025-03-21 01:59:30,693] Trial 1 finished with value: 0.7603602111339569 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7051829993724823.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:59:33,889] A new study created in memory with name: no-name-58ac281b-cbb5-4ab5-9bf3-9dc759e625e4
[I 2025-03-21 01:59:43,569] Trial 0 finished with value: 0.7250765264034271 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7250765264034271.
[I 2025-03-21 01:59:55,438] Trial 1 finished with value: 0.6168411374092102 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6168411374092102.
... storing 'Rank_Label' as categorical
[I 2025-03-21 01:59:58,326] A new study created in memory with name: no-name-7fdac13b-8e77-43e0-949b-12a1c1fa2223
[I 2025-03-21 02:00:09,590] Trial 0 finished with value: 0.6104395687580109 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6104395687580109.
[I 2025-03-21 02:00:18,480] Trial 1 finished with value: 0.5903422236442566 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 1 with value: 0.5903422236442566.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:00:21,464] A new study created in memory with name: no-name-bcfe81a5-f191-409c-95b8-d46986871860
[I 2025-03-21 02:00:30,029] Trial 0 finished with value: 0.7599750757217407 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7599750757217407.
[I 2025-03-21 02:00:40,119] Trial 1 finished with value: 0.7793245911598206 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7599750757217407.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:00:42,939] A new study created in memory with name: no-name-dee91b01-dfa9-43c1-b447-ee6851ae37fe
[I 2025-03-21 02:00:55,413] Trial 0 finished with value: 0.5992271304130554 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.5992271304130554.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7399
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7240
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6955
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 203(0.87%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8057
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7387
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7052
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7251
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6168
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 299(18.64%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6104
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5903
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 1093(68.14%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7600
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.5992
[I 2025-03-21 02:01:04,935] Trial 1 finished with value: 0.6865250170230865 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.5992271304130554.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:01:07,889] A new study created in memory with name: no-name-c1e3bd78-a756-4080-b24b-90693501b5d9
[I 2025-03-21 02:01:19,404] Trial 0 finished with value: 0.7405832409858704 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7405832409858704.
[I 2025-03-21 02:01:26,174] Trial 1 finished with value: 0.7999314367771149 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7405832409858704.
... storing 'Rank_Label' as categorical
2025-03-21 02:01:28,956 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6
Processing datasets for repeat 1:  50%|█████     | 5/10 [2:26:17<2:36:48, 1881.79s/it]2025-03-21 02:01:28,963 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5
[I 2025-03-21 02:02:03,983] A new study created in memory with name: no-name-29eff310-2ecf-45f6-95cd-016251d2ed32
[I 2025-03-21 02:02:13,825] Trial 0 finished with value: 0.45321138203144073 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.45321138203144073.
[I 2025-03-21 02:02:25,979] Trial 1 finished with value: 0.7574730813503265 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.45321138203144073.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:02:28,997] A new study created in memory with name: no-name-80fd06fe-c4ed-4d18-81c8-40dda67ae792
[I 2025-03-21 02:02:39,508] Trial 0 finished with value: 0.7632414698600769 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7632414698600769.
[I 2025-03-21 02:02:52,710] Trial 1 finished with value: 0.7638206481933594 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7632414698600769.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:02:55,935] A new study created in memory with name: no-name-d54d7ac3-a45d-40e9-8129-08bf30937718
[I 2025-03-21 02:03:05,317] Trial 0 finished with value: 0.7185522615909576 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7185522615909576.
[I 2025-03-21 02:03:12,236] Trial 1 finished with value: 0.7191937565803528 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7185522615909576.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:03:15,349] A new study created in memory with name: no-name-359dcbd4-9873-4817-9b76-9aff374319d6
[I 2025-03-21 02:03:22,226] Trial 0 finished with value: 0.7884794473648071 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7884794473648071.
[I 2025-03-21 02:03:33,955] Trial 1 finished with value: 0.750234842300415 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 1 with value: 0.750234842300415.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:03:38,679] A new study created in memory with name: no-name-7117e1fa-e001-431f-8b54-18ec6e7e694b
[I 2025-03-21 02:03:46,915] Trial 0 finished with value: 0.7903316020965576 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7903316020965576.
[I 2025-03-21 02:03:55,045] Trial 1 finished with value: 0.9008569419384003 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7903316020965576.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:03:57,839] A new study created in memory with name: no-name-4f18ab62-ebd3-409a-a476-bb830d4b608a
[I 2025-03-21 02:04:09,803] Trial 0 finished with value: 0.8021681308746338 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8021681308746338.
[I 2025-03-21 02:04:16,833] Trial 1 finished with value: 0.7688654065132141 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7688654065132141.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 32(2.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7406
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.4532
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7632
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7186
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 255(15.90%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7885
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7502
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7903
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8022
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7689
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
... storing 'Rank_Label' as categorical
2025-03-21 02:04:19,622 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data5
Processing datasets for repeat 1:  60%|██████    | 6/10 [2:29:07<1:26:40, 1300.00s/it]2025-03-21 02:04:19,625 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4
[I 2025-03-21 02:05:03,029] A new study created in memory with name: no-name-748b2d90-150f-446e-9663-d3998db9d92e
[I 2025-03-21 02:05:06,534] Trial 0 finished with value: 0.751024603843689 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.751024603843689.
[I 2025-03-21 02:05:11,265] Trial 1 finished with value: 0.7650166153907776 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.751024603843689.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:05:14,176] A new study created in memory with name: no-name-e2a1bdb2-a104-4b56-a806-1d6990604950
[I 2025-03-21 02:05:22,407] Trial 0 finished with value: 0.6366927623748779 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6366927623748779.
[I 2025-03-21 02:05:31,660] Trial 1 finished with value: 0.7015073299407959 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6366927623748779.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:05:34,394] A new study created in memory with name: no-name-e11e3eb5-d853-467b-b8ab-4b8a66dfae4a
[I 2025-03-21 02:05:37,420] Trial 0 finished with value: 0.6644149422645569 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6644149422645569.
[I 2025-03-21 02:05:40,216] Trial 1 finished with value: 0.6547480821609497 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 1 with value: 0.6547480821609497.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:05:42,918] A new study created in memory with name: no-name-ed5861bc-78b4-4db0-b162-592d0605a1cc
[I 2025-03-21 02:05:46,072] Trial 0 finished with value: 0.7418907284736633 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7418907284736633.
[I 2025-03-21 02:05:49,368] Trial 1 finished with value: 0.7273718118667603 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7273718118667603.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:05:52,469] A new study created in memory with name: no-name-9757e378-c5b3-4b2b-968b-e98511a923c8
[I 2025-03-21 02:05:56,678] Trial 0 finished with value: 0.7292079925537109 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7292079925537109.
[I 2025-03-21 02:06:01,424] Trial 1 finished with value: 0.7368347644805908 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7292079925537109.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:06:04,105] A new study created in memory with name: no-name-e0218fcf-462a-4868-99b8-224c0e0ee8b0
[I 2025-03-21 02:06:08,118] Trial 0 finished with value: 0.784081757068634 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.784081757068634.
[I 2025-03-21 02:06:12,412] Trial 1 finished with value: 0.7874751687049866 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.784081757068634.
... storing 'Rank_Label' as categorical
2025-03-21 02:06:15,513 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4
Processing datasets for repeat 1:  70%|███████   | 7/10 [2:31:03<45:38, 912.89s/it]   2025-03-21 02:06:15,516 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3
[I 2025-03-21 02:06:57,999] A new study created in memory with name: no-name-b9a5702b-b83a-4430-90b6-308456d19e2c
[I 2025-03-21 02:07:03,185] Trial 0 finished with value: 0.7482476830482483 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7482476830482483.
[I 2025-03-21 02:07:07,065] Trial 1 finished with value: 0.7952777743339539 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7482476830482483.
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7510
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6367
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6644
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6547
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 275(84.88%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7419
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7274
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7292
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 41(12.65%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7841
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7482
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:07:09,983] A new study created in memory with name: no-name-c57cd5c1-a672-4ee7-9e85-a1a3f97dae5a
[I 2025-03-21 02:07:18,078] Trial 0 finished with value: 0.7147875428199768 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7147875428199768.
[I 2025-03-21 02:07:24,646] Trial 1 finished with value: 0.6622233390808105 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.6622233390808105.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:07:27,688] A new study created in memory with name: no-name-57cef7a2-4876-4593-95b3-b69ea4c0f4a6
[I 2025-03-21 02:07:32,484] Trial 0 finished with value: 0.665845513343811 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.665845513343811.
[I 2025-03-21 02:07:35,298] Trial 1 finished with value: 0.6457843780517578 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6457843780517578.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:07:38,020] A new study created in memory with name: no-name-a415d6b9-5a31-4c4c-bf79-92bbec74d35f
[I 2025-03-21 02:07:42,072] Trial 0 finished with value: 0.6960018873214722 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6960018873214722.
[I 2025-03-21 02:07:46,629] Trial 1 finished with value: 0.7491525411605835 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6960018873214722.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:07:49,544] A new study created in memory with name: no-name-8cc2bde2-cfa9-42d5-923a-61efe9bb4a53
[I 2025-03-21 02:07:54,053] Trial 0 finished with value: 0.8304503560066223 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8304503560066223.
[I 2025-03-21 02:07:58,632] Trial 1 finished with value: 0.7282827496528625 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7282827496528625.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:08:01,344] A new study created in memory with name: no-name-37e22b46-e256-4130-ad7c-da4b4b3f8302
[I 2025-03-21 02:08:05,666] Trial 0 finished with value: 0.7969968914985657 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7969968914985657.
[I 2025-03-21 02:08:07,964] Trial 1 finished with value: 0.783130407333374 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.783130407333374.
... storing 'Rank_Label' as categorical
2025-03-21 02:08:10,929 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3
Processing datasets for repeat 1:  80%|████████  | 8/10 [2:32:59<21:58, 659.01s/it]2025-03-21 02:08:10,932 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2
[I 2025-03-21 02:08:40,577] A new study created in memory with name: no-name-23a48f09-37cd-4882-be83-9beb70a4d2ca
[I 2025-03-21 02:08:47,186] Trial 0 finished with value: 0.7114657759666443 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.7114657759666443.
[I 2025-03-21 02:08:53,542] Trial 1 finished with value: 0.8874250054359436 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7114657759666443.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:08:58,185] A new study created in memory with name: no-name-b8b91b09-1f9f-4ba7-8479-eb8f02e92a6d
[I 2025-03-21 02:09:07,022] Trial 0 finished with value: 0.7779486179351807 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.7779486179351807.
[I 2025-03-21 02:09:14,145] Trial 1 finished with value: 0.7905805110931396 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7779486179351807.
... storing 'Rank_Label' as categorical
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7148
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6622
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 18(5.56%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6658
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6458
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 13 components.
Reject 289(89.20%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.6960
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8305
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7283
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 221(68.21%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7970
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7831
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7115
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 88(17.36%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7779
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 02:09:17,468] A new study created in memory with name: no-name-2c7043b3-0c28-4d28-b854-a47b5b1ec8e1
[I 2025-03-21 02:09:22,042] Trial 0 finished with value: 0.7917992472648621 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7917992472648621.
[I 2025-03-21 02:09:25,235] Trial 1 finished with value: 0.7955499887466431 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7917992472648621.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:09:28,534] A new study created in memory with name: no-name-90f32f4d-5f5d-4945-a731-f16aedf1e423
[I 2025-03-21 02:09:32,925] Trial 0 finished with value: 0.7656317353248596 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7656317353248596.
[I 2025-03-21 02:09:37,860] Trial 1 finished with value: 0.7322697639465332 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7322697639465332.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:09:41,836] A new study created in memory with name: no-name-b852a2ec-2aed-4879-9923-50e62e7c689a
[I 2025-03-21 02:09:46,122] Trial 0 finished with value: 0.7854740619659424 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7854740619659424.
[I 2025-03-21 02:09:51,827] Trial 1 finished with value: 0.7315536737442017 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7315536737442017.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:09:55,220] A new study created in memory with name: no-name-22875451-6e89-4c98-8274-2db1de00b91c
[I 2025-03-21 02:10:00,172] Trial 0 finished with value: 0.7897612452507019 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7897612452507019.
[I 2025-03-21 02:10:04,559] Trial 1 finished with value: 0.7907331585884094 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7897612452507019.
... storing 'Rank_Label' as categorical
2025-03-21 02:10:07,890 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2
Processing datasets for repeat 1:  90%|█████████ | 9/10 [2:34:56<08:09, 489.56s/it]2025-03-21 02:10:07,892 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1
[I 2025-03-21 02:10:45,210] A new study created in memory with name: no-name-8f12b2a4-dcee-41fe-a552-795bd9d810d4
[I 2025-03-21 02:10:50,844] Trial 0 finished with value: 0.8191652894020081 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8191652894020081.
[I 2025-03-21 02:10:56,522] Trial 1 finished with value: 0.7170961499214172 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7170961499214172.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:11:00,087] A new study created in memory with name: no-name-562bcdb9-d360-4bcb-8b27-d98f31f44f7a
[I 2025-03-21 02:11:08,074] Trial 0 finished with value: 0.8268833160400391 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8268833160400391.
[I 2025-03-21 02:11:13,061] Trial 1 finished with value: 0.7421425580978394 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7421425580978394.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:11:16,424] A new study created in memory with name: no-name-0990fb2a-d1be-4e70-9141-812dd69b0e1e
[I 2025-03-21 02:11:19,471] Trial 0 finished with value: 0.7765201330184937 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7765201330184937.
[I 2025-03-21 02:11:23,322] Trial 1 finished with value: 0.7885794043540955 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7765201330184937.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7918
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7656
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7323
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7855
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7316
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 3 components.
Reject 99(19.53%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7898
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8192
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7171
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 327(64.50%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8269
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7421
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 111(21.89%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7765
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 345(68.05%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 02:11:26,653] A new study created in memory with name: no-name-ea23d239-6fd2-4908-91df-458f2a2bb5ee
[I 2025-03-21 02:11:29,542] Trial 0 finished with value: 0.7671908140182495 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7671908140182495.
[I 2025-03-21 02:11:32,878] Trial 1 finished with value: 0.7297510504722595 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7297510504722595.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:11:36,166] A new study created in memory with name: no-name-dab8f6a3-5f01-45ce-9ffa-c292cfd7fe57
[I 2025-03-21 02:11:39,070] Trial 0 finished with value: 0.7923212647438049 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7923212647438049.
[I 2025-03-21 02:11:41,974] Trial 1 finished with value: 0.7666184306144714 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7666184306144714.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:11:45,259] A new study created in memory with name: no-name-8a51432d-c849-4b82-b36a-a4c764749541
[I 2025-03-21 02:11:48,648] Trial 0 finished with value: 0.835676372051239 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.835676372051239.
[I 2025-03-21 02:11:52,231] Trial 1 finished with value: 0.7972921133041382 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7972921133041382.
... storing 'Rank_Label' as categorical
2025-03-21 02:11:55,498 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1
Processing datasets for repeat 1: 100%|██████████| 10/10 [2:36:43<00:00, 371.64s/it]Processing datasets for repeat 1: 100%|██████████| 10/10 [2:36:43<00:00, 940.38s/it]
2025-03-21 02:11:55,500 - Repeat 1 completed
2025-03-21 02:11:55,501 - Starting repeat 2
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7672
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7298
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7923
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7666
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_1/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8357
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7973
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 2:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 02:11:55,508 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10
[I 2025-03-21 02:12:21,380] A new study created in memory with name: no-name-c54d490e-ce77-4b6f-a67f-b74e53ab3262
[I 2025-03-21 02:12:26,529] Trial 0 finished with value: 0.7417851090431213 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7417851090431213.
[I 2025-03-21 02:12:32,249] Trial 1 finished with value: 0.8000683784484863 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7417851090431213.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:12:34,345] A new study created in memory with name: no-name-d981f076-5acf-40f9-a3ce-7f2f90025fd4
[I 2025-03-21 02:12:43,970] Trial 0 finished with value: 0.7325382232666016 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7325382232666016.
[I 2025-03-21 02:12:49,832] Trial 1 finished with value: 0.793465256690979 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7325382232666016.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:12:51,741] A new study created in memory with name: no-name-4b23ed35-cf48-4110-9180-1635f31d078a
[I 2025-03-21 02:12:57,183] Trial 0 finished with value: 0.7364242672920227 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7364242672920227.
[I 2025-03-21 02:13:01,301] Trial 1 finished with value: 0.7922531366348267 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7364242672920227.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:13:03,189] A new study created in memory with name: no-name-326d30b0-6b31-4f6b-8ea7-a0097c877bfa
[I 2025-03-21 02:13:09,207] Trial 0 finished with value: 0.7251693606376648 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7251693606376648.
[I 2025-03-21 02:13:13,241] Trial 1 finished with value: 0.792362630367279 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.7251693606376648.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:13:15,117] A new study created in memory with name: no-name-d2bd17fc-706f-439d-917b-2c0d7aa62302
[I 2025-03-21 02:13:20,562] Trial 0 finished with value: 0.7851585745811462 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7851585745811462.
[I 2025-03-21 02:13:25,319] Trial 1 finished with value: 0.8081768155097961 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7851585745811462.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:13:27,196] A new study created in memory with name: no-name-7a88364b-dc0f-4e7c-aa98-c4c21bf05ed3
[I 2025-03-21 02:13:30,870] Trial 0 finished with value: 0.7891833186149597 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7891833186149597.
[I 2025-03-21 02:13:34,557] Trial 1 finished with value: 0.7934034466743469 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7891833186149597.
... storing 'Rank_Label' as categorical
2025-03-21 02:13:36,415 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10
Processing datasets for repeat 2:  10%|█         | 1/10 [01:40<15:08, 100.91s/it]2025-03-21 02:13:36,417 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9
[I 2025-03-21 02:14:09,726] A new study created in memory with name: no-name-533ed9b2-e6b4-4ea1-983d-726661002997
[I 2025-03-21 02:14:13,993] Trial 0 finished with value: 0.8080597519874573 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8080597519874573.
[I 2025-03-21 02:14:17,399] Trial 1 finished with value: 0.684177041053772 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.684177041053772.
... storing 'Rank_Label' as categorical
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7418
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2(0.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7325
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7364
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 221(51.52%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7252
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7852
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 129(30.07%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7892
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8081
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6842
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 346(80.65%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 02:14:19,639] A new study created in memory with name: no-name-fcd6f1df-0820-4c77-9346-6c17bf051451
[I 2025-03-21 02:14:28,384] Trial 0 finished with value: 0.7898143529891968 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7898143529891968.
[I 2025-03-21 02:14:36,358] Trial 1 finished with value: 0.7517852187156677 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7517852187156677.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:14:38,281] A new study created in memory with name: no-name-9fc1a1c4-5c53-4c2f-8e32-7bd747300fbb
[I 2025-03-21 02:14:42,623] Trial 0 finished with value: 0.6971890330314636 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6971890330314636.
[I 2025-03-21 02:14:46,030] Trial 1 finished with value: 0.7465522289276123 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6971890330314636.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:14:47,891] A new study created in memory with name: no-name-db60c873-e91a-42de-a22b-7d6d31a901f7
[I 2025-03-21 02:14:51,068] Trial 0 finished with value: 0.8032793998718262 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8032793998718262.
[I 2025-03-21 02:14:55,176] Trial 1 finished with value: 0.7678499221801758 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7678499221801758.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:14:57,002] A new study created in memory with name: no-name-6e6e7703-506d-4768-8608-d662feb3b7f3
[I 2025-03-21 02:14:59,900] Trial 0 finished with value: 0.6898955702781677 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6898955702781677.
[I 2025-03-21 02:15:03,792] Trial 1 finished with value: 0.7053380608558655 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6898955702781677.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:15:05,635] A new study created in memory with name: no-name-8968ba59-efcb-498a-8f53-d94abff7e4d9
[I 2025-03-21 02:15:09,487] Trial 0 finished with value: 0.7563421130180359 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7563421130180359.
[I 2025-03-21 02:15:12,789] Trial 1 finished with value: 0.8150554895401001 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7563421130180359.
... storing 'Rank_Label' as categorical
2025-03-21 02:15:14,629 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9
Processing datasets for repeat 2:  20%|██        | 2/10 [03:19<13:14, 99.32s/it] 2025-03-21 02:15:14,632 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8
[I 2025-03-21 02:24:21,966] A new study created in memory with name: no-name-3a1c6b4b-ca88-47cf-b2be-68d2197efdcd
[I 2025-03-21 02:29:10,409] Trial 0 finished with value: 0.8131800734478495 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8131800734478495.
[I 2025-03-21 02:33:29,021] Trial 1 finished with value: 0.8146078379257865 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8131800734478495.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:35:38,871] A new study created in memory with name: no-name-a62df3a0-761d-47d0-8afb-6ab112e63fa8
[I 2025-03-21 02:40:29,474] Trial 0 finished with value: 0.5670485859331877 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.5670485859331877.
[I 2025-03-21 02:45:50,640] Trial 1 finished with value: 0.6768092305763908 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.5670485859331877.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:48:21,804] A new study created in memory with name: no-name-f394c7f6-01c3-4e57-96b6-d38a8ee10025
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7898
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7518
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6972
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 61(14.22%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8033
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7678
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6899
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8(1.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7563
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8132
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5670
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 12868(54.91%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
[I 2025-03-21 02:53:19,804] Trial 0 finished with value: 0.5510962475901064 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.5510962475901064.
[I 2025-03-21 02:56:19,052] Trial 1 finished with value: 0.6234527022942252 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.5510962475901064.
... storing 'Rank_Label' as categorical
[I 2025-03-21 02:58:06,807] A new study created in memory with name: no-name-f96cc267-81ad-4d78-bed3-56b65635205a
[I 2025-03-21 03:01:35,900] Trial 0 finished with value: 0.8185637774674789 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8185637774674789.
[I 2025-03-21 03:05:30,292] Trial 1 finished with value: 0.7725670804148135 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7725670804148135.
... storing 'Rank_Label' as categorical
[I 2025-03-21 03:07:17,522] A new study created in memory with name: no-name-57112d1b-6ca7-4da9-b5f7-e5ad5b5b151c
[I 2025-03-21 03:11:48,073] Trial 0 finished with value: 0.6128676404123721 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6128676404123721.
[I 2025-03-21 03:16:48,533] Trial 1 finished with value: 0.7053138717361118 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.6128676404123721.
... storing 'Rank_Label' as categorical
[I 2025-03-21 03:18:36,890] A new study created in memory with name: no-name-64a43219-bd2c-44e0-8309-6262bc0e7aa1
[I 2025-03-21 03:23:10,310] Trial 0 finished with value: 0.7847773510476818 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7847773510476818.
[I 2025-03-21 03:27:37,489] Trial 1 finished with value: 0.8269570858582206 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7847773510476818.
... storing 'Rank_Label' as categorical
2025-03-21 03:29:24,393 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8
Processing datasets for repeat 2:  30%|███       | 3/10 [1:17:28<4:03:20, 2085.83s/it]2025-03-21 03:29:24,394 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7
[I 2025-03-21 03:39:58,278] A new study created in memory with name: no-name-c63d1305-6656-4239-baa7-9032fe42cb1d
[I 2025-03-21 03:44:54,415] Trial 0 finished with value: 0.7032907605171204 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7032907605171204.
[I 2025-03-21 03:48:44,058] Trial 1 finished with value: 0.8024963088657545 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7032907605171204.
... storing 'Rank_Label' as categorical
[I 2025-03-21 03:50:55,326] A new study created in memory with name: no-name-b74f2e15-1016-4641-b02c-660a3a15f577
[I 2025-03-21 03:54:34,246] Trial 0 finished with value: 0.6553017548892809 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6553017548892809.
[I 2025-03-21 03:59:13,530] Trial 1 finished with value: 0.949557918569316 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.6553017548892809.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:01:41,569] A new study created in memory with name: no-name-bdf3256c-3c4e-46d5-ab10-49d69e718956
[I 2025-03-21 04:04:44,687] Trial 0 finished with value: 0.720962643623352 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.720962643623352.
[I 2025-03-21 04:08:16,763] Trial 1 finished with value: 0.702940829422163 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 1 with value: 0.702940829422163.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:10:04,300] A new study created in memory with name: no-name-bacf3a4e-9ab9-455c-8bd4-37d7230e2abf
[I 2025-03-21 04:13:38,617] Trial 0 finished with value: 0.7760886912760527 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7760886912760527.
[I 2025-03-21 04:16:41,468] Trial 1 finished with value: 0.7869077843168507 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7760886912760527.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5511
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 11441(48.82%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8186
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7726
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6129
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 2796(11.93%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7848
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7033
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 4732(20.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6553
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 159(0.68%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7210
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7029
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7761
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: ... storing 'Rank_Label' as categorical
[I 2025-03-21 04:18:28,950] A new study created in memory with name: no-name-27abd03d-c1d7-4860-9c1e-aad9c715dde4
[I 2025-03-21 04:21:34,846] Trial 0 finished with value: 0.7200862065605496 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7200862065605496.
[I 2025-03-21 04:25:06,060] Trial 1 finished with value: 0.7920179496640745 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7200862065605496.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:26:53,357] A new study created in memory with name: no-name-ab56d1c5-761a-40a0-bc7f-fb3218a04324
[I 2025-03-21 04:29:53,674] Trial 0 finished with value: 0.774083049400993 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.774083049400993.
[I 2025-03-21 04:33:56,425] Trial 1 finished with value: 0.7489502352216969 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.7489502352216969.
... storing 'Rank_Label' as categorical
2025-03-21 04:35:43,340 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7
Processing datasets for repeat 2:  40%|████      | 4/10 [2:23:47<4:43:19, 2833.21s/it]2025-03-21 04:35:43,349 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6
[I 2025-03-21 04:36:07,172] A new study created in memory with name: no-name-a21ff883-3734-4b5f-9142-3f697e728d19
[I 2025-03-21 04:36:18,884] Trial 0 finished with value: 0.583455502986908 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.583455502986908.
[I 2025-03-21 04:36:30,681] Trial 1 finished with value: 0.5949114263057709 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.583455502986908.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:36:33,769] A new study created in memory with name: no-name-6bc44d37-5b7e-4e05-8ca4-7aaa12723cad
[I 2025-03-21 04:36:42,685] Trial 0 finished with value: 0.6736512184143066 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6736512184143066.
[I 2025-03-21 04:36:55,220] Trial 1 finished with value: 0.607193648815155 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.607193648815155.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:36:59,363] A new study created in memory with name: no-name-ae946033-4e32-482e-ad56-45ad8988b4c7
[I 2025-03-21 04:37:08,394] Trial 0 finished with value: 0.7992332875728607 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.7992332875728607.
[I 2025-03-21 04:37:19,620] Trial 1 finished with value: 0.7608208358287811 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7608208358287811.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:37:22,569] A new study created in memory with name: no-name-b523d906-d917-4406-8bc4-90d9235a11f8
[I 2025-03-21 04:37:32,448] Trial 0 finished with value: 0.596417635679245 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.596417635679245.
[I 2025-03-21 04:37:43,700] Trial 1 finished with value: 0.7848020792007446 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.596417635679245.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:37:46,500] A new study created in memory with name: no-name-152f4b53-df5b-4b89-8b24-0baab94adbf1
[I 2025-03-21 04:37:53,784] Trial 0 finished with value: 0.6409417986869812 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6409417986869812.
[I 2025-03-21 04:38:03,716] Trial 1 finished with value: 0.6365709602832794 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.6365709602832794.
{'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7201
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 24(0.10%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7741
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7490
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5835
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6737
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6072
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 12 components.
Reject 1314(81.92%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7992
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7608
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.5964
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 5 components.
Reject 342(21.32%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6409
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6366
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:38:06,917] A new study created in memory with name: no-name-48fb1663-9470-42d2-a5e2-96f5b16e303a
[I 2025-03-21 04:38:17,876] Trial 0 finished with value: 0.7746788859367371 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7746788859367371.
[I 2025-03-21 04:38:25,104] Trial 1 finished with value: 0.7959794700145721 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7746788859367371.
... storing 'Rank_Label' as categorical
2025-03-21 04:38:27,863 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6
Processing datasets for repeat 2:  50%|█████     | 5/10 [2:26:32<2:35:54, 1870.86s/it]2025-03-21 04:38:27,866 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5
[I 2025-03-21 04:39:04,031] A new study created in memory with name: no-name-60be52d3-4e9b-4859-b85b-7a2c3c92e45c
[I 2025-03-21 04:39:13,658] Trial 0 finished with value: 0.40502768754959106 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.40502768754959106.
[I 2025-03-21 04:39:21,852] Trial 1 finished with value: 0.8259132504463196 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.40502768754959106.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:39:24,866] A new study created in memory with name: no-name-6ec8a032-4495-466b-8f26-0095f6c88d3d
[I 2025-03-21 04:39:37,985] Trial 0 finished with value: 0.7892990410327911 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7892990410327911.
[I 2025-03-21 04:39:49,570] Trial 1 finished with value: 0.7642503976821899 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7642503976821899.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:39:52,373] A new study created in memory with name: no-name-58b6fb7f-64fd-4bdb-b097-49309e9dbdd6
[I 2025-03-21 04:40:02,890] Trial 0 finished with value: 0.8709579110145569 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8709579110145569.
[I 2025-03-21 04:40:13,624] Trial 1 finished with value: 0.7313509285449982 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7313509285449982.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:40:16,768] A new study created in memory with name: no-name-57d1a168-9589-4bba-bec0-26315f3f0441
[I 2025-03-21 04:40:24,838] Trial 0 finished with value: 0.790262758731842 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.790262758731842.
[I 2025-03-21 04:40:36,638] Trial 1 finished with value: 0.771068811416626 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 1 with value: 0.771068811416626.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:40:39,448] A new study created in memory with name: no-name-eddd6fd1-affe-409b-8311-f56707d74774
[I 2025-03-21 04:40:49,708] Trial 0 finished with value: 0.7721244394779205 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7721244394779205.
[I 2025-03-21 04:40:57,092] Trial 1 finished with value: 0.7363634407520294 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7363634407520294.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:41:00,253] A new study created in memory with name: no-name-98cb0c00-7e2b-42a2-8741-88560d704e35
[I 2025-03-21 04:41:10,708] Trial 0 finished with value: 0.7714834213256836 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7714834213256836.
[I 2025-03-21 04:41:18,314] Trial 1 finished with value: 0.7342910766601562 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7342910766601562.
... storing 'Rank_Label' as categorical
2025-03-21 04:41:21,092 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5
Processing datasets for repeat 2:  60%|██████    | 6/10 [2:29:25<1:26:14, 1293.67s/it]2025-03-21 04:41:21,095 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4
Found distributions with means close to 0 and 1 with 3 components.
Reject 44(2.74%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7747
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.4050
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7893
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7643
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8710
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7314
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 55(3.43%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7903
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7711
Best hyperparameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7721
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7364
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 110(6.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7715
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7343
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
[I 2025-03-21 04:42:01,754] A new study created in memory with name: no-name-2afcf03f-4151-471d-90a0-2f997cd1a44c
[I 2025-03-21 04:42:06,799] Trial 0 finished with value: 0.7200194001197815 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7200194001197815.
[I 2025-03-21 04:42:12,582] Trial 1 finished with value: 0.667336106300354 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 1 with value: 0.667336106300354.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:42:15,388] A new study created in memory with name: no-name-6796d477-1296-4c2a-9730-6a5e6f661ac0
[I 2025-03-21 04:42:24,650] Trial 0 finished with value: 0.7394869923591614 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.7394869923591614.
[I 2025-03-21 04:42:29,984] Trial 1 finished with value: 0.7342357635498047 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7342357635498047.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:42:32,738] A new study created in memory with name: no-name-7113d17a-c837-4123-8ca6-14de047dfd24
[I 2025-03-21 04:42:35,576] Trial 0 finished with value: 0.7936332821846008 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7936332821846008.
[I 2025-03-21 04:42:39,042] Trial 1 finished with value: 0.7799698114395142 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7799698114395142.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:42:41,784] A new study created in memory with name: no-name-a281d957-d292-4d05-939e-e17544c4d38a
[I 2025-03-21 04:42:44,635] Trial 0 finished with value: 0.7701566219329834 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7701566219329834.
[I 2025-03-21 04:42:48,541] Trial 1 finished with value: 0.7112860083580017 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7112860083580017.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:42:51,246] A new study created in memory with name: no-name-7dd74b88-f3d5-43d6-948f-5a18d3dcb7ff
[I 2025-03-21 04:42:55,770] Trial 0 finished with value: 0.7296961545944214 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7296961545944214.
[I 2025-03-21 04:42:58,562] Trial 1 finished with value: 0.7107170820236206 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7107170820236206.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:43:01,303] A new study created in memory with name: no-name-65ce3979-27af-4611-85da-696fa2651d25
[I 2025-03-21 04:43:04,575] Trial 0 finished with value: 0.7580664753913879 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7580664753913879.
[I 2025-03-21 04:43:09,323] Trial 1 finished with value: 0.7572339773178101 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.7572339773178101.
... storing 'Rank_Label' as categorical
2025-03-21 04:43:12,060 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4
Processing datasets for repeat 2:  70%|███████   | 7/10 [2:31:16<45:21, 907.01s/it]   2025-03-21 04:43:12,062 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3
[I 2025-03-21 04:43:49,479] A new study created in memory with name: no-name-e4bcddea-bcf3-4ba3-9b06-fe1cc8657547
[I 2025-03-21 04:43:54,461] Trial 0 finished with value: 0.663145899772644 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.663145899772644.
[I 2025-03-21 04:43:58,591] Trial 1 finished with value: 0.6620760560035706 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6620760560035706.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7200
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6673
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 137(42.28%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7395
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7342
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 72(22.22%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7936
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7800
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7702
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7113
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7297
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7107
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 48(14.81%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7581
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7572
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6631
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6621
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.2}
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:44:01,368] A new study created in memory with name: no-name-5dadb355-560f-430e-a472-07947d498c0e
[I 2025-03-21 04:44:08,353] Trial 0 finished with value: 0.7728883028030396 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7728883028030396.
[I 2025-03-21 04:44:13,863] Trial 1 finished with value: 0.7765144109725952 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.7728883028030396.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:44:16,587] A new study created in memory with name: no-name-1ba5d630-a60e-44c5-bb3e-fa9eaa0355c7
[I 2025-03-21 04:44:21,409] Trial 0 finished with value: 0.6324425935745239 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6324425935745239.
[I 2025-03-21 04:44:24,360] Trial 1 finished with value: 0.6958847045898438 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6324425935745239.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:44:27,148] A new study created in memory with name: no-name-1a64bbcd-1d7c-4fd2-846b-0a67b26dadde
[I 2025-03-21 04:44:30,395] Trial 0 finished with value: 0.7326762080192566 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7326762080192566.
[I 2025-03-21 04:44:34,013] Trial 1 finished with value: 0.8002618551254272 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7326762080192566.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:44:36,754] A new study created in memory with name: no-name-f258985a-1847-48f6-982f-05ec36215546
[I 2025-03-21 04:44:41,079] Trial 0 finished with value: 0.8324174284934998 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8324174284934998.
[I 2025-03-21 04:44:45,259] Trial 1 finished with value: 0.7305796146392822 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7305796146392822.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:44:48,031] A new study created in memory with name: no-name-e813c08a-ff0a-4575-8ecc-e79e17ab9830
[I 2025-03-21 04:44:52,793] Trial 0 finished with value: 0.7883292436599731 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7883292436599731.
[I 2025-03-21 04:44:56,520] Trial 1 finished with value: 0.7574684023857117 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7574684023857117.
... storing 'Rank_Label' as categorical
2025-03-21 04:44:59,237 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3
Processing datasets for repeat 2:  80%|████████  | 8/10 [2:33:03<21:44, 652.38s/it]2025-03-21 04:44:59,239 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2
[I 2025-03-21 04:45:28,807] A new study created in memory with name: no-name-cc3227b7-9631-4e74-9375-7cb57e4de22d
[I 2025-03-21 04:45:34,577] Trial 0 finished with value: 0.763347864151001 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.763347864151001.
[I 2025-03-21 04:45:40,400] Trial 1 finished with value: 0.758904755115509 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 1 with value: 0.758904755115509.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:45:44,632] A new study created in memory with name: no-name-17cce8e1-dca5-41c1-b7b0-fd9118615f2b
[I 2025-03-21 04:45:53,271] Trial 0 finished with value: 0.7996584177017212 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7996584177017212.
[I 2025-03-21 04:46:02,829] Trial 1 finished with value: 0.7949718832969666 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7949718832969666.
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 256(79.01%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7729
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6324
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 9 components.
Reject 265(81.79%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7327
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8324
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7306
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 44(13.58%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7883
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7575
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7633
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7589
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 79(15.58%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7997
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7950
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:46:06,182] A new study created in memory with name: no-name-96fc82de-8851-4351-82db-3b76d60b9c69
[I 2025-03-21 04:46:11,395] Trial 0 finished with value: 0.7810412049293518 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7810412049293518.
[I 2025-03-21 04:46:15,044] Trial 1 finished with value: 0.8060722351074219 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7810412049293518.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:46:18,355] A new study created in memory with name: no-name-a9d311df-14cc-4005-82de-2a88c287e84d
[I 2025-03-21 04:46:22,195] Trial 0 finished with value: 0.7951087951660156 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7951087951660156.
[I 2025-03-21 04:46:26,353] Trial 1 finished with value: 0.7413401007652283 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7413401007652283.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:46:29,801] A new study created in memory with name: no-name-74761930-bfa4-4490-bb32-bc8481e29208
[I 2025-03-21 04:46:34,910] Trial 0 finished with value: 0.8383868932723999 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8383868932723999.
[I 2025-03-21 04:46:40,970] Trial 1 finished with value: 0.803195595741272 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.803195595741272.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:46:44,283] A new study created in memory with name: no-name-aa3d8a37-83d0-40d5-ab81-d3f5c9b5517c
[I 2025-03-21 04:46:50,505] Trial 0 finished with value: 0.7953193783760071 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7953193783760071.
[I 2025-03-21 04:46:55,453] Trial 1 finished with value: 0.791526734828949 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.791526734828949.
... storing 'Rank_Label' as categorical
2025-03-21 04:46:59,041 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2
Processing datasets for repeat 2:  90%|█████████ | 9/10 [2:35:03<08:05, 485.89s/it]2025-03-21 04:46:59,044 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1
[I 2025-03-21 04:47:36,523] A new study created in memory with name: no-name-716e0b4a-bffa-43e0-8fe2-0ec7e70758e9
[I 2025-03-21 04:47:42,698] Trial 0 finished with value: 0.7378286123275757 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7378286123275757.
[I 2025-03-21 04:47:46,826] Trial 1 finished with value: 0.7450258731842041 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7378286123275757.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:47:50,424] A new study created in memory with name: no-name-61e0ed33-87f2-4755-b509-f09fa0fe40e3
[I 2025-03-21 04:47:55,487] Trial 0 finished with value: 0.7650294899940491 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7650294899940491.
[I 2025-03-21 04:48:02,089] Trial 1 finished with value: 0.7174740433692932 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7174740433692932.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:48:05,394] A new study created in memory with name: no-name-0058df52-4844-4f38-a4f6-6feec56254a4
[I 2025-03-21 04:48:09,871] Trial 0 finished with value: 0.832813024520874 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.832813024520874.
[I 2025-03-21 04:48:12,866] Trial 1 finished with value: 0.7960129976272583 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7960129976272583.
... storing 'Rank_Label' as categorical
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7810
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 161(31.76%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7951
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7413
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8384
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.8032
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 111(21.89%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7953
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7915
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7378
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 153(30.18%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7650
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7175
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8328
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7960
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 382(75.35%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 04:48:16,280] A new study created in memory with name: no-name-8178c681-8958-42f8-b553-afe292e53398
[I 2025-03-21 04:48:19,331] Trial 0 finished with value: 0.7774275541305542 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7774275541305542.
[I 2025-03-21 04:48:22,523] Trial 1 finished with value: 0.8046825528144836 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7774275541305542.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:48:26,193] A new study created in memory with name: no-name-3462c7b1-f327-4ec4-a6ff-a0600a5bb89b
[I 2025-03-21 04:48:30,258] Trial 0 finished with value: 0.7001053690910339 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7001053690910339.
[I 2025-03-21 04:48:34,515] Trial 1 finished with value: 0.8381814360618591 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7001053690910339.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:48:37,967] A new study created in memory with name: no-name-36ed12fc-7dad-41cd-bf64-2da39d58cc0a
[I 2025-03-21 04:48:41,792] Trial 0 finished with value: 0.7838412523269653 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7838412523269653.
[I 2025-03-21 04:48:46,020] Trial 1 finished with value: 0.7622790336608887 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7622790336608887.
... storing 'Rank_Label' as categorical
2025-03-21 04:48:49,329 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1
Processing datasets for repeat 2: 100%|██████████| 10/10 [2:36:53<00:00, 369.93s/it]Processing datasets for repeat 2: 100%|██████████| 10/10 [2:36:53<00:00, 941.38s/it]
2025-03-21 04:48:49,331 - Repeat 2 completed
2025-03-21 04:48:49,350 - Starting repeat 3
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7774
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7001
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 135(26.63%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_2/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7838
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7623
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 3:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 04:48:49,357 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10
[I 2025-03-21 04:49:15,244] A new study created in memory with name: no-name-c080f90a-2601-49f7-ac88-8f1bba2ad755
[I 2025-03-21 04:49:20,739] Trial 0 finished with value: 0.780139684677124 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.780139684677124.
[I 2025-03-21 04:49:25,576] Trial 1 finished with value: 0.7414945363998413 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7414945363998413.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:49:27,839] A new study created in memory with name: no-name-f5774f7a-3f3c-4c94-819a-904ebbf14a6b
[I 2025-03-21 04:49:36,535] Trial 0 finished with value: 0.788118839263916 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.788118839263916.
[I 2025-03-21 04:49:43,518] Trial 1 finished with value: 0.7772952914237976 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7772952914237976.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:49:45,411] A new study created in memory with name: no-name-1959e0a4-3089-488a-8d06-d79e49a762ad
[I 2025-03-21 04:49:50,543] Trial 0 finished with value: 0.7872615456581116 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7872615456581116.
[I 2025-03-21 04:49:54,196] Trial 1 finished with value: 0.7562570571899414 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7562570571899414.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:49:56,080] A new study created in memory with name: no-name-691d71c3-d02e-4750-8d80-b322800f0e17
[I 2025-03-21 04:49:58,391] Trial 0 finished with value: 0.7299612760543823 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7299612760543823.
[I 2025-03-21 04:50:03,093] Trial 1 finished with value: 0.7383468151092529 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7299612760543823.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:50:04,968] A new study created in memory with name: no-name-c224bebd-f9ea-4826-9d39-f387ffa8be34
[I 2025-03-21 04:50:08,936] Trial 0 finished with value: 0.7890588641166687 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7890588641166687.
[I 2025-03-21 04:50:13,096] Trial 1 finished with value: 0.8136768341064453 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7890588641166687.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:50:14,970] A new study created in memory with name: no-name-a038c6b3-7fd8-493e-9a91-f1fbd1b3e8bb
[I 2025-03-21 04:50:18,599] Trial 0 finished with value: 0.7931277751922607 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7931277751922607.
[I 2025-03-21 04:50:22,433] Trial 1 finished with value: 0.7983006834983826 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7931277751922607.
... storing 'Rank_Label' as categorical
2025-03-21 04:50:24,326 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10
Processing datasets for repeat 3:  10%|█         | 1/10 [01:34<14:14, 94.97s/it]2025-03-21 04:50:24,328 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9
[I 2025-03-21 04:50:54,752] A new study created in memory with name: no-name-24581a0e-c76a-41c9-b00b-8a1d3db7a0d5
[I 2025-03-21 04:50:59,635] Trial 0 finished with value: 0.7214655876159668 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7214655876159668.
[I 2025-03-21 04:51:03,592] Trial 1 finished with value: 0.7181409001350403 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7181409001350403.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7801
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7415
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.23%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7881
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7773
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7873
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7563
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 212(49.42%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7300
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7891
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 102(23.78%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7931
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7215
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7181
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:51:05,525] A new study created in memory with name: no-name-94dea3f6-6a12-44b2-8cc4-14696927aa74
[I 2025-03-21 04:51:13,976] Trial 0 finished with value: 0.6576849222183228 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6576849222183228.
[I 2025-03-21 04:51:21,052] Trial 1 finished with value: 0.7660161256790161 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6576849222183228.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:51:23,002] A new study created in memory with name: no-name-6db278ae-64cc-4e52-9046-4705e457cee0
[I 2025-03-21 04:51:25,766] Trial 0 finished with value: 0.7958751320838928 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7958751320838928.
[I 2025-03-21 04:51:29,721] Trial 1 finished with value: 0.8030951023101807 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7958751320838928.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:51:31,610] A new study created in memory with name: no-name-c9368d57-54e0-4077-ae1a-07a9adba742f
[I 2025-03-21 04:51:34,192] Trial 0 finished with value: 0.769465982913971 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.769465982913971.
[I 2025-03-21 04:51:38,724] Trial 1 finished with value: 0.7835290431976318 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.769465982913971.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:51:40,660] A new study created in memory with name: no-name-6dc00da8-537c-4891-8a7c-4818e1c6cde3
[I 2025-03-21 04:51:44,420] Trial 0 finished with value: 0.7744768261909485 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7744768261909485.
[I 2025-03-21 04:51:49,186] Trial 1 finished with value: 0.6681076884269714 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.6681076884269714.
... storing 'Rank_Label' as categorical
[I 2025-03-21 04:51:51,085] A new study created in memory with name: no-name-61d104cf-8159-4006-9c0e-4993d631d68b
[I 2025-03-21 04:51:54,400] Trial 0 finished with value: 0.837823212146759 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.837823212146759.
[I 2025-03-21 04:51:58,065] Trial 1 finished with value: 0.7711809873580933 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7711809873580933.
... storing 'Rank_Label' as categorical
2025-03-21 04:51:59,947 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9
Processing datasets for repeat 3:  20%|██        | 2/10 [03:10<12:42, 95.35s/it]2025-03-21 04:51:59,949 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8
[I 2025-03-21 05:00:47,404] A new study created in memory with name: no-name-9f682453-7a7a-4e72-9524-82525a76353f
[I 2025-03-21 05:04:03,684] Trial 0 finished with value: 0.6592285555341969 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6592285555341969.
[I 2025-03-21 05:07:20,156] Trial 1 finished with value: 0.6187581083048945 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6187581083048945.
... storing 'Rank_Label' as categorical
[I 2025-03-21 05:09:32,250] A new study created in memory with name: no-name-dd1ae0a8-cf28-4717-b9ff-d924621c3d53
[I 2025-03-21 05:13:14,269] Trial 0 finished with value: 0.8148819156315016 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8148819156315016.
[I 2025-03-21 05:16:28,018] Trial 1 finished with value: 0.5559117016584977 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.5559117016584977.
... storing 'Rank_Label' as categorical
Reject 205(47.79%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6577
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 121(28.21%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7959
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7695
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7745
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6681
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 3(0.70%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8378
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7712
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6592
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6188
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 8 components.
Reject 17922(76.48%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8149
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5559
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 297(1.27%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 05:19:21,472] A new study created in memory with name: no-name-6a9dfe65-0537-4657-b656-e8edb1a98b2c
[I 2025-03-21 05:23:49,588] Trial 0 finished with value: 0.6283247781836468 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6283247781836468.
[I 2025-03-21 05:26:47,163] Trial 1 finished with value: 0.6359314607537311 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6283247781836468.
... storing 'Rank_Label' as categorical
[I 2025-03-21 05:28:36,294] A new study created in memory with name: no-name-bcd242c4-2992-4644-8be7-bcf3ba48eaf2
[I 2025-03-21 05:32:07,052] Trial 0 finished with value: 0.7699255554572396 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7699255554572396.
[I 2025-03-21 05:36:09,489] Trial 1 finished with value: 0.807937767194665 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.7699255554572396.
... storing 'Rank_Label' as categorical
[I 2025-03-21 05:37:59,165] A new study created in memory with name: no-name-76bc678d-1719-4525-a1ae-b5374759553f
[I 2025-03-21 05:42:25,672] Trial 0 finished with value: 0.7040590695712877 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7040590695712877.
[I 2025-03-21 05:46:26,888] Trial 1 finished with value: 0.7108732928400454 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7040590695712877.
... storing 'Rank_Label' as categorical
[I 2025-03-21 05:48:16,093] A new study created in memory with name: no-name-9628b7d4-0686-4558-9f80-b81a74d5a3c4
[I 2025-03-21 05:51:10,991] Trial 0 finished with value: 0.8460169797358306 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8460169797358306.
[I 2025-03-21 05:54:09,481] Trial 1 finished with value: 0.7880013636920763 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7880013636920763.
... storing 'Rank_Label' as categorical
2025-03-21 05:55:58,132 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8
Processing datasets for repeat 3:  30%|███       | 3/10 [1:07:08<3:30:30, 1804.41s/it]2025-03-21 05:55:58,134 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7
[I 2025-03-21 06:05:40,791] A new study created in memory with name: no-name-023ae70c-2f51-4892-afdf-6e7cd13eabff
[I 2025-03-21 06:11:05,131] Trial 0 finished with value: 0.8489760601002238 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8489760601002238.
[I 2025-03-21 06:14:20,865] Trial 1 finished with value: 0.5253901844439299 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.5253901844439299.
... storing 'Rank_Label' as categorical
[I 2025-03-21 06:16:32,926] A new study created in memory with name: no-name-9035180d-5f6f-459b-88d7-e676e17c55fc
[I 2025-03-21 06:20:45,442] Trial 0 finished with value: 0.931121183478314 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.931121183478314.
[I 2025-03-21 06:25:33,644] Trial 1 finished with value: 0.8410360424414925 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 1 with value: 0.8410360424414925.
... storing 'Rank_Label' as categorical
[I 2025-03-21 06:27:57,454] A new study created in memory with name: no-name-cd07300a-2b4e-418e-aed9-eda7c9529fb3
[I 2025-03-21 06:30:58,800] Trial 0 finished with value: 0.7122325612151105 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7122325612151105.
[I 2025-03-21 06:33:59,497] Trial 1 finished with value: 0.8237858103669208 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7122325612151105.
... storing 'Rank_Label' as categorical
[I 2025-03-21 06:35:48,980] A new study created in memory with name: no-name-c40e36bc-682a-49e9-82bd-4e7e53987d68
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6283
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8(0.03%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7699
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7041
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 868(3.70%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8460
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7880
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8490
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5254
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.9311
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8410
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 6 components.
Reject 5771(24.63%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7122
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 10752(45.88%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
[I 2025-03-21 06:40:50,098] Trial 0 finished with value: 0.8347065578336301 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8347065578336301.
[I 2025-03-21 06:43:48,434] Trial 1 finished with value: 0.7704270637553671 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7704270637553671.
... storing 'Rank_Label' as categorical
[I 2025-03-21 06:45:37,606] A new study created in memory with name: no-name-63230bff-78ed-474f-882c-ee8ca0e58581
[I 2025-03-21 06:48:41,466] Trial 0 finished with value: 0.6925918330316958 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6925918330316958.
[I 2025-03-21 06:53:17,967] Trial 1 finished with value: 0.6943348024202429 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6925918330316958.
... storing 'Rank_Label' as categorical
[I 2025-03-21 06:55:07,548] A new study created in memory with name: no-name-0657f033-2627-4603-b751-4c635af61c20
[I 2025-03-21 06:58:07,315] Trial 0 finished with value: 0.8075862060422483 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8075862060422483.
[I 2025-03-21 07:02:10,953] Trial 1 finished with value: 0.7748282914576323 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7748282914576323.
... storing 'Rank_Label' as categorical
2025-03-21 07:03:59,737 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7
Processing datasets for repeat 3:  40%|████      | 4/10 [2:15:10<4:30:20, 2703.42s/it]2025-03-21 07:03:59,742 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6
[I 2025-03-21 07:04:20,224] A new study created in memory with name: no-name-5bd1fbba-8a13-47e1-8f74-63e79011be45
[I 2025-03-21 07:04:33,962] Trial 0 finished with value: 0.7502700686454773 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7502700686454773.
[I 2025-03-21 07:04:47,809] Trial 1 finished with value: 0.8230447173118591 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7502700686454773.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:04:50,730] A new study created in memory with name: no-name-894bb490-2a0e-4a8e-b9e9-2fffbade3392
[I 2025-03-21 07:05:05,726] Trial 0 finished with value: 0.8861788809299469 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8861788809299469.
[I 2025-03-21 07:05:14,790] Trial 1 finished with value: 0.8268575072288513 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 1 with value: 0.8268575072288513.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:05:17,626] A new study created in memory with name: no-name-6a7c0cb7-4f63-4e01-99ca-b6b620a3924f
[I 2025-03-21 07:05:26,316] Trial 0 finished with value: 0.5606730580329895 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.5606730580329895.
[I 2025-03-21 07:05:38,008] Trial 1 finished with value: 0.7531029880046844 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.5606730580329895.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:05:41,389] A new study created in memory with name: no-name-eec472d3-0746-47a1-bce7-19dfd5087efd
[I 2025-03-21 07:05:49,037] Trial 0 finished with value: 0.8014490008354187 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8014490008354187.
[I 2025-03-21 07:05:56,459] Trial 1 finished with value: 0.7693876028060913 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7693876028060913.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:05:59,477] A new study created in memory with name: no-name-489e691c-1b18-42a6-8b79-ea4504038791
[I 2025-03-21 07:06:08,365] Trial 0 finished with value: 0.6522614657878876 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6522614657878876.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8347
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7704
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6926
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 849(3.62%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8076
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7748
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7503
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8862
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8269
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5607
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 10 components.
Reject 1131(70.51%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8014
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7694
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6523
[I 2025-03-21 07:06:15,847] Trial 1 finished with value: 0.641693115234375 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.641693115234375.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:06:18,694] A new study created in memory with name: no-name-92c828c6-81eb-4791-ba25-ee12fdf9da25
[I 2025-03-21 07:06:26,386] Trial 0 finished with value: 0.8044564425945282 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8044564425945282.
[I 2025-03-21 07:06:32,577] Trial 1 finished with value: 0.8192059993743896 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8044564425945282.
... storing 'Rank_Label' as categorical
2025-03-21 07:06:35,404 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6
Processing datasets for repeat 3:  50%|█████     | 5/10 [2:17:46<2:28:43, 1784.68s/it]2025-03-21 07:06:35,406 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5
[I 2025-03-21 07:07:07,078] A new study created in memory with name: no-name-f74cd2fd-3a40-47e1-a743-1bcc9d50f30b
[I 2025-03-21 07:07:19,849] Trial 0 finished with value: 0.7978292107582092 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7978292107582092.
[I 2025-03-21 07:07:29,404] Trial 1 finished with value: 0.762467235326767 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 1 with value: 0.762467235326767.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:07:32,319] A new study created in memory with name: no-name-3ce549f5-e94d-4e45-9ad0-493d79962dbe
[I 2025-03-21 07:07:41,170] Trial 0 finished with value: 0.7876327335834503 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7876327335834503.
[I 2025-03-21 07:07:51,515] Trial 1 finished with value: 0.7645494937896729 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7645494937896729.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:07:54,568] A new study created in memory with name: no-name-2e98b812-4395-44a2-838f-445e67b0f190
[I 2025-03-21 07:08:02,887] Trial 0 finished with value: 0.8248805105686188 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8248805105686188.
[I 2025-03-21 07:08:12,683] Trial 1 finished with value: 0.7589778006076813 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7589778006076813.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:08:15,688] A new study created in memory with name: no-name-3a4b2b55-e927-4e01-a78f-752f957a7a1b
[I 2025-03-21 07:08:23,910] Trial 0 finished with value: 0.7950326502323151 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7950326502323151.
[I 2025-03-21 07:08:30,902] Trial 1 finished with value: 0.8547146320343018 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7950326502323151.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:08:33,764] A new study created in memory with name: no-name-fff986cd-d681-4a77-9fcd-b6845586d692
[I 2025-03-21 07:08:43,101] Trial 0 finished with value: 0.7119798958301544 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7119798958301544.
[I 2025-03-21 07:08:52,296] Trial 1 finished with value: 0.8494651317596436 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7119798958301544.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:08:55,209] A new study created in memory with name: no-name-aca52dfd-cee9-4a32-b7d8-806258e4e643
[I 2025-03-21 07:09:04,241] Trial 0 finished with value: 0.8358441889286041 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8358441889286041.
[I 2025-03-21 07:09:11,258] Trial 1 finished with value: 0.8504492342472076 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8358441889286041.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6417
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 15(0.94%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8045
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7978
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7625
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7876
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7645
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 273(17.02%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8249
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7590
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7950
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7120
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 112(6.98%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8358
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
... storing 'Rank_Label' as categorical
2025-03-21 07:09:14,097 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data5
Processing datasets for repeat 3:  60%|██████    | 6/10 [2:20:24<1:22:07, 1231.84s/it]2025-03-21 07:09:14,099 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4
[I 2025-03-21 07:09:53,145] A new study created in memory with name: no-name-b99ee680-cedf-4738-83cc-c73695148e3e
[I 2025-03-21 07:09:58,634] Trial 0 finished with value: 0.7356435656547546 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7356435656547546.
[I 2025-03-21 07:10:03,506] Trial 1 finished with value: 0.783080518245697 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7356435656547546.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:10:06,311] A new study created in memory with name: no-name-951c729a-b992-4b15-8dd5-5a4abea7f6ad
[I 2025-03-21 07:10:12,840] Trial 0 finished with value: 0.8213165998458862 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.8213165998458862.
[I 2025-03-21 07:10:18,329] Trial 1 finished with value: 0.7387104034423828 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7387104034423828.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:10:21,086] A new study created in memory with name: no-name-cf4d6d88-8283-4f37-8933-03945512c6d3
[I 2025-03-21 07:10:25,128] Trial 0 finished with value: 0.792208731174469 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.792208731174469.
[I 2025-03-21 07:10:26,942] Trial 1 finished with value: 0.7318321466445923 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7318321466445923.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:10:29,729] A new study created in memory with name: no-name-adff8acc-439c-4fa3-900a-b446f1f56473
[I 2025-03-21 07:10:33,863] Trial 0 finished with value: 0.8081732988357544 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8081732988357544.
[I 2025-03-21 07:10:38,036] Trial 1 finished with value: 0.7118639945983887 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7118639945983887.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:10:40,766] A new study created in memory with name: no-name-edfcab53-a621-4027-9cb8-bc5e4ebb6ea0
[I 2025-03-21 07:10:44,275] Trial 0 finished with value: 0.7015842199325562 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7015842199325562.
[I 2025-03-21 07:10:48,372] Trial 1 finished with value: 0.7928979992866516 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7015842199325562.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:10:51,114] A new study created in memory with name: no-name-e2ae2e42-ab85-45f1-964a-77fd58244593
[I 2025-03-21 07:10:54,347] Trial 0 finished with value: 0.8216814398765564 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8216814398765564.
[I 2025-03-21 07:10:59,167] Trial 1 finished with value: 0.8006258606910706 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.8006258606910706.
... storing 'Rank_Label' as categorical
2025-03-21 07:11:01,917 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4
Processing datasets for repeat 3:  70%|███████   | 7/10 [2:22:12<43:13, 864.37s/it]   2025-03-21 07:11:01,918 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3
[I 2025-03-21 07:11:39,484] A new study created in memory with name: no-name-4f49c108-8a91-4648-bb2a-a1be6e312531
[I 2025-03-21 07:11:42,873] Trial 0 finished with value: 0.6505292654037476 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6505292654037476.
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7356
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 6 components.
Reject 290(89.51%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8213
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7387
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7922
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7318
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 12 components.
Reject 268(82.72%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8082
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7119
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7016
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8(2.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8217
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8006
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6505
[I 2025-03-21 07:11:48,201] Trial 1 finished with value: 0.7362962961196899 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6505292654037476.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:11:51,046] A new study created in memory with name: no-name-bf261278-2e7c-46bf-9864-609bd6cf294f
[I 2025-03-21 07:12:00,431] Trial 0 finished with value: 0.6611853837966919 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6611853837966919.
[I 2025-03-21 07:12:06,490] Trial 1 finished with value: 0.6970105767250061 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6611853837966919.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:12:09,304] A new study created in memory with name: no-name-db8806e0-bf2f-474f-8865-3c84a3b69a68
[I 2025-03-21 07:12:12,498] Trial 0 finished with value: 0.7252213358879089 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7252213358879089.
[I 2025-03-21 07:12:15,691] Trial 1 finished with value: 0.7342367172241211 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7252213358879089.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:12:18,436] A new study created in memory with name: no-name-6cbd9c7b-88aa-471b-8a61-77bd981f5a06
[I 2025-03-21 07:12:21,699] Trial 0 finished with value: 0.7369765043258667 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7369765043258667.
[I 2025-03-21 07:12:24,858] Trial 1 finished with value: 0.7556990385055542 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7369765043258667.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:12:27,575] A new study created in memory with name: no-name-f089acb9-37c5-4a99-a651-6a0e28d9df76
[I 2025-03-21 07:12:32,129] Trial 0 finished with value: 0.6962774991989136 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6962774991989136.
[I 2025-03-21 07:12:35,525] Trial 1 finished with value: 0.6801024675369263 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6801024675369263.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:12:38,320] A new study created in memory with name: no-name-41addf22-2e21-4138-9f2d-1cc085388414
[I 2025-03-21 07:12:41,056] Trial 0 finished with value: 0.8051106929779053 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8051106929779053.
[I 2025-03-21 07:12:44,832] Trial 1 finished with value: 0.7911746501922607 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7911746501922607.
... storing 'Rank_Label' as categorical
2025-03-21 07:12:47,578 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3
Processing datasets for repeat 3:  80%|████████  | 8/10 [2:23:58<20:45, 622.84s/it]2025-03-21 07:12:47,580 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2
[I 2025-03-21 07:13:17,212] A new study created in memory with name: no-name-a4eb7481-acf3-4124-881b-9b5f15f94a4a
[I 2025-03-21 07:13:22,665] Trial 0 finished with value: 0.7393286824226379 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7393286824226379.
[I 2025-03-21 07:13:28,014] Trial 1 finished with value: 0.7565940618515015 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7393286824226379.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:13:31,371] A new study created in memory with name: no-name-ccda0536-507e-40f2-a2f2-816c680d6178
[I 2025-03-21 07:13:38,737] Trial 0 finished with value: 0.8019512891769409 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.8019512891769409.
[I 2025-03-21 07:13:47,053] Trial 1 finished with value: 0.8366267681121826 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8019512891769409.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 3 components.
Reject 267(82.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6612
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 10 components.
Reject 257(79.32%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7252
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 109(33.64%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7370
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6963
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6801
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 11 components.
Reject 113(34.88%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8051
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7912
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7393
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 69(13.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8020
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:13:50,420] A new study created in memory with name: no-name-0d901012-2302-4fb4-be28-ee93d951a007
[I 2025-03-21 07:13:56,196] Trial 0 finished with value: 0.7596607804298401 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7596607804298401.
[I 2025-03-21 07:14:00,856] Trial 1 finished with value: 0.7714245319366455 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7596607804298401.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:14:04,184] A new study created in memory with name: no-name-2e4c2930-d248-4a70-b464-feb68778549c
[I 2025-03-21 07:14:08,518] Trial 0 finished with value: 0.7734949588775635 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7734949588775635.
[I 2025-03-21 07:14:14,185] Trial 1 finished with value: 0.7925347089767456 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.7734949588775635.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:14:17,501] A new study created in memory with name: no-name-f2518200-e867-4b85-81fd-5d7e22609f1c
[I 2025-03-21 07:14:21,920] Trial 0 finished with value: 0.7882826924324036 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7882826924324036.
[I 2025-03-21 07:14:25,441] Trial 1 finished with value: 0.8228991627693176 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7882826924324036.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:14:28,901] A new study created in memory with name: no-name-9397a817-f25d-41c9-858b-05c05f036ee0
[I 2025-03-21 07:14:34,008] Trial 0 finished with value: 0.7919887900352478 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7919887900352478.
[I 2025-03-21 07:14:37,906] Trial 1 finished with value: 0.7918387055397034 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7918387055397034.
... storing 'Rank_Label' as categorical
2025-03-21 07:14:41,224 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2
Processing datasets for repeat 3:  90%|█████████ | 9/10 [2:25:51<07:43, 463.66s/it]2025-03-21 07:14:41,226 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1
[I 2025-03-21 07:15:14,082] A new study created in memory with name: no-name-878fbe83-0397-4484-90a2-339eaf2c9712
[I 2025-03-21 07:15:18,031] Trial 0 finished with value: 0.8379639387130737 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8379639387130737.
[I 2025-03-21 07:15:21,545] Trial 1 finished with value: 0.6440548896789551 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6440548896789551.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:15:24,953] A new study created in memory with name: no-name-28bac22c-770f-4727-b4ce-9f802a960360
[I 2025-03-21 07:15:31,505] Trial 0 finished with value: 0.8680025339126587 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8680025339126587.
[I 2025-03-21 07:15:39,175] Trial 1 finished with value: 0.8556246757507324 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.8556246757507324.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:15:42,537] A new study created in memory with name: no-name-8200e610-bef6-47d8-ab59-9d5745deefdb
[I 2025-03-21 07:15:47,267] Trial 0 finished with value: 0.8022785186767578 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8022785186767578.
[I 2025-03-21 07:15:50,539] Trial 1 finished with value: 0.7906538844108582 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7906538844108582.
... storing 'Rank_Label' as categorical
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7597
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 256(50.49%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7735
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7883
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2(0.39%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7920
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7918
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8380
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6441
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8680
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8556
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 138(27.22%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8023
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7907
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 07:15:53,873] A new study created in memory with name: no-name-396ff878-a18d-4132-b35c-f4fab83bf54d
[I 2025-03-21 07:15:56,930] Trial 0 finished with value: 0.7425888776779175 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7425888776779175.
[I 2025-03-21 07:15:59,772] Trial 1 finished with value: 0.7686240673065186 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7425888776779175.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:16:03,124] A new study created in memory with name: no-name-7b0f424f-9a56-4f68-aa5f-d5f710cbbdb5
[I 2025-03-21 07:16:06,040] Trial 0 finished with value: 0.8088912963867188 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.8088912963867188.
[I 2025-03-21 07:16:10,465] Trial 1 finished with value: 0.777628481388092 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.777628481388092.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:16:13,795] A new study created in memory with name: no-name-b9815afe-6d8e-436f-819f-b62cae53fdda
[I 2025-03-21 07:16:17,241] Trial 0 finished with value: 0.8426879644393921 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8426879644393921.
[I 2025-03-21 07:16:20,064] Trial 1 finished with value: 0.7805479168891907 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7805479168891907.
... storing 'Rank_Label' as categorical
2025-03-21 07:16:23,423 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1
Processing datasets for repeat 3: 100%|██████████| 10/10 [2:27:34<00:00, 352.07s/it]Processing datasets for repeat 3: 100%|██████████| 10/10 [2:27:34<00:00, 885.41s/it]
2025-03-21 07:16:23,425 - Repeat 3 completed
2025-03-21 07:16:23,425 - Starting repeat 4
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7426
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8089
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7776
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_3/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8427
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7805
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 4:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 07:16:23,432 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10
[I 2025-03-21 07:16:46,298] A new study created in memory with name: no-name-21e123e4-7a0d-4409-935c-70073cf9918d
[I 2025-03-21 07:16:51,228] Trial 0 finished with value: 0.7215741872787476 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7215741872787476.
[I 2025-03-21 07:16:55,556] Trial 1 finished with value: 0.9603719115257263 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7215741872787476.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:16:57,500] A new study created in memory with name: no-name-87711382-fb0a-4982-a99c-67091ed32da4
[I 2025-03-21 07:17:04,603] Trial 0 finished with value: 0.7943665981292725 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7943665981292725.
[I 2025-03-21 07:17:11,857] Trial 1 finished with value: 0.7798015475273132 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7798015475273132.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:17:13,784] A new study created in memory with name: no-name-6f6344f1-11aa-48cd-a2de-1af1fcebab93
[I 2025-03-21 07:17:17,407] Trial 0 finished with value: 0.7906383275985718 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7906383275985718.
[I 2025-03-21 07:17:21,356] Trial 1 finished with value: 0.7766414284706116 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7766414284706116.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:17:23,291] A new study created in memory with name: no-name-5cfc6f59-e30f-41e3-99bc-bd5ea0edeb4b
[I 2025-03-21 07:17:27,500] Trial 0 finished with value: 0.7893959879875183 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.7893959879875183.
[I 2025-03-21 07:17:31,549] Trial 1 finished with value: 0.7344444394111633 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7344444394111633.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:17:33,513] A new study created in memory with name: no-name-1e93ca98-d9ad-493a-9cd6-c49c35105273
[I 2025-03-21 07:17:37,111] Trial 0 finished with value: 0.7998784184455872 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7998784184455872.
[I 2025-03-21 07:17:40,623] Trial 1 finished with value: 0.7857764363288879 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7857764363288879.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:17:42,531] A new study created in memory with name: no-name-28820d67-9fe2-4b21-b990-4bf0e5d1f8e4
[I 2025-03-21 07:17:46,735] Trial 0 finished with value: 0.7952655553817749 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7952655553817749.
[I 2025-03-21 07:17:51,150] Trial 1 finished with value: 0.7898927927017212 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7898927927017212.
... storing 'Rank_Label' as categorical
2025-03-21 07:17:53,049 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10
Processing datasets for repeat 4:  10%|█         | 1/10 [01:29<13:26, 89.62s/it]2025-03-21 07:17:53,051 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9
[I 2025-03-21 07:18:23,836] A new study created in memory with name: no-name-115948d5-d55b-4785-b7de-688cfc21451e
[I 2025-03-21 07:18:27,668] Trial 0 finished with value: 0.7423526644706726 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7423526644706726.
[I 2025-03-21 07:18:31,136] Trial 1 finished with value: 0.7329775094985962 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7329775094985962.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7216
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 293(68.30%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7944
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7798
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2(0.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7906
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7766
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 106(24.71%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7894
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7344
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7999
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7858
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 9(2.10%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7953
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7899
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7424
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7330
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:18:33,089] A new study created in memory with name: no-name-27c0adc9-1640-45d6-b854-2acba3ae4efd
[I 2025-03-21 07:18:40,598] Trial 0 finished with value: 0.7513061761856079 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7513061761856079.
[I 2025-03-21 07:18:46,149] Trial 1 finished with value: 0.8421048521995544 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7513061761856079.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:18:48,067] A new study created in memory with name: no-name-566b818e-9d45-46c3-8d7a-900a81a98446
[I 2025-03-21 07:18:50,897] Trial 0 finished with value: 0.7098260521888733 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7098260521888733.
[I 2025-03-21 07:18:55,156] Trial 1 finished with value: 0.6717987060546875 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.6717987060546875.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:18:57,043] A new study created in memory with name: no-name-83efb549-64ec-41bd-8248-d35d7810a96e
[I 2025-03-21 07:19:01,928] Trial 0 finished with value: 0.7746936678886414 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7746936678886414.
[I 2025-03-21 07:19:06,492] Trial 1 finished with value: 0.8088642358779907 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7746936678886414.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:19:08,399] A new study created in memory with name: no-name-87e62869-0541-44f3-953d-7b5a5a6811f1
[I 2025-03-21 07:19:13,019] Trial 0 finished with value: 0.72800612449646 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.72800612449646.
[I 2025-03-21 07:19:16,161] Trial 1 finished with value: 0.6737821698188782 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.6737821698188782.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:19:18,069] A new study created in memory with name: no-name-cf5b142e-5020-4943-a5ca-c80ebb35f4e1
[I 2025-03-21 07:19:21,874] Trial 0 finished with value: 0.8031125664710999 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8031125664710999.
[I 2025-03-21 07:19:25,683] Trial 1 finished with value: 0.830919086933136 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8031125664710999.
... storing 'Rank_Label' as categorical
2025-03-21 07:19:27,593 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9
Processing datasets for repeat 4:  20%|██        | 2/10 [03:04<12:20, 92.52s/it]2025-03-21 07:19:27,595 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8
[I 2025-03-21 07:28:17,087] A new study created in memory with name: no-name-c8d473ef-c6e0-4dfd-95f4-bbd84f592934
[I 2025-03-21 07:32:04,427] Trial 0 finished with value: 0.6038426057152126 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.6038426057152126.
[I 2025-03-21 07:35:19,430] Trial 1 finished with value: 0.6170765627985415 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6038426057152126.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:37:09,021] A new study created in memory with name: no-name-c87d329f-8da5-47f7-b4b3-f983803e60c8
[I 2025-03-21 07:40:19,729] Trial 0 finished with value: 0.5790298062822093 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.5790298062822093.
[I 2025-03-21 07:43:28,320] Trial 1 finished with value: 0.5723966722903044 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.5723966722903044.
... storing 'Rank_Label' as categorical
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7513
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7098
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6718
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 217(50.58%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7747
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7280
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6738
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 8(1.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8031
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6038
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 5697(24.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5790
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5724
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 8978(38.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 07:45:25,954] A new study created in memory with name: no-name-8e09acd5-7904-414a-9b42-b46501782dd5
[I 2025-03-21 07:48:26,885] Trial 0 finished with value: 0.5615114958389945 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.5615114958389945.
[I 2025-03-21 07:51:57,077] Trial 1 finished with value: 0.6181455047234244 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.5615114958389945.
... storing 'Rank_Label' as categorical
[I 2025-03-21 07:54:41,261] A new study created in memory with name: no-name-53a432fb-81f5-450c-9d76-fa9432d72c18
[I 2025-03-21 07:58:39,842] Trial 0 finished with value: 0.7358931251194166 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7358931251194166.
[I 2025-03-21 08:02:05,967] Trial 1 finished with value: 0.8045233073441879 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7358931251194166.
... storing 'Rank_Label' as categorical
[I 2025-03-21 08:03:55,604] A new study created in memory with name: no-name-fd8a6f32-e9f1-4052-b1bf-2b96609fda22
[I 2025-03-21 08:08:26,565] Trial 0 finished with value: 0.6496505504069121 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6496505504069121.
[I 2025-03-21 08:12:53,507] Trial 1 finished with value: 0.6674427701079327 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6496505504069121.
... storing 'Rank_Label' as categorical
[I 2025-03-21 08:14:44,578] A new study created in memory with name: no-name-2da517fd-d67c-412d-80e7-233657702dd3
[I 2025-03-21 08:17:43,254] Trial 0 finished with value: 0.8174919719281404 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.8174919719281404.
[I 2025-03-21 08:21:42,261] Trial 1 finished with value: 0.7810370429702427 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7810370429702427.
... storing 'Rank_Label' as categorical
2025-03-21 08:23:30,864 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8
Processing datasets for repeat 4:  30%|███       | 3/10 [1:07:07<3:30:36, 1805.19s/it]2025-03-21 08:23:30,872 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7
[I 2025-03-21 08:32:48,838] A new study created in memory with name: no-name-a4d82e5e-9f99-412a-9a60-d5d7f91d471e
[I 2025-03-21 08:38:16,504] Trial 0 finished with value: 0.6104404019272845 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6104404019272845.
[I 2025-03-21 08:43:45,782] Trial 1 finished with value: 0.7450231728346451 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6104404019272845.
... storing 'Rank_Label' as categorical
[I 2025-03-21 08:45:58,377] A new study created in memory with name: no-name-d2c5594c-58dc-4535-87d9-19c3eb4fb327
[I 2025-03-21 08:50:52,641] Trial 0 finished with value: 0.6611164030821427 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6611164030821427.
[I 2025-03-21 08:56:05,862] Trial 1 finished with value: 0.8147114411644314 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6611164030821427.
... storing 'Rank_Label' as categorical
[I 2025-03-21 08:58:36,862] A new study created in memory with name: no-name-2f45eb53-fa26-4551-a7d5-96b0a8eeeefc
[I 2025-03-21 09:03:18,780] Trial 0 finished with value: 0.8185536887334741 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8185536887334741.
[I 2025-03-21 09:06:17,704] Trial 1 finished with value: 0.775649394678033 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.775649394678033.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:08:07,815] A new study created in memory with name: no-name-03d94ea3-be15-4c53-a662-2e7b024bd324
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5615
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 13398(57.17%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7359
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6497
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 9 components.
Reject 3721(15.88%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8175
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7810
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6104
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 16485(70.35%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6611
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 22(0.09%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8186
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7756
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 5 components.
Reject 1815(7.75%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
[I 2025-03-21 09:12:46,170] Trial 0 finished with value: 0.7820881268252498 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7820881268252498.
[I 2025-03-21 09:17:24,401] Trial 1 finished with value: 0.7705686584762905 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 1 with value: 0.7705686584762905.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:19:13,566] A new study created in memory with name: no-name-d014d250-ea62-4804-b328-d95bb20f3c6c
[I 2025-03-21 09:22:50,974] Trial 0 finished with value: 0.7204035727874093 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7204035727874093.
[I 2025-03-21 09:25:56,110] Trial 1 finished with value: 0.7063690838606461 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7063690838606461.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:27:46,019] A new study created in memory with name: no-name-5e0bb857-7f93-45f3-85c0-a2fd41024b5b
[I 2025-03-21 09:31:11,248] Trial 0 finished with value: 0.7993870533030966 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7993870533030966.
[I 2025-03-21 09:35:12,040] Trial 1 finished with value: 0.8467300793398982 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7993870533030966.
... storing 'Rank_Label' as categorical
2025-03-21 09:37:01,129 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7
Processing datasets for repeat 4:  40%|████      | 4/10 [2:20:37<4:43:21, 2833.65s/it]2025-03-21 09:37:01,154 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6
[I 2025-03-21 09:37:23,731] A new study created in memory with name: no-name-665da341-ce79-4faa-bcd8-10a5e3d349b5
[I 2025-03-21 09:37:36,940] Trial 0 finished with value: 0.6071706712245941 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.6071706712245941.
[I 2025-03-21 09:37:50,560] Trial 1 finished with value: 0.7354581356048584 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6071706712245941.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:37:53,562] A new study created in memory with name: no-name-11e126a7-28cc-454b-8031-c67889550dff
[I 2025-03-21 09:38:05,374] Trial 0 finished with value: 0.6221963167190552 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6221963167190552.
[I 2025-03-21 09:38:18,338] Trial 1 finished with value: 0.6920112669467926 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6221963167190552.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:38:21,250] A new study created in memory with name: no-name-e5a2ba18-733c-4511-bb14-862a4dd67349
[I 2025-03-21 09:38:31,671] Trial 0 finished with value: 0.7600497007369995 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7600497007369995.
[I 2025-03-21 09:38:42,104] Trial 1 finished with value: 0.5552074015140533 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 1 with value: 0.5552074015140533.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:38:45,937] A new study created in memory with name: no-name-5811f44a-0240-41bf-b928-574d4864af05
[I 2025-03-21 09:38:54,783] Trial 0 finished with value: 0.8047182559967041 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8047182559967041.
[I 2025-03-21 09:39:06,994] Trial 1 finished with value: 0.7492592334747314 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7492592334747314.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:39:09,873] A new study created in memory with name: no-name-97b60b43-b7a3-47df-b205-59d3958c1c4b
[I 2025-03-21 09:39:22,895] Trial 0 finished with value: 0.6416981816291809 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6416981816291809.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7821
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7706
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7204
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7064
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 252(1.08%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7994
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6072
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6222
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 425(26.50%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7600
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5552
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 12 components.
Reject 1001(62.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8047
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7493
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6417
[I 2025-03-21 09:39:34,363] Trial 1 finished with value: 0.6085279881954193 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6085279881954193.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:39:37,880] A new study created in memory with name: no-name-d41654ef-50a1-4891-84da-7ea424828869
[I 2025-03-21 09:39:50,535] Trial 0 finished with value: 0.7813719809055328 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7813719809055328.
[I 2025-03-21 09:39:59,435] Trial 1 finished with value: 0.7988053858280182 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7813719809055328.
... storing 'Rank_Label' as categorical
2025-03-21 09:40:02,312 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6
Processing datasets for repeat 4:  50%|█████     | 5/10 [2:23:38<2:36:25, 1877.15s/it]2025-03-21 09:40:02,315 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5
[I 2025-03-21 09:40:36,065] A new study created in memory with name: no-name-9e5a70bc-8876-45d3-8b46-9ffd3ddf3a3a
[I 2025-03-21 09:40:47,493] Trial 0 finished with value: 1.0854265093803406 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 1.0854265093803406.
[I 2025-03-21 09:40:57,496] Trial 1 finished with value: 0.6668877601623535 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.6668877601623535.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:41:00,504] A new study created in memory with name: no-name-91698fd2-3cba-4d70-8966-094825c5859f
[I 2025-03-21 09:41:14,285] Trial 0 finished with value: 0.8581700325012207 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8581700325012207.
[I 2025-03-21 09:41:25,487] Trial 1 finished with value: 0.745789498090744 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 1 with value: 0.745789498090744.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:41:28,376] A new study created in memory with name: no-name-99180af3-8ea7-43eb-ad68-f2fda5c32ebc
[I 2025-03-21 09:41:39,130] Trial 0 finished with value: 0.7966468632221222 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7966468632221222.
[I 2025-03-21 09:41:51,211] Trial 1 finished with value: 0.7993083596229553 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7966468632221222.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:41:54,082] A new study created in memory with name: no-name-973b2b43-51cc-493a-bc03-9e2ac621601d
[I 2025-03-21 09:42:02,816] Trial 0 finished with value: 0.8216932117938995 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8216932117938995.
[I 2025-03-21 09:42:14,561] Trial 1 finished with value: 0.7749386429786682 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7749386429786682.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:42:17,601] A new study created in memory with name: no-name-7548df0b-7e56-4d30-81e5-537765c3e314
[I 2025-03-21 09:42:28,406] Trial 0 finished with value: 0.8229871392250061 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.8229871392250061.
[I 2025-03-21 09:42:40,033] Trial 1 finished with value: 0.8140873312950134 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.8140873312950134.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:42:42,898] A new study created in memory with name: no-name-fa1a6c8a-28e1-4aa6-90b4-17098add5f41
[I 2025-03-21 09:42:51,461] Trial 0 finished with value: 0.7509466111660004 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7509466111660004.
[I 2025-03-21 09:43:04,009] Trial 1 finished with value: 0.7943693101406097 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7509466111660004.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6085
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 11 components.
Reject 98(6.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7814
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 1.0854
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6669
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8582
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7458
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.06%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7966
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8217
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7749
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8230
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.8141
Best hyperparameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 12(0.75%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7509
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: ... storing 'Rank_Label' as categorical
2025-03-21 09:43:06,878 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data5
Processing datasets for repeat 4:  60%|██████    | 6/10 [2:26:43<1:26:46, 1301.67s/it]2025-03-21 09:43:06,879 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4
[I 2025-03-21 09:43:48,237] A new study created in memory with name: no-name-e6e196c8-bd9c-4567-91e0-ee0a0b4a8c87
[I 2025-03-21 09:43:54,993] Trial 0 finished with value: 0.6661646962165833 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6661646962165833.
[I 2025-03-21 09:43:58,385] Trial 1 finished with value: 0.7346153259277344 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6661646962165833.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:44:01,221] A new study created in memory with name: no-name-019965cc-134d-485f-ae38-0efb1dc9cb98
[I 2025-03-21 09:44:10,237] Trial 0 finished with value: 0.8357920050621033 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8357920050621033.
[I 2025-03-21 09:44:16,165] Trial 1 finished with value: 0.8168635368347168 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 1 with value: 0.8168635368347168.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:44:18,992] A new study created in memory with name: no-name-ea4f3bdf-8610-469e-8f88-f5bc90acf8f4
[I 2025-03-21 09:44:23,917] Trial 0 finished with value: 0.644859790802002 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.644859790802002.
[I 2025-03-21 09:44:27,080] Trial 1 finished with value: 0.6873648762702942 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.644859790802002.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:44:29,933] A new study created in memory with name: no-name-7928044b-e565-42f3-b625-d659a4598e16
[I 2025-03-21 09:44:33,463] Trial 0 finished with value: 0.7362792491912842 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7362792491912842.
[I 2025-03-21 09:44:39,105] Trial 1 finished with value: 0.74321049451828 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7362792491912842.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:44:41,941] A new study created in memory with name: no-name-404b6d52-853d-40a1-90da-585af5046647
[I 2025-03-21 09:44:47,225] Trial 0 finished with value: 0.7157325148582458 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7157325148582458.
[I 2025-03-21 09:44:51,059] Trial 1 finished with value: 0.7147785425186157 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7147785425186157.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:44:53,878] A new study created in memory with name: no-name-27ef83dd-f44b-4309-92ad-a5a83ffcaa02
[I 2025-03-21 09:44:57,279] Trial 0 finished with value: 0.7809771299362183 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7809771299362183.
[I 2025-03-21 09:45:01,920] Trial 1 finished with value: 0.7782474160194397 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7782474160194397.
... storing 'Rank_Label' as categorical
2025-03-21 09:45:04,713 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4
Processing datasets for repeat 4:  70%|███████   | 7/10 [2:28:41<45:43, 914.64s/it]   2025-03-21 09:45:04,715 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3
[I 2025-03-21 09:45:43,348] A new study created in memory with name: no-name-60b4945a-f35b-4a3c-8d0e-d56bfa2c39e3
[I 2025-03-21 09:45:49,393] Trial 0 finished with value: 0.7040033936500549 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7040033936500549.
{'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6662
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 141(43.52%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8358
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8169
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6449
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 255(78.70%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7363
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7157
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7148
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 52(16.05%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7810
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7782
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7040
[I 2025-03-21 09:45:54,675] Trial 1 finished with value: 0.6629777550697327 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6629777550697327.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:45:57,550] A new study created in memory with name: no-name-a408a08a-f5ca-45ea-b83b-8f9e6f8332d9
[I 2025-03-21 09:46:03,208] Trial 0 finished with value: 0.8206005096435547 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8206005096435547.
[I 2025-03-21 09:46:11,089] Trial 1 finished with value: 0.815963864326477 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 1 with value: 0.815963864326477.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:46:13,920] A new study created in memory with name: no-name-9f92c8ae-b85a-4117-a859-4149b72946f1
[I 2025-03-21 09:46:18,383] Trial 0 finished with value: 0.832373321056366 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.832373321056366.
[I 2025-03-21 09:46:23,666] Trial 1 finished with value: 0.7165642380714417 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7165642380714417.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:46:26,463] A new study created in memory with name: no-name-4a352322-e84e-423f-b70d-8d2d688dccd6
[I 2025-03-21 09:46:31,645] Trial 0 finished with value: 0.7397427558898926 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.7397427558898926.
[I 2025-03-21 09:46:36,839] Trial 1 finished with value: 0.7222710251808167 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7222710251808167.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:46:39,659] A new study created in memory with name: no-name-a1143220-6071-4aa4-8666-12635f343cf5
[I 2025-03-21 09:46:43,889] Trial 0 finished with value: 0.7018790245056152 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7018790245056152.
[I 2025-03-21 09:46:48,376] Trial 1 finished with value: 0.7147957682609558 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7018790245056152.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:46:51,423] A new study created in memory with name: no-name-2b7ae7dd-fb2d-4fe3-a781-6ddcc362db28
[I 2025-03-21 09:46:54,814] Trial 0 finished with value: 0.7676234245300293 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7676234245300293.
[I 2025-03-21 09:47:00,206] Trial 1 finished with value: 0.8364356756210327 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7676234245300293.
... storing 'Rank_Label' as categorical
2025-03-21 09:47:03,017 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3
Processing datasets for repeat 4:  80%|████████  | 8/10 [2:30:39<22:02, 661.13s/it]2025-03-21 09:47:03,019 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2
[I 2025-03-21 09:47:29,477] A new study created in memory with name: no-name-40d0797e-872e-4ff9-b3ca-c969683e5c6e
[I 2025-03-21 09:47:37,410] Trial 0 finished with value: 0.7063511610031128 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7063511610031128.
[I 2025-03-21 09:47:44,359] Trial 1 finished with value: 0.7715450525283813 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7063511610031128.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:47:47,925] A new study created in memory with name: no-name-1a35c6b0-8962-4a00-8985-ddfad9cbecbb
[I 2025-03-21 09:47:55,744] Trial 0 finished with value: 0.7644568085670471 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7644568085670471.
[I 2025-03-21 09:48:02,400] Trial 1 finished with value: 0.8242453932762146 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7644568085670471.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6630
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 11 components.
Reject 92(28.40%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8206
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8160
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8324
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7166
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 89(27.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7397
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7223
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7019
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 114(35.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7676
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7064
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 284(56.02%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7645
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: ... storing 'Rank_Label' as categorical
[I 2025-03-21 09:48:05,851] A new study created in memory with name: no-name-26654bc3-18b3-4d73-816b-93cb6d0615f8
[I 2025-03-21 09:48:10,826] Trial 0 finished with value: 0.7323532104492188 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7323532104492188.
[I 2025-03-21 09:48:15,136] Trial 1 finished with value: 0.7909436225891113 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7323532104492188.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:48:18,582] A new study created in memory with name: no-name-a21acd9a-d72c-4377-a682-1ff39d5d9857
[I 2025-03-21 09:48:25,414] Trial 0 finished with value: 0.7531628608703613 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7531628608703613.
[I 2025-03-21 09:48:31,715] Trial 1 finished with value: 0.7910409569740295 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7531628608703613.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:48:35,154] A new study created in memory with name: no-name-42356617-0ca0-4f1b-bc24-78d93909893c
[I 2025-03-21 09:48:42,505] Trial 0 finished with value: 0.7887328863143921 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7887328863143921.
[I 2025-03-21 09:48:48,521] Trial 1 finished with value: 0.8060368299484253 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7887328863143921.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:48:51,961] A new study created in memory with name: no-name-dd56df6c-26e4-4b37-b6f6-7ec2d2b5c02c
[I 2025-03-21 09:48:56,545] Trial 0 finished with value: 0.7895123958587646 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7895123958587646.
[I 2025-03-21 09:49:03,487] Trial 1 finished with value: 0.7928874492645264 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7895123958587646.
... storing 'Rank_Label' as categorical
2025-03-21 09:49:06,912 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2
Processing datasets for repeat 4:  90%|█████████ | 9/10 [2:32:43<08:13, 493.18s/it]2025-03-21 09:49:06,913 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1
[I 2025-03-21 09:49:42,502] A new study created in memory with name: no-name-e66be925-17a0-48be-8a64-eacdaf46b652
[I 2025-03-21 09:49:46,777] Trial 0 finished with value: 0.8823966383934021 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8823966383934021.
[I 2025-03-21 09:49:53,359] Trial 1 finished with value: 0.7624765634536743 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7624765634536743.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:49:57,026] A new study created in memory with name: no-name-04742a56-5cf1-448c-9b1e-40671e6773f5
[I 2025-03-21 09:50:02,704] Trial 0 finished with value: 0.8172847628593445 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8172847628593445.
[I 2025-03-21 09:50:07,988] Trial 1 finished with value: 0.697163462638855 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.697163462638855.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:50:11,628] A new study created in memory with name: no-name-b9542108-6b4e-4301-9295-08d3f6869d3c
[I 2025-03-21 09:50:16,764] Trial 0 finished with value: 0.7963666915893555 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7963666915893555.
[I 2025-03-21 09:50:22,301] Trial 1 finished with value: 0.7317173480987549 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7317173480987549.
{'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7324
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 310(61.14%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7532
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7887
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7895
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8824
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7625
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 209(41.22%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8173
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6972
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7964
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7317
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 362(71.40%) cells.
Inference Done.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:50:25,744] A new study created in memory with name: no-name-6eb093dd-1239-4a55-b2b1-ca4b3e8eee3f
[I 2025-03-21 09:50:29,361] Trial 0 finished with value: 0.770888090133667 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.770888090133667.
[I 2025-03-21 09:50:34,327] Trial 1 finished with value: 0.7678115963935852 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7678115963935852.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:50:37,713] A new study created in memory with name: no-name-065f6a7c-721d-4186-962e-b111340e353a
[I 2025-03-21 09:50:43,574] Trial 0 finished with value: 0.7082716226577759 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7082716226577759.
[I 2025-03-21 09:50:46,900] Trial 1 finished with value: 0.7842233777046204 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7082716226577759.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:50:50,422] A new study created in memory with name: no-name-a359fc39-2137-4663-967f-b22496c67d77
[I 2025-03-21 09:50:54,075] Trial 0 finished with value: 0.8080028891563416 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8080028891563416.
[I 2025-03-21 09:51:00,224] Trial 1 finished with value: 0.8236597776412964 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8080028891563416.
... storing 'Rank_Label' as categorical
2025-03-21 09:51:03,646 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1
Processing datasets for repeat 4: 100%|██████████| 10/10 [2:34:40<00:00, 376.96s/it]Processing datasets for repeat 4: 100%|██████████| 10/10 [2:34:40<00:00, 928.02s/it]
2025-03-21 09:51:03,648 - Repeat 4 completed
2025-03-21 09:51:03,649 - Starting repeat 5
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7709
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7678
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7083
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 14 components.
Reject 229(45.17%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_4/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8080
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 5:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 09:51:03,657 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10
[I 2025-03-21 09:51:29,575] A new study created in memory with name: no-name-052cf56a-eb4c-4896-b098-32c335636c41
[I 2025-03-21 09:51:35,613] Trial 0 finished with value: 0.7917115092277527 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7917115092277527.
[I 2025-03-21 09:51:42,346] Trial 1 finished with value: 0.7920690178871155 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7917115092277527.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:51:44,390] A new study created in memory with name: no-name-dcc44ffc-bbdb-4ba2-aa23-878eb826bd58
[I 2025-03-21 09:51:52,027] Trial 0 finished with value: 0.7839159965515137 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7839159965515137.
[I 2025-03-21 09:51:58,525] Trial 1 finished with value: 0.7809593677520752 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7809593677520752.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:52:00,532] A new study created in memory with name: no-name-667ba44a-f268-4f63-b492-4425aca1d1a7
[I 2025-03-21 09:52:04,975] Trial 0 finished with value: 0.7502155900001526 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7502155900001526.
[I 2025-03-21 09:52:10,446] Trial 1 finished with value: 0.7396596670150757 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7396596670150757.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:52:12,415] A new study created in memory with name: no-name-e53c2e38-fcbf-4a4a-9c47-9dedd2d32099
[I 2025-03-21 09:52:18,000] Trial 0 finished with value: 0.7322432994842529 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7322432994842529.
[I 2025-03-21 09:52:22,355] Trial 1 finished with value: 0.7854757905006409 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7322432994842529.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:52:24,364] A new study created in memory with name: no-name-c4038fe4-a20c-496d-bbc7-ca8fdddb1691
[I 2025-03-21 09:52:29,959] Trial 0 finished with value: 0.7837005257606506 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7837005257606506.
[I 2025-03-21 09:52:33,749] Trial 1 finished with value: 0.7884114980697632 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7837005257606506.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:52:35,732] A new study created in memory with name: no-name-f1b2e980-2740-441c-8839-c52cee587be2
[I 2025-03-21 09:52:42,075] Trial 0 finished with value: 0.7914097905158997 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7914097905158997.
[I 2025-03-21 09:52:46,222] Trial 1 finished with value: 0.7970737218856812 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7914097905158997.
... storing 'Rank_Label' as categorical
2025-03-21 09:52:48,345 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10
Processing datasets for repeat 5:  10%|█         | 1/10 [01:44<15:42, 104.69s/it]2025-03-21 09:52:48,348 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9
[I 2025-03-21 09:53:19,161] A new study created in memory with name: no-name-1acd0194-6629-4d21-8c7d-1186d78d9628
[I 2025-03-21 09:53:24,125] Trial 0 finished with value: 0.6862797737121582 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6862797737121582.
[I 2025-03-21 09:53:28,652] Trial 1 finished with value: 0.7841987609863281 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.6862797737121582.
... storing 'Rank_Label' as categorical
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7917
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 76(17.72%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7839
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7810
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7502
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7397
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 108(25.17%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7322
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7837
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 12(2.80%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7914
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6863
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 11(2.56%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 09:53:30,783] A new study created in memory with name: no-name-395face2-a51c-402a-8825-6aba6aabfcd5
[I 2025-03-21 09:53:36,051] Trial 0 finished with value: 0.7136088013648987 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7136088013648987.
[I 2025-03-21 09:53:43,060] Trial 1 finished with value: 0.8259618878364563 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7136088013648987.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:53:45,042] A new study created in memory with name: no-name-35a0f439-faa1-4ca3-8758-f8d0784be9d3
[I 2025-03-21 09:53:49,339] Trial 0 finished with value: 0.6716472506523132 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6716472506523132.
[I 2025-03-21 09:53:54,109] Trial 1 finished with value: 0.6774174571037292 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6716472506523132.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:53:56,120] A new study created in memory with name: no-name-5423c40e-9d83-4911-9b92-b1c5e1a6a708
[I 2025-03-21 09:54:00,493] Trial 0 finished with value: 0.8201016187667847 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8201016187667847.
[I 2025-03-21 09:54:03,485] Trial 1 finished with value: 0.7090733647346497 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7090733647346497.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:54:05,414] A new study created in memory with name: no-name-69b6f200-d7e0-49cf-8e88-b23561d85d66
[I 2025-03-21 09:54:08,342] Trial 0 finished with value: 0.6948562264442444 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6948562264442444.
[I 2025-03-21 09:54:11,538] Trial 1 finished with value: 0.7082479596138 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6948562264442444.
... storing 'Rank_Label' as categorical
[I 2025-03-21 09:54:13,549] A new study created in memory with name: no-name-44053207-f724-44b2-bcfe-6290cb9fda6a
[I 2025-03-21 09:54:16,357] Trial 0 finished with value: 0.8191706538200378 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8191706538200378.
[I 2025-03-21 09:54:21,051] Trial 1 finished with value: 0.7799105048179626 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7799105048179626.
... storing 'Rank_Label' as categorical
2025-03-21 09:54:22,969 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9
Processing datasets for repeat 5:  20%|██        | 2/10 [03:19<13:10, 98.77s/it] 2025-03-21 09:54:22,973 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8
[I 2025-03-21 10:03:32,662] A new study created in memory with name: no-name-603680c6-bce5-422b-923b-b65ba6507808
[I 2025-03-21 10:09:10,983] Trial 0 finished with value: 0.7480868541676066 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7480868541676066.
[I 2025-03-21 10:13:44,400] Trial 1 finished with value: 0.606509462646816 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 1 with value: 0.606509462646816.
... storing 'Rank_Label' as categorical
[I 2025-03-21 10:15:54,723] A new study created in memory with name: no-name-966bd7f7-364f-4fa8-ba07-2f23adf6983e
[I 2025-03-21 10:21:36,474] Trial 0 finished with value: 0.5573103687037593 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.5573103687037593.
[I 2025-03-21 10:25:17,435] Trial 1 finished with value: 0.5446775607440782 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 1 with value: 0.5446775607440782.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7136
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 154(35.90%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6716
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 13 components.
Reject 56(13.05%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8201
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7091
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6949
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 34(7.93%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8192
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7799
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7481
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6065
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 4(0.02%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5573
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5447
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 7363(31.42%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 10:27:52,460] A new study created in memory with name: no-name-03d863a3-47fa-41f0-90de-b139d684a351
[I 2025-03-21 10:33:00,349] Trial 0 finished with value: 0.5832913569782091 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.5832913569782091.
[I 2025-03-21 10:38:48,444] Trial 1 finished with value: 0.5982322770616283 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.5832913569782091.
... storing 'Rank_Label' as categorical
[I 2025-03-21 10:40:40,383] A new study created in memory with name: no-name-005034cf-480d-4b59-ada7-2341811d6e76
[I 2025-03-21 10:46:20,647] Trial 0 finished with value: 0.7578559569690538 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7578559569690538.
[I 2025-03-21 10:51:28,374] Trial 1 finished with value: 0.7830525558927784 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7578559569690538.
... storing 'Rank_Label' as categorical
[I 2025-03-21 10:53:17,493] A new study created in memory with name: no-name-fc96b6df-6aea-406d-976a-8b465bf6b208
[I 2025-03-21 10:57:34,902] Trial 0 finished with value: 0.7582205197085505 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7582205197085505.
[I 2025-03-21 11:02:03,096] Trial 1 finished with value: 0.7282801892446435 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7282801892446435.
... storing 'Rank_Label' as categorical
[I 2025-03-21 11:03:52,347] A new study created in memory with name: no-name-7088ddb8-ecd6-4a40-8f8c-13c02f2c6d4a
[I 2025-03-21 11:07:53,174] Trial 0 finished with value: 0.8077496601187665 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8077496601187665.
[I 2025-03-21 11:12:23,832] Trial 1 finished with value: 0.8427667047666467 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8077496601187665.
... storing 'Rank_Label' as categorical
2025-03-21 11:14:13,097 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8
Processing datasets for repeat 5:  30%|███       | 3/10 [1:23:09<4:21:26, 2240.94s/it]2025-03-21 11:14:13,100 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7
[I 2025-03-21 11:24:03,222] A new study created in memory with name: no-name-43c4934e-4f69-4e2e-b813-e9db5e5d6786
[I 2025-03-21 11:28:37,032] Trial 0 finished with value: 0.7360163901163184 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7360163901163184.
[I 2025-03-21 11:33:05,424] Trial 1 finished with value: 1.013346210769985 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7360163901163184.
... storing 'Rank_Label' as categorical
[I 2025-03-21 11:35:17,049] A new study created in memory with name: no-name-fb88da7f-5a65-4b31-ac30-c681662762d7
[I 2025-03-21 11:40:01,557] Trial 0 finished with value: 0.7702371374420498 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7702371374420498.
[I 2025-03-21 11:45:40,373] Trial 1 finished with value: 0.7024226214574731 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7024226214574731.
... storing 'Rank_Label' as categorical
[I 2025-03-21 11:48:20,086] A new study created in memory with name: no-name-9061cad2-bbc8-4ca9-8f4d-6dd88381861f
[I 2025-03-21 11:53:32,172] Trial 0 finished with value: 0.8065983886304109 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8065983886304109.
[I 2025-03-21 11:57:34,322] Trial 1 finished with value: 0.5655050485030465 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.5655050485030465.
... storing 'Rank_Label' as categorical
[I 2025-03-21 11:59:23,495] A new study created in memory with name: no-name-64b031ee-9dc5-429b-a459-7d97cf34635f
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5833
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 10777(45.99%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7579
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7582
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7283
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 167(0.71%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8077
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7360
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 5233(22.33%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7702
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7024
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 10 components.
Reject 22804(97.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8066
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5655
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
[I 2025-03-21 12:03:25,946] Trial 0 finished with value: 0.7279033868209176 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7279033868209176.
[I 2025-03-21 12:08:36,605] Trial 1 finished with value: 0.8357407632081405 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7279033868209176.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:10:25,876] A new study created in memory with name: no-name-7eaefab9-0c1f-4acf-84a6-5693631fd4cb
[I 2025-03-21 12:13:39,928] Trial 0 finished with value: 0.79932861742766 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.79932861742766.
[I 2025-03-21 12:17:00,746] Trial 1 finished with value: 0.7466551506001017 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7466551506001017.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:18:51,070] A new study created in memory with name: no-name-df4c7f11-2ffc-4739-be52-55cbc8962244
[I 2025-03-21 12:23:20,161] Trial 0 finished with value: 0.7474613267442455 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7474613267442455.
[I 2025-03-21 12:28:02,956] Trial 1 finished with value: 0.776280068832895 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7474613267442455.
... storing 'Rank_Label' as categorical
2025-03-21 12:29:50,178 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7
Processing datasets for repeat 5:  40%|████      | 4/10 [2:38:46<5:14:44, 3147.43s/it]2025-03-21 12:29:50,188 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6
[I 2025-03-21 12:30:11,606] A new study created in memory with name: no-name-b1387a29-8090-4b63-8297-dd8965628ed5
[I 2025-03-21 12:30:23,496] Trial 0 finished with value: 0.580772340297699 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.580772340297699.
[I 2025-03-21 12:30:40,296] Trial 1 finished with value: 0.6974723935127258 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.580772340297699.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:30:43,285] A new study created in memory with name: no-name-7bf912df-7c94-43bd-a69e-9f5c48c313c8
[I 2025-03-21 12:30:55,488] Trial 0 finished with value: 0.8055522441864014 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8055522441864014.
[I 2025-03-21 12:31:16,726] Trial 1 finished with value: 0.6901399195194244 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.6901399195194244.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:31:19,644] A new study created in memory with name: no-name-145a95d7-1fc5-4038-9dbc-1edeeaf16356
[I 2025-03-21 12:31:32,018] Trial 0 finished with value: 0.6203708946704865 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6203708946704865.
[I 2025-03-21 12:31:43,623] Trial 1 finished with value: 0.6190474927425385 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6190474927425385.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:31:46,564] A new study created in memory with name: no-name-92ac45d7-db6d-4c0f-a9ce-053cd89e85cc
[I 2025-03-21 12:31:55,358] Trial 0 finished with value: 0.8013133406639099 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8013133406639099.
[I 2025-03-21 12:32:07,565] Trial 1 finished with value: 0.7825801968574524 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7825801968574524.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:32:10,471] A new study created in memory with name: no-name-c2e35b32-5639-41cc-af93-21a6d83c03e6
[I 2025-03-21 12:32:22,093] Trial 0 finished with value: 0.6111604273319244 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6111604273319244.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7279
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7993
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7467
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 640(2.73%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7475
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5808
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 208(12.97%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8056
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6901
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6204
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6190
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 4 components.
Reject 166(10.35%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8013
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7826
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6112
[I 2025-03-21 12:32:33,760] Trial 1 finished with value: 0.6178295910358429 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6111604273319244.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:32:37,975] A new study created in memory with name: no-name-3f768500-cb21-4350-bf13-ace010e1942b
[I 2025-03-21 12:32:51,701] Trial 0 finished with value: 0.7919948101043701 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7919948101043701.
[I 2025-03-21 12:33:05,294] Trial 1 finished with value: 0.8271573781967163 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7919948101043701.
... storing 'Rank_Label' as categorical
2025-03-21 12:33:08,200 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6
Processing datasets for repeat 5:  50%|█████     | 5/10 [2:42:04<2:53:39, 2083.85s/it]2025-03-21 12:33:08,205 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5
[I 2025-03-21 12:33:41,167] A new study created in memory with name: no-name-4217a938-2556-4b48-863c-71a36ff67402
[I 2025-03-21 12:33:53,059] Trial 0 finished with value: 0.743558794260025 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.743558794260025.
[I 2025-03-21 12:34:07,742] Trial 1 finished with value: 0.775215357542038 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.743558794260025.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:34:10,705] A new study created in memory with name: no-name-e8529d03-9acd-479f-8895-38971c0154c6
[I 2025-03-21 12:34:25,740] Trial 0 finished with value: 0.7139746844768524 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7139746844768524.
[I 2025-03-21 12:34:37,192] Trial 1 finished with value: 0.7566130459308624 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7139746844768524.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:34:40,134] A new study created in memory with name: no-name-6b4fcc50-8600-4889-a5dc-e0f685e1c166
[I 2025-03-21 12:34:54,886] Trial 0 finished with value: 0.7058599889278412 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7058599889278412.
[I 2025-03-21 12:35:04,593] Trial 1 finished with value: 0.7309151887893677 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7058599889278412.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:35:07,701] A new study created in memory with name: no-name-5b84eeab-92b7-4bf4-93c3-26771eb6ed85
[I 2025-03-21 12:35:19,224] Trial 0 finished with value: 0.7578090727329254 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7578090727329254.
[I 2025-03-21 12:35:27,476] Trial 1 finished with value: 0.8420900404453278 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7578090727329254.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:35:30,373] A new study created in memory with name: no-name-7fe8b655-59ae-4ed3-a7f1-96f82b64ab3a
[I 2025-03-21 12:35:42,168] Trial 0 finished with value: 0.7447296679019928 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7447296679019928.
[I 2025-03-21 12:35:55,914] Trial 1 finished with value: 0.7391872107982635 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7391872107982635.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:35:58,861] A new study created in memory with name: no-name-3bb932e4-3ab3-4d3f-83ad-56bc84b4eca1
[I 2025-03-21 12:36:08,824] Trial 0 finished with value: 0.8558080494403839 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8558080494403839.
[I 2025-03-21 12:36:18,502] Trial 1 finished with value: 0.7828806042671204 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7828806042671204.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 199(12.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7920
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7436
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7140
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7059
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 606(37.78%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7578
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7447
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7392
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 104(6.48%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8558
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7829
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
... storing 'Rank_Label' as categorical
2025-03-21 12:36:21,387 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data5
Processing datasets for repeat 5:  60%|██████    | 6/10 [2:45:17<1:36:04, 1441.02s/it]2025-03-21 12:36:21,391 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4
[I 2025-03-21 12:37:01,183] A new study created in memory with name: no-name-9c889355-a6ac-4d0a-ab4e-07af9ae9f676
[I 2025-03-21 12:37:04,749] Trial 0 finished with value: 0.63264000415802 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.63264000415802.
[I 2025-03-21 12:37:07,902] Trial 1 finished with value: 0.8224449157714844 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.63264000415802.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:37:10,753] A new study created in memory with name: no-name-006ca4be-8768-4946-a191-73e440e3e16f
[I 2025-03-21 12:37:17,274] Trial 0 finished with value: 0.6867292523384094 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6867292523384094.
[I 2025-03-21 12:37:23,582] Trial 1 finished with value: 0.6754894852638245 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 1 with value: 0.6754894852638245.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:37:26,380] A new study created in memory with name: no-name-36a93edd-da45-46c3-af78-e48ccefeead3
[I 2025-03-21 12:37:30,968] Trial 0 finished with value: 0.6274969577789307 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6274969577789307.
[I 2025-03-21 12:37:33,602] Trial 1 finished with value: 0.7514238357543945 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6274969577789307.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:37:36,426] A new study created in memory with name: no-name-8be052fb-18e6-4a7b-8ed3-aa414a5d0e25
[I 2025-03-21 12:37:40,739] Trial 0 finished with value: 0.7432534098625183 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.7432534098625183.
[I 2025-03-21 12:37:45,441] Trial 1 finished with value: 0.7840923070907593 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7432534098625183.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:37:48,200] A new study created in memory with name: no-name-57cf832f-54c0-4481-b8cc-2a894b13c2ef
[I 2025-03-21 12:37:51,970] Trial 0 finished with value: 0.6668166518211365 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6668166518211365.
[I 2025-03-21 12:37:56,592] Trial 1 finished with value: 0.7169069051742554 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6668166518211365.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:37:59,357] A new study created in memory with name: no-name-7dcf045b-d96b-4ca1-878a-125941580c95
[I 2025-03-21 12:38:02,909] Trial 0 finished with value: 0.7879786491394043 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7879786491394043.
[I 2025-03-21 12:38:06,715] Trial 1 finished with value: 0.7922462821006775 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7879786491394043.
... storing 'Rank_Label' as categorical
2025-03-21 12:38:09,467 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4
Processing datasets for repeat 5:  70%|███████   | 7/10 [2:47:05<50:15, 1005.25s/it]  2025-03-21 12:38:09,469 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3
[I 2025-03-21 12:38:47,450] A new study created in memory with name: no-name-7afa8e03-2e15-47d5-aba5-5d58fdc1e284
[I 2025-03-21 12:38:51,481] Trial 0 finished with value: 0.7285168766975403 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7285168766975403.
[I 2025-03-21 12:38:54,707] Trial 1 finished with value: 0.794800877571106 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7285168766975403.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6326
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 274(84.57%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6867
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6755
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 183(56.48%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6275
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 260(80.25%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7433
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6668
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 117(36.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7880
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7285
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:38:57,532] A new study created in memory with name: no-name-d44bfc85-7225-41d6-8144-51a63b8eaa06
[I 2025-03-21 12:39:03,186] Trial 0 finished with value: 0.7001229524612427 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7001229524612427.
[I 2025-03-21 12:39:11,383] Trial 1 finished with value: 0.8098703622817993 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7001229524612427.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:39:14,160] A new study created in memory with name: no-name-e370b4ee-3a76-41d4-8930-e6349f39499b
[I 2025-03-21 12:39:19,069] Trial 0 finished with value: 0.6712424755096436 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.6712424755096436.
[I 2025-03-21 12:39:21,900] Trial 1 finished with value: 0.7220304608345032 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6712424755096436.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:39:24,709] A new study created in memory with name: no-name-6d24cd56-1f7a-4ee1-982e-78894437cbd7
[I 2025-03-21 12:39:27,772] Trial 0 finished with value: 0.6626078486442566 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6626078486442566.
[I 2025-03-21 12:39:31,915] Trial 1 finished with value: 0.7948057651519775 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6626078486442566.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:39:34,675] A new study created in memory with name: no-name-a88b6bde-b20b-40c3-bab4-2700e3d461c4
[I 2025-03-21 12:39:38,055] Trial 0 finished with value: 0.7006098031997681 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7006098031997681.
[I 2025-03-21 12:39:42,399] Trial 1 finished with value: 0.7153913378715515 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7006098031997681.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:39:45,167] A new study created in memory with name: no-name-66311c1e-ce14-4afe-a9b2-11ed72c4ac4a
[I 2025-03-21 12:39:47,991] Trial 0 finished with value: 0.7904464602470398 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7904464602470398.
[I 2025-03-21 12:39:51,519] Trial 1 finished with value: 0.7907508611679077 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7904464602470398.
... storing 'Rank_Label' as categorical
2025-03-21 12:39:54,317 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3
Processing datasets for repeat 5:  80%|████████  | 8/10 [2:48:50<23:57, 718.61s/it] 2025-03-21 12:39:54,319 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2
[I 2025-03-21 12:40:20,515] A new study created in memory with name: no-name-6737fe3d-1a7c-49fb-98ee-530f7e0acd7e
[I 2025-03-21 12:40:26,646] Trial 0 finished with value: 0.758521318435669 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.758521318435669.
[I 2025-03-21 12:40:33,194] Trial 1 finished with value: 0.782336413860321 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.758521318435669.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:40:36,839] A new study created in memory with name: no-name-3d682c8b-40f3-4859-a36c-2164b3925a3a
[I 2025-03-21 12:40:43,604] Trial 0 finished with value: 0.8026682734489441 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8026682734489441.
[I 2025-03-21 12:40:49,145] Trial 1 finished with value: 0.7815918922424316 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7815918922424316.
... storing 'Rank_Label' as categorical
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7001
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6712
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 246(75.93%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.6626
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 142(43.83%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7006
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2(0.62%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7904
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7585
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8027
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7816
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 12:40:52,549] A new study created in memory with name: no-name-70f9ebb8-3662-46e6-b57a-aa519bfa3e46
[I 2025-03-21 12:40:56,957] Trial 0 finished with value: 0.7667608261108398 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7667608261108398.
[I 2025-03-21 12:41:00,970] Trial 1 finished with value: 0.798998236656189 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7667608261108398.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:41:04,400] A new study created in memory with name: no-name-f22e92d7-e3d4-49e5-bc72-10235546403a
[I 2025-03-21 12:41:08,949] Trial 0 finished with value: 0.790607750415802 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.790607750415802.
[I 2025-03-21 12:41:15,326] Trial 1 finished with value: 0.7342115044593811 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7342115044593811.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:41:18,709] A new study created in memory with name: no-name-d2231c1c-0256-4f28-866d-19d928213a2b
[I 2025-03-21 12:41:23,040] Trial 0 finished with value: 0.7837631702423096 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7837631702423096.
[I 2025-03-21 12:41:29,361] Trial 1 finished with value: 0.7977631092071533 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7837631702423096.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:41:32,744] A new study created in memory with name: no-name-10a7c679-4778-4fe3-89af-4316b5cec518
[I 2025-03-21 12:41:37,879] Trial 0 finished with value: 0.792256236076355 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.792256236076355.
[I 2025-03-21 12:41:43,723] Trial 1 finished with value: 0.7900593280792236 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7900593280792236.
... storing 'Rank_Label' as categorical
2025-03-21 12:41:47,116 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2
Processing datasets for repeat 5:  90%|█████████ | 9/10 [2:50:43<08:49, 529.22s/it]2025-03-21 12:41:47,118 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1
[I 2025-03-21 12:42:20,645] A new study created in memory with name: no-name-673c137d-b086-40bf-8ee6-5bd9c38ee7e7
[I 2025-03-21 12:42:25,897] Trial 0 finished with value: 0.7126334309577942 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7126334309577942.
[I 2025-03-21 12:42:31,724] Trial 1 finished with value: 0.7929152846336365 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7126334309577942.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:42:35,142] A new study created in memory with name: no-name-87c9cdc1-e00a-48c8-b326-d102fb4ddc5e
[I 2025-03-21 12:42:40,370] Trial 0 finished with value: 0.836835503578186 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.836835503578186.
[I 2025-03-21 12:42:45,444] Trial 1 finished with value: 0.7389365434646606 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7389365434646606.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:42:48,825] A new study created in memory with name: no-name-8f6fa40c-e3aa-4967-bc0a-d72c44f47a8b
[I 2025-03-21 12:42:52,939] Trial 0 finished with value: 0.7150675058364868 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7150675058364868.
[I 2025-03-21 12:42:56,176] Trial 1 finished with value: 0.8052822351455688 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7150675058364868.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:42:59,560] A new study created in memory with name: no-name-94a0adbc-9041-458e-ad5e-49129dbc40b8
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7668
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 212(41.81%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7906
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7342
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7838
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7923
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7901
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7126
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8368
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7389
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7151
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 358(70.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
[I 2025-03-21 12:43:02,820] Trial 0 finished with value: 0.7679298520088196 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7679298520088196.
[I 2025-03-21 12:43:06,695] Trial 1 finished with value: 0.8585676550865173 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7679298520088196.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:43:10,065] A new study created in memory with name: no-name-4d0c94e4-3b8e-44be-976e-fbc5d4776bf8
[I 2025-03-21 12:43:15,266] Trial 0 finished with value: 0.8151407241821289 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8151407241821289.
[I 2025-03-21 12:43:18,810] Trial 1 finished with value: 0.7136729955673218 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7136729955673218.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:43:22,224] A new study created in memory with name: no-name-178ae339-4f4f-4ae8-b278-272451a46339
[I 2025-03-21 12:43:25,113] Trial 0 finished with value: 0.7500351667404175 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7500351667404175.
[I 2025-03-21 12:43:29,083] Trial 1 finished with value: 0.7981133460998535 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7500351667404175.
... storing 'Rank_Label' as categorical
2025-03-21 12:43:32,448 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1
Processing datasets for repeat 5: 100%|██████████| 10/10 [2:52:28<00:00, 398.36s/it]Processing datasets for repeat 5: 100%|██████████| 10/10 [2:52:28<00:00, 1034.88s/it]
2025-03-21 12:43:32,455 - Repeat 5 completed
2025-03-21 12:43:32,483 - Starting repeat 6
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7679
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8151
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7137
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 187(36.88%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_5/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7500
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 6:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 12:43:32,485 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10
[I 2025-03-21 12:43:55,697] A new study created in memory with name: no-name-fac96d9b-0311-4791-b26d-6e8182143e50
[I 2025-03-21 12:44:02,511] Trial 0 finished with value: 0.7235375046730042 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7235375046730042.
[I 2025-03-21 12:44:08,084] Trial 1 finished with value: 0.7486525774002075 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7235375046730042.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:44:10,102] A new study created in memory with name: no-name-78fc9a3a-5dfa-440e-8e2f-f6a507ee6532
[I 2025-03-21 12:44:17,149] Trial 0 finished with value: 0.7967090010643005 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7967090010643005.
[I 2025-03-21 12:44:23,610] Trial 1 finished with value: 0.7927408218383789 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7927408218383789.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:44:25,569] A new study created in memory with name: no-name-095bb46a-3bc5-47e5-9888-c1d8edc75488
[I 2025-03-21 12:44:30,704] Trial 0 finished with value: 0.7056809663772583 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7056809663772583.
[I 2025-03-21 12:44:35,925] Trial 1 finished with value: 0.7900540828704834 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7056809663772583.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:44:37,878] A new study created in memory with name: no-name-28c5d16e-d7bb-4532-81fd-0fdb7f560634
[I 2025-03-21 12:44:42,572] Trial 0 finished with value: 0.7890438437461853 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7890438437461853.
[I 2025-03-21 12:44:46,381] Trial 1 finished with value: 0.7437960505485535 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7437960505485535.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:44:48,347] A new study created in memory with name: no-name-26912cc3-590f-425e-b333-acd87ff0fc11
[I 2025-03-21 12:44:54,406] Trial 0 finished with value: 0.8080325126647949 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8080325126647949.
[I 2025-03-21 12:44:58,747] Trial 1 finished with value: 0.7737826108932495 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7737826108932495.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:45:00,711] A new study created in memory with name: no-name-c9899144-8dd7-4ec4-ac22-2ac83a566f3c
[I 2025-03-21 12:45:04,683] Trial 0 finished with value: 0.7881104946136475 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7881104946136475.
[I 2025-03-21 12:45:08,120] Trial 1 finished with value: 0.7920142412185669 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7881104946136475.
... storing 'Rank_Label' as categorical
2025-03-21 12:45:10,059 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10
Processing datasets for repeat 6:  10%|█         | 1/10 [01:37<14:38, 97.58s/it]2025-03-21 12:45:10,061 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9
[I 2025-03-21 12:45:41,001] A new study created in memory with name: no-name-56232782-604d-4a44-9bdd-766719a1075e
[I 2025-03-21 12:45:46,334] Trial 0 finished with value: 0.8279942274093628 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8279942274093628.
[I 2025-03-21 12:45:50,478] Trial 1 finished with value: 0.7680308222770691 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7680308222770691.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7235
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 254(59.21%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7967
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7927
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7057
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 230(53.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7890
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7438
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8080
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7738
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 137(31.93%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7881
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8280
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7680
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:45:52,470] A new study created in memory with name: no-name-c35cc4b1-5828-402a-85de-96782470c4a0
[I 2025-03-21 12:45:56,881] Trial 0 finished with value: 0.764610767364502 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.764610767364502.
[I 2025-03-21 12:46:04,662] Trial 1 finished with value: 0.7382038831710815 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7382038831710815.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:46:06,664] A new study created in memory with name: no-name-ac0c2681-86bf-497e-9d72-2bce43fe17e1
[I 2025-03-21 12:46:09,982] Trial 0 finished with value: 0.708824098110199 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.708824098110199.
[I 2025-03-21 12:46:13,426] Trial 1 finished with value: 0.7827810645103455 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.708824098110199.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:46:15,404] A new study created in memory with name: no-name-9151b058-f2ca-4e6e-89d3-3b0db9017707
[I 2025-03-21 12:46:19,373] Trial 0 finished with value: 0.740519106388092 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.740519106388092.
[I 2025-03-21 12:46:24,519] Trial 1 finished with value: 0.745012640953064 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.740519106388092.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:46:26,480] A new study created in memory with name: no-name-7f6b806b-a22b-4004-949e-014f914618bd
[I 2025-03-21 12:46:29,852] Trial 0 finished with value: 0.7407618165016174 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7407618165016174.
[I 2025-03-21 12:46:32,981] Trial 1 finished with value: 0.797786295413971 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7407618165016174.
... storing 'Rank_Label' as categorical
[I 2025-03-21 12:46:34,959] A new study created in memory with name: no-name-d2adb2b0-d4c0-40cf-b352-c5c790f9fca4
[I 2025-03-21 12:46:38,277] Trial 0 finished with value: 0.7371442317962646 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7371442317962646.
[I 2025-03-21 12:46:41,407] Trial 1 finished with value: 0.8246912360191345 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7371442317962646.
... storing 'Rank_Label' as categorical
2025-03-21 12:46:43,324 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9
Processing datasets for repeat 6:  20%|██        | 2/10 [03:10<12:40, 95.04s/it]2025-03-21 12:46:43,326 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8
[I 2025-03-21 12:56:08,417] A new study created in memory with name: no-name-11fe1306-3d9b-41da-b64e-222a41107605
[I 2025-03-21 12:59:29,001] Trial 0 finished with value: 0.5894740197969519 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.5894740197969519.
[I 2025-03-21 13:02:45,603] Trial 1 finished with value: 0.5722836748413418 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 1 with value: 0.5722836748413418.
... storing 'Rank_Label' as categorical
[I 2025-03-21 13:06:02,904] A new study created in memory with name: no-name-d0d38e2e-34ff-42e4-965b-98887f2ae5fc
[I 2025-03-21 13:10:18,687] Trial 0 finished with value: 0.5896988951641581 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.5896988951641581.
[I 2025-03-21 13:13:30,270] Trial 1 finished with value: 0.6336288426233374 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.5896988951641581.
... storing 'Rank_Label' as categorical
Reject 132(30.77%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7646
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7382
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 11(2.56%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7088
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 268(62.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7405
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7408
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 5 components.
Reject 67(15.62%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7371
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5895
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5723
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 14760(62.99%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5897
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 55(0.23%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 13:15:32,660] A new study created in memory with name: no-name-0f5ff34d-1b7a-4d4a-b8d1-7ee927e8e5cc
[I 2025-03-21 13:20:30,266] Trial 0 finished with value: 0.6164627982222516 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6164627982222516.
[I 2025-03-21 13:23:56,371] Trial 1 finished with value: 0.5733673442964968 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 1 with value: 0.5733673442964968.
... storing 'Rank_Label' as categorical
[I 2025-03-21 13:25:45,862] A new study created in memory with name: no-name-23b4e416-a743-4b5d-9f9f-f47bf19fc0af
[I 2025-03-21 13:29:45,776] Trial 0 finished with value: 0.8146295806635981 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8146295806635981.
[I 2025-03-21 13:34:20,464] Trial 1 finished with value: 0.8040005746095077 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 1 with value: 0.8040005746095077.
... storing 'Rank_Label' as categorical
[I 2025-03-21 13:36:09,381] A new study created in memory with name: no-name-7bbbd7a4-b42f-48e5-8312-39553a482781
[I 2025-03-21 13:39:39,113] Trial 0 finished with value: 0.7105248000310815 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7105248000310815.
[I 2025-03-21 13:44:13,253] Trial 1 finished with value: 0.6988503414651622 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.6988503414651622.
... storing 'Rank_Label' as categorical
[I 2025-03-21 13:46:02,300] A new study created in memory with name: no-name-67a271d4-8831-44b1-b0f8-c89a55fe31f0
[I 2025-03-21 13:49:01,864] Trial 0 finished with value: 0.8051762554956519 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8051762554956519.
[I 2025-03-21 13:52:36,054] Trial 1 finished with value: 0.8019169776336007 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.8019169776336007.
... storing 'Rank_Label' as categorical
2025-03-21 13:54:24,705 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8
Processing datasets for repeat 6:  30%|███       | 3/10 [1:10:52<3:42:23, 1906.15s/it]2025-03-21 13:54:24,714 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7
[I 2025-03-21 14:03:35,455] A new study created in memory with name: no-name-eb0afd9c-1241-41b4-a843-7d88464f661b
[I 2025-03-21 14:07:29,144] Trial 0 finished with value: 0.6857569217681885 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6857569217681885.
[I 2025-03-21 14:11:22,236] Trial 1 finished with value: 0.4948778528234233 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.4948778528234233.
... storing 'Rank_Label' as categorical
[I 2025-03-21 14:13:12,977] A new study created in memory with name: no-name-0cd28b23-40e7-42f3-ad32-c2bdc39fb8f2
[I 2025-03-21 14:17:58,529] Trial 0 finished with value: 0.7957582447839819 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7957582447839819.
[I 2025-03-21 14:21:38,736] Trial 1 finished with value: 0.8363690505857053 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7957582447839819.
... storing 'Rank_Label' as categorical
[I 2025-03-21 14:24:17,034] A new study created in memory with name: no-name-77ffbab4-7eac-46a5-89cf-b9e21ca03394
[I 2025-03-21 14:27:55,052] Trial 0 finished with value: 0.6837982457617054 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6837982457617054.
[I 2025-03-21 14:32:06,480] Trial 1 finished with value: 0.637182380842126 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 1 with value: 0.637182380842126.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6165
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5734
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 5648(24.10%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8146
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.8040
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7105
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6989
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 625(2.67%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8052
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8019
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6858
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.4949
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7958
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 2(0.01%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6838
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6372
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 10589(45.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 14:34:12,058] A new study created in memory with name: no-name-b5449b4e-90e3-4a72-8a37-24b73ba4923a
[I 2025-03-21 14:37:13,598] Trial 0 finished with value: 0.7831402058186738 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7831402058186738.
[I 2025-03-21 14:41:22,299] Trial 1 finished with value: 0.7747244886730028 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7747244886730028.
... storing 'Rank_Label' as categorical
[I 2025-03-21 14:43:11,219] A new study created in memory with name: no-name-dfbdb2e0-430e-4224-bba4-5e65355d0248
[I 2025-03-21 14:46:17,126] Trial 0 finished with value: 0.7441209606502367 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7441209606502367.
[I 2025-03-21 14:50:18,978] Trial 1 finished with value: 0.7469852825869685 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7441209606502367.
... storing 'Rank_Label' as categorical
[I 2025-03-21 14:52:09,560] A new study created in memory with name: no-name-b13129f7-e5f1-4ab5-9696-cbe58ec88efc
[I 2025-03-21 14:56:13,607] Trial 0 finished with value: 0.8081638813018799 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.8081638813018799.
[I 2025-03-21 15:00:46,235] Trial 1 finished with value: 0.7726748482040737 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 1 with value: 0.7726748482040737.
... storing 'Rank_Label' as categorical
2025-03-21 15:02:34,845 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7
Processing datasets for repeat 6:  40%|████      | 4/10 [2:19:02<4:36:50, 2768.38s/it]2025-03-21 15:02:34,869 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6
[I 2025-03-21 15:02:55,789] A new study created in memory with name: no-name-ed83cc79-2692-4611-847a-76cb63326d87
[I 2025-03-21 15:03:08,599] Trial 0 finished with value: 0.5699955523014069 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.5699955523014069.
[I 2025-03-21 15:03:22,996] Trial 1 finished with value: 0.6857112646102905 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.5699955523014069.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:03:26,444] A new study created in memory with name: no-name-7400b6ad-5c45-498b-87d3-b10f08fd9be6
[I 2025-03-21 15:03:37,389] Trial 0 finished with value: 0.5632164776325226 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.5632164776325226.
[I 2025-03-21 15:03:48,899] Trial 1 finished with value: 0.6221538782119751 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.5632164776325226.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:03:52,019] A new study created in memory with name: no-name-ac32839c-e95e-44d8-923d-1a197e876986
[I 2025-03-21 15:03:59,695] Trial 0 finished with value: 0.664131373167038 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.664131373167038.
[I 2025-03-21 15:04:10,727] Trial 1 finished with value: 0.6472439765930176 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6472439765930176.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:04:13,725] A new study created in memory with name: no-name-9c3c4fbb-8c0b-4d9a-9381-bed9565f404a
[I 2025-03-21 15:04:22,196] Trial 0 finished with value: 0.791622132062912 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.791622132062912.
[I 2025-03-21 15:04:33,841] Trial 1 finished with value: 0.7436085939407349 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7436085939407349.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7831
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7747
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7441
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 708(3.02%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8082
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7727
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5700
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 9 components.
Reject 646(40.27%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5632
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 495(30.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6641
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6472
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 126(7.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7916
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7436
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 15:04:36,687] A new study created in memory with name: no-name-618628ab-6eca-4712-9b64-9f26f3f4485e
[I 2025-03-21 15:04:46,303] Trial 0 finished with value: 0.633039653301239 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.633039653301239.
[I 2025-03-21 15:04:53,539] Trial 1 finished with value: 0.7587624490261078 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.633039653301239.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:04:57,200] A new study created in memory with name: no-name-12a23569-975b-4880-822c-36e82a5ddb2f
[I 2025-03-21 15:05:06,989] Trial 0 finished with value: 0.8482707440853119 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.8482707440853119.
[I 2025-03-21 15:05:15,082] Trial 1 finished with value: 0.8208221793174744 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.8208221793174744.
... storing 'Rank_Label' as categorical
2025-03-21 15:05:17,914 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6
Processing datasets for repeat 6:  50%|█████     | 5/10 [2:21:45<2:32:24, 1828.88s/it]2025-03-21 15:05:17,916 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5
[I 2025-03-21 15:05:50,553] A new study created in memory with name: no-name-afc92359-abc3-4985-a0bc-212a6591feb2
[I 2025-03-21 15:06:00,455] Trial 0 finished with value: 0.7067599892616272 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7067599892616272.
[I 2025-03-21 15:06:14,576] Trial 1 finished with value: 0.5695740282535553 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 1 with value: 0.5695740282535553.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:06:17,521] A new study created in memory with name: no-name-044ad9bf-a89a-4493-bb0b-94008dba6d01
[I 2025-03-21 15:06:28,912] Trial 0 finished with value: 0.7931148409843445 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7931148409843445.
[I 2025-03-21 15:06:38,910] Trial 1 finished with value: 0.6940532326698303 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 1 with value: 0.6940532326698303.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:06:41,773] A new study created in memory with name: no-name-c7653d90-a9c2-4b60-86b2-691ce8d96cb6
[I 2025-03-21 15:06:50,294] Trial 0 finished with value: 0.8742500245571136 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8742500245571136.
[I 2025-03-21 15:06:57,384] Trial 1 finished with value: 0.835627019405365 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.835627019405365.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:07:00,228] A new study created in memory with name: no-name-434fbcbf-3a6f-425c-97cf-68b336d91c6a
[I 2025-03-21 15:07:08,953] Trial 0 finished with value: 0.7449129819869995 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7449129819869995.
[I 2025-03-21 15:07:20,668] Trial 1 finished with value: 0.803433358669281 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7449129819869995.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:07:23,698] A new study created in memory with name: no-name-f29a78de-5cf1-4c6d-9f18-87e74ce4a9bc
[I 2025-03-21 15:07:31,638] Trial 0 finished with value: 0.877986341714859 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.877986341714859.
[I 2025-03-21 15:07:41,007] Trial 1 finished with value: 0.7454229593276978 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7454229593276978.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6330
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 12 components.
Reject 104(6.48%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8483
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8208
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7068
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5696
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.06%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7931
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6941
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.06%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8743
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.8356
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7449
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8780
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7454
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 13 components.
Reject 90(5.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 15:07:44,836] A new study created in memory with name: no-name-e15373a5-d097-42fb-ad12-cbb95de171fe
[I 2025-03-21 15:07:54,213] Trial 0 finished with value: 0.8680004477500916 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8680004477500916.
[I 2025-03-21 15:08:01,062] Trial 1 finished with value: 0.8355288505554199 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.8355288505554199.
... storing 'Rank_Label' as categorical
2025-03-21 15:08:03,910 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5
Processing datasets for repeat 6:  60%|██████    | 6/10 [2:24:31<1:24:13, 1263.50s/it]2025-03-21 15:08:03,912 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4
[I 2025-03-21 15:08:44,714] A new study created in memory with name: no-name-b0257fcb-081c-4d6d-981a-81744344b7c3
[I 2025-03-21 15:08:48,367] Trial 0 finished with value: 0.6929399371147156 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6929399371147156.
[I 2025-03-21 15:08:51,319] Trial 1 finished with value: 0.6871496438980103 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6871496438980103.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:08:54,141] A new study created in memory with name: no-name-549d3f42-6025-4687-919c-80d853e8e1f4
[I 2025-03-21 15:09:01,726] Trial 0 finished with value: 0.7492256164550781 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7492256164550781.
[I 2025-03-21 15:09:07,322] Trial 1 finished with value: 0.7224000096321106 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7224000096321106.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:09:10,140] A new study created in memory with name: no-name-e931d4e3-a11b-4802-901c-3099be7a09b5
[I 2025-03-21 15:09:14,380] Trial 0 finished with value: 0.7655348777770996 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7655348777770996.
[I 2025-03-21 15:09:17,523] Trial 1 finished with value: 0.739130437374115 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 1 with value: 0.739130437374115.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:09:20,283] A new study created in memory with name: no-name-4ccba534-b465-4c31-9012-f4892e041c74
[I 2025-03-21 15:09:22,553] Trial 0 finished with value: 0.8324218392372131 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8324218392372131.
[I 2025-03-21 15:09:25,358] Trial 1 finished with value: 0.751611053943634 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.751611053943634.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:09:28,118] A new study created in memory with name: no-name-ce8cbb09-08ad-4e0d-a0f9-836e3f3355ec
[I 2025-03-21 15:09:31,049] Trial 0 finished with value: 0.6629037857055664 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6629037857055664.
[I 2025-03-21 15:09:34,280] Trial 1 finished with value: 0.7001014351844788 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6629037857055664.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:09:37,058] A new study created in memory with name: no-name-e93b9cdc-03f1-45cd-9018-c9770743becb
[I 2025-03-21 15:09:41,922] Trial 0 finished with value: 0.7674663662910461 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7674663662910461.
[I 2025-03-21 15:09:45,104] Trial 1 finished with value: 0.7889724969863892 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7674663662910461.
... storing 'Rank_Label' as categorical
2025-03-21 15:09:47,870 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4
Processing datasets for repeat 6:  70%|███████   | 7/10 [2:26:15<44:13, 884.42s/it]   2025-03-21 15:09:47,872 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8680
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8355
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6929
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6871
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 51(15.74%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7492
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7224
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 74(22.84%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7655
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7391
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 46(14.20%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8324
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7516
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6629
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 94(29.01%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7675
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
[I 2025-03-21 15:10:25,453] A new study created in memory with name: no-name-44be6f06-0603-4612-9fc1-f24bfd4ca0aa
[I 2025-03-21 15:10:30,040] Trial 0 finished with value: 0.6977720260620117 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6977720260620117.
[I 2025-03-21 15:10:32,807] Trial 1 finished with value: 0.8188872933387756 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6977720260620117.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:10:35,624] A new study created in memory with name: no-name-ba3fc389-e53f-481b-b3a2-d18c343ed553
[I 2025-03-21 15:10:42,324] Trial 0 finished with value: 0.6622663736343384 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6622663736343384.
[I 2025-03-21 15:10:51,403] Trial 1 finished with value: 0.740135908126831 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6622663736343384.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:10:54,174] A new study created in memory with name: no-name-f839bd08-61d3-4e83-b3a3-86280ae677c5
[I 2025-03-21 15:10:58,962] Trial 0 finished with value: 0.705150842666626 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.705150842666626.
[I 2025-03-21 15:11:03,683] Trial 1 finished with value: 0.7133134603500366 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.705150842666626.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:11:06,457] A new study created in memory with name: no-name-f75128e1-5099-4456-92e5-81d3b3f11de3
[I 2025-03-21 15:11:09,197] Trial 0 finished with value: 0.7521108388900757 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7521108388900757.
[I 2025-03-21 15:11:12,785] Trial 1 finished with value: 0.702347993850708 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.702347993850708.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:11:15,725] A new study created in memory with name: no-name-fa4da0e1-c815-4a08-99f6-5b4dd66d1646
[I 2025-03-21 15:11:19,524] Trial 0 finished with value: 0.7218921780586243 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7218921780586243.
[I 2025-03-21 15:11:23,440] Trial 1 finished with value: 0.7953354120254517 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7218921780586243.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:11:26,235] A new study created in memory with name: no-name-6c7ef191-138b-4435-b854-e3ce02ea26f1
[I 2025-03-21 15:11:29,247] Trial 0 finished with value: 0.8132887482643127 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8132887482643127.
[I 2025-03-21 15:11:34,041] Trial 1 finished with value: 0.8073626756668091 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.8073626756668091.
... storing 'Rank_Label' as categorical
2025-03-21 15:11:36,813 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3
Processing datasets for repeat 6:  80%|████████  | 8/10 [2:28:04<21:15, 637.54s/it]2025-03-21 15:11:36,815 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2
[I 2025-03-21 15:12:04,147] A new study created in memory with name: no-name-2d654f96-c22c-4d6a-85cf-1c302141d779
[I 2025-03-21 15:12:09,465] Trial 0 finished with value: 0.7284374833106995 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7284374833106995.
[I 2025-03-21 15:12:14,975] Trial 1 finished with value: 0.8023250699043274 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7284374833106995.
... storing 'Rank_Label' as categorical
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6978
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 191(58.95%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6623
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7052
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 159(49.07%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7521
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7023
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7219
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 218(67.28%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8133
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8074
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7284
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 287(56.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 15:12:18,464] A new study created in memory with name: no-name-ed42404d-00c1-4e47-a7c1-8db7bf7b0a9e
[I 2025-03-21 15:12:27,141] Trial 0 finished with value: 0.8206663727760315 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8206663727760315.
[I 2025-03-21 15:12:34,454] Trial 1 finished with value: 0.7297269105911255 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7297269105911255.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:12:37,884] A new study created in memory with name: no-name-355de169-9c0c-44ce-a1c0-4c3b9e680ac3
[I 2025-03-21 15:12:41,847] Trial 0 finished with value: 0.7844017744064331 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7844017744064331.
[I 2025-03-21 15:12:45,706] Trial 1 finished with value: 0.7838563919067383 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7838563919067383.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:12:49,084] A new study created in memory with name: no-name-ab0475e2-c5d0-425a-99e3-765e109395aa
[I 2025-03-21 15:12:54,647] Trial 0 finished with value: 0.7912709712982178 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.7912709712982178.
[I 2025-03-21 15:12:57,048] Trial 1 finished with value: 0.756623387336731 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.756623387336731.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:13:00,416] A new study created in memory with name: no-name-e64fda72-789b-4d5d-b3ae-a8f5134ea998
[I 2025-03-21 15:13:05,022] Trial 0 finished with value: 0.7855861186981201 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7855861186981201.
[I 2025-03-21 15:13:10,036] Trial 1 finished with value: 0.7831301689147949 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7831301689147949.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:13:13,406] A new study created in memory with name: no-name-7fa3aab0-e6ae-4552-9ff0-3741a2d8db57
[I 2025-03-21 15:13:16,128] Trial 0 finished with value: 0.7952730059623718 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7952730059623718.
[I 2025-03-21 15:13:20,262] Trial 1 finished with value: 0.793265700340271 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.793265700340271.
... storing 'Rank_Label' as categorical
2025-03-21 15:13:23,634 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2
Processing datasets for repeat 6:  90%|█████████ | 9/10 [2:29:51<07:51, 471.63s/it]2025-03-21 15:13:23,635 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1
[I 2025-03-21 15:13:57,042] A new study created in memory with name: no-name-f22fad2a-0de2-4413-be67-f5bb984b7e13
[I 2025-03-21 15:14:00,708] Trial 0 finished with value: 1.0830799341201782 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 1.0830799341201782.
[I 2025-03-21 15:14:06,938] Trial 1 finished with value: 0.7494591474533081 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7494591474533081.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:14:10,356] A new study created in memory with name: no-name-8c688072-9ca3-45c5-8987-234ca4e2006e
[I 2025-03-21 15:14:14,339] Trial 0 finished with value: 0.8308039903640747 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.8308039903640747.
[I 2025-03-21 15:14:19,592] Trial 1 finished with value: 0.845867931842804 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8308039903640747.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8207
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7297
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 387(76.33%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7844
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7839
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7913
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7566
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7856
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7831
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7953
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7933
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 1.0831
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7495
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 174(34.32%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8308
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 101(19.92%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 15:14:22,992] A new study created in memory with name: no-name-e0aca3f6-425e-4b66-be3d-73fabf988039
[I 2025-03-21 15:14:25,285] Trial 0 finished with value: 0.775306224822998 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.775306224822998.
[I 2025-03-21 15:14:28,635] Trial 1 finished with value: 0.7967852354049683 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.775306224822998.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:14:32,010] A new study created in memory with name: no-name-67f42558-76cf-432a-b437-a643b3d453a8
[I 2025-03-21 15:14:36,406] Trial 0 finished with value: 0.8340365290641785 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8340365290641785.
[I 2025-03-21 15:14:39,965] Trial 1 finished with value: 0.7981570363044739 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7981570363044739.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:14:43,301] A new study created in memory with name: no-name-96a3cd1d-1ee9-463d-b060-914d87f54d70
[I 2025-03-21 15:14:47,612] Trial 0 finished with value: 0.8569031357765198 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8569031357765198.
[I 2025-03-21 15:14:51,459] Trial 1 finished with value: 0.7846165895462036 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7846165895462036.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:14:54,819] A new study created in memory with name: no-name-2d7505a2-75b1-4607-bf6c-a2b6d35ac36c
[I 2025-03-21 15:14:58,913] Trial 0 finished with value: 0.7984230518341064 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7984230518341064.
[I 2025-03-21 15:15:01,716] Trial 1 finished with value: 0.7925273180007935 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7925273180007935.
... storing 'Rank_Label' as categorical
2025-03-21 15:15:05,071 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1
Processing datasets for repeat 6: 100%|██████████| 10/10 [2:31:32<00:00, 357.34s/it]Processing datasets for repeat 6: 100%|██████████| 10/10 [2:31:32<00:00, 909.26s/it]
2025-03-21 15:15:05,072 - Repeat 6 completed
2025-03-21 15:15:05,073 - Starting repeat 7
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7753
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8340
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7982
Best hyperparameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8569
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7846
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 14(2.76%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_6/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7984
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7925
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 7:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 15:15:05,073 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10
[I 2025-03-21 15:15:29,439] A new study created in memory with name: no-name-c4334d77-4b39-440b-a68d-a2f7660dc63d
[I 2025-03-21 15:15:34,485] Trial 0 finished with value: 0.7625371813774109 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7625371813774109.
[I 2025-03-21 15:15:40,359] Trial 1 finished with value: 0.7765151858329773 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7625371813774109.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:15:42,348] A new study created in memory with name: no-name-6eafb26d-03cb-4ce6-bb97-8131cd758484
[I 2025-03-21 15:15:49,930] Trial 0 finished with value: 0.7697076797485352 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7697076797485352.
[I 2025-03-21 15:15:59,313] Trial 1 finished with value: 0.7856690287590027 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7697076797485352.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:16:01,278] A new study created in memory with name: no-name-e2e4f954-aa4a-4ff7-95c8-3b553ea454f7
[I 2025-03-21 15:16:07,468] Trial 0 finished with value: 0.7872905731201172 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7872905731201172.
[I 2025-03-21 15:16:13,311] Trial 1 finished with value: 0.7890729308128357 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7872905731201172.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:16:15,239] A new study created in memory with name: no-name-80b31801-11bf-4c58-b1d3-05d883f62512
[I 2025-03-21 15:16:19,256] Trial 0 finished with value: 0.7286490797996521 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7286490797996521.
[I 2025-03-21 15:16:23,350] Trial 1 finished with value: 0.7415623068809509 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7286490797996521.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:16:25,478] A new study created in memory with name: no-name-1cb163bf-1c45-4e57-8eb4-e4c55fd19fc6
[I 2025-03-21 15:16:30,788] Trial 0 finished with value: 0.7278062105178833 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7278062105178833.
[I 2025-03-21 15:16:33,938] Trial 1 finished with value: 0.7738801836967468 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7278062105178833.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:16:35,943] A new study created in memory with name: no-name-1d299649-c6cb-4811-8e4f-7aba2bd0e1aa
[I 2025-03-21 15:16:41,004] Trial 0 finished with value: 0.7957649230957031 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7957649230957031.
[I 2025-03-21 15:16:44,328] Trial 1 finished with value: 0.7986228466033936 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7957649230957031.
... storing 'Rank_Label' as categorical
2025-03-21 15:16:46,481 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10
Processing datasets for repeat 7:  10%|█         | 1/10 [01:41<15:12, 101.41s/it]2025-03-21 15:16:46,484 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9
[I 2025-03-21 15:17:18,227] A new study created in memory with name: no-name-541f99ef-3b1b-49f1-b996-9b0a68ee8be5
[I 2025-03-21 15:17:23,090] Trial 0 finished with value: 0.6499007940292358 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6499007940292358.
[I 2025-03-21 15:17:27,759] Trial 1 finished with value: 0.6205026507377625 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6205026507377625.
... storing 'Rank_Label' as categorical
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7625
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 121(28.21%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7697
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.23%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7873
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7286
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7278
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 12 components.
Reject 332(77.39%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7958
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6499
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6205
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
[I 2025-03-21 15:17:29,799] A new study created in memory with name: no-name-a4fb4806-061d-4c00-bc4b-b633036c83b5
[I 2025-03-21 15:17:36,159] Trial 0 finished with value: 0.7477991580963135 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7477991580963135.
[I 2025-03-21 15:17:43,825] Trial 1 finished with value: 0.7524561882019043 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7477991580963135.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:17:45,785] A new study created in memory with name: no-name-79d77f70-8ff1-4833-bff6-982aa3116c83
[I 2025-03-21 15:17:48,657] Trial 0 finished with value: 0.833081066608429 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.833081066608429.
[I 2025-03-21 15:17:51,971] Trial 1 finished with value: 0.6806660294532776 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 1 with value: 0.6806660294532776.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:17:54,144] A new study created in memory with name: no-name-b91c3eef-0fe2-402f-9d0b-68add91c058c
[I 2025-03-21 15:17:57,270] Trial 0 finished with value: 0.734305739402771 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.734305739402771.
[I 2025-03-21 15:18:00,110] Trial 1 finished with value: 0.7364329099655151 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.734305739402771.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:18:02,057] A new study created in memory with name: no-name-76604673-4d2c-4cc5-9bd0-dd8190e4976f
[I 2025-03-21 15:18:05,870] Trial 0 finished with value: 0.6902672052383423 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.6902672052383423.
[I 2025-03-21 15:18:10,197] Trial 1 finished with value: 0.6722204685211182 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.6722204685211182.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:18:12,351] A new study created in memory with name: no-name-5a7cdc89-796d-4c9b-acc3-518fc61ee6c0
[I 2025-03-21 15:18:15,532] Trial 0 finished with value: 0.7831423282623291 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7831423282623291.
[I 2025-03-21 15:18:18,252] Trial 1 finished with value: 0.7434238195419312 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7434238195419312.
... storing 'Rank_Label' as categorical
2025-03-21 15:18:20,188 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9
Processing datasets for repeat 7:  20%|██        | 2/10 [03:15<12:55, 96.88s/it] 2025-03-21 15:18:20,189 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8
[I 2025-03-21 15:27:43,096] A new study created in memory with name: no-name-9c606f3c-c516-427f-b587-43da98b254a1
[I 2025-03-21 15:32:39,837] Trial 0 finished with value: 0.9226271976595339 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.9226271976595339.
[I 2025-03-21 15:38:09,567] Trial 1 finished with value: 0.6050330296806667 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6050330296806667.
... storing 'Rank_Label' as categorical
[I 2025-03-21 15:40:44,643] A new study created in memory with name: no-name-d83d95b1-07c3-4b5c-9363-ec43bf02064f
[I 2025-03-21 15:46:14,515] Trial 0 finished with value: 0.5699189020239789 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.5699189020239789.
[I 2025-03-21 15:49:34,355] Trial 1 finished with value: 0.5844003221263057 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.5699189020239789.
... storing 'Rank_Label' as categorical
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7478
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8331
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6807
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 135(31.47%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7343
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6903
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6722
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 19(4.43%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7831
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7434
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.9226
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6050
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 8 components.
Reject 3799(16.21%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5699
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 368(1.57%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 15:52:11,607] A new study created in memory with name: no-name-e88e7039-23da-4ab0-bdac-06ca9d0dcb19
[I 2025-03-21 15:56:21,008] Trial 0 finished with value: 0.5661146485287211 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.5661146485287211.
[I 2025-03-21 16:00:25,417] Trial 1 finished with value: 0.7637200122294219 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.5661146485287211.
... storing 'Rank_Label' as categorical
[I 2025-03-21 16:02:15,871] A new study created in memory with name: no-name-13e8640e-569a-4cc7-bcd7-e7b9fa78f983
[I 2025-03-21 16:06:21,688] Trial 0 finished with value: 0.803360244502192 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.803360244502192.
[I 2025-03-21 16:09:54,122] Trial 1 finished with value: 0.7898288680159528 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7898288680159528.
... storing 'Rank_Label' as categorical
[I 2025-03-21 16:11:43,822] A new study created in memory with name: no-name-ad51c5f9-ce6a-43b5-8c07-f677abaa6023
[I 2025-03-21 16:15:43,817] Trial 0 finished with value: 0.654401843962462 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.654401843962462.
[I 2025-03-21 16:18:46,349] Trial 1 finished with value: 0.7553981568502344 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.654401843962462.
... storing 'Rank_Label' as categorical
[I 2025-03-21 16:20:35,248] A new study created in memory with name: no-name-ef9f4a99-265a-4159-9939-be6e9af55791
[I 2025-03-21 16:25:40,592] Trial 0 finished with value: 0.7496800552243772 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7496800552243772.
[I 2025-03-21 16:28:43,230] Trial 1 finished with value: 0.803721414959949 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7496800552243772.
... storing 'Rank_Label' as categorical
2025-03-21 16:30:31,930 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8
Processing datasets for repeat 7:  30%|███       | 3/10 [1:15:26<3:56:54, 2030.61s/it]2025-03-21 16:30:31,931 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7
[I 2025-03-21 16:39:58,017] A new study created in memory with name: no-name-17fae2c7-c055-4e09-9340-9e5268cfa818
[I 2025-03-21 16:43:51,139] Trial 0 finished with value: 0.8410264046295829 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8410264046295829.
[I 2025-03-21 16:48:54,116] Trial 1 finished with value: 0.7241947521334109 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7241947521334109.
... storing 'Rank_Label' as categorical
[I 2025-03-21 16:51:04,557] A new study created in memory with name: no-name-9c12652b-f7a1-4327-8795-108dec8d5400
[I 2025-03-21 16:55:30,427] Trial 0 finished with value: 0.9495623370875483 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.9495623370875483.
[I 2025-03-21 16:58:52,131] Trial 1 finished with value: 0.7197911765264429 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7197911765264429.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:01:22,293] A new study created in memory with name: no-name-70deb686-bdca-476a-9ae7-9ac7cb4e220f
[I 2025-03-21 17:06:05,014] Trial 0 finished with value: 0.6740191682525303 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6740191682525303.
[I 2025-03-21 17:09:10,397] Trial 1 finished with value: 0.7877479117849598 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6740191682525303.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:11:00,120] A new study created in memory with name: no-name-1208d2d9-ccf8-4afc-bcd2-62e13e2b623f
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5661
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 11055(47.18%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8034
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7898
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6544
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 400(1.71%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7497
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8410
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7242
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 8888(37.93%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.9496
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7198
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8(0.03%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6740
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 15160(64.69%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
[I 2025-03-21 17:14:56,283] Trial 0 finished with value: 0.8133554717768794 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.8133554717768794.
[I 2025-03-21 17:17:58,383] Trial 1 finished with value: 0.7560919549154199 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7560919549154199.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:19:47,425] A new study created in memory with name: no-name-49a27690-3ea8-471b-9def-0687414002aa
[I 2025-03-21 17:23:50,804] Trial 0 finished with value: 0.7276594872060029 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7276594872060029.
[I 2025-03-21 17:26:53,145] Trial 1 finished with value: 0.7513499026713164 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7276594872060029.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:28:43,389] A new study created in memory with name: no-name-59c49f38-3794-40ed-a68b-37edf43f2c3d
[I 2025-03-21 17:31:46,266] Trial 0 finished with value: 0.8042213579882747 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8042213579882747.
[I 2025-03-21 17:35:19,997] Trial 1 finished with value: 0.8370489296705826 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8042213579882747.
... storing 'Rank_Label' as categorical
2025-03-21 17:37:08,721 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7
Processing datasets for repeat 7:  40%|████      | 4/10 [2:22:03<4:40:41, 2806.84s/it]2025-03-21 17:37:08,738 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6
[I 2025-03-21 17:37:29,146] A new study created in memory with name: no-name-0c9e3652-a5a3-444a-90dc-f92c2638057f
[I 2025-03-21 17:37:39,457] Trial 0 finished with value: 0.5477222204208374 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.5477222204208374.
[I 2025-03-21 17:37:48,132] Trial 1 finished with value: 0.6090171933174133 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.5477222204208374.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:37:51,119] A new study created in memory with name: no-name-d79e58b5-c04a-4053-87ff-2f2ee5af2dc1
[I 2025-03-21 17:38:06,590] Trial 0 finished with value: 0.550806999206543 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.550806999206543.
[I 2025-03-21 17:38:16,813] Trial 1 finished with value: 0.6901553869247437 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.550806999206543.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:38:19,661] A new study created in memory with name: no-name-a6829eb9-b58d-4824-b813-c150eb21dacc
[I 2025-03-21 17:38:31,446] Trial 0 finished with value: 0.5833387970924377 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.5833387970924377.
[I 2025-03-21 17:38:39,167] Trial 1 finished with value: 0.569200724363327 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 1 with value: 0.569200724363327.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:38:42,017] A new study created in memory with name: no-name-4941a973-54f9-4ce8-a2fe-a779d995eb78
[I 2025-03-21 17:38:50,967] Trial 0 finished with value: 0.7640892863273621 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7640892863273621.
[I 2025-03-21 17:38:58,902] Trial 1 finished with value: 0.7860377430915833 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7640892863273621.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:39:01,710] A new study created in memory with name: no-name-18312e12-2d49-4ef6-b9e1-65d8413cdef0
[I 2025-03-21 17:39:13,231] Trial 0 finished with value: 0.6156765222549438 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.6156765222549438.
[I 2025-03-21 17:39:26,007] Trial 1 finished with value: 0.6210017502307892 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6156765222549438.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8134
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7561
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7277
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 635(2.71%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8042
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5477
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 624(38.90%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5508
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 390(24.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5833
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5692
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 701(43.70%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7641
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6157
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: ... storing 'Rank_Label' as categorical
[I 2025-03-21 17:39:28,817] A new study created in memory with name: no-name-44cb6cad-642a-4617-b7e7-2e1684594542
[I 2025-03-21 17:39:41,477] Trial 0 finished with value: 0.8175343871116638 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8175343871116638.
[I 2025-03-21 17:39:54,396] Trial 1 finished with value: 0.7952479422092438 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7952479422092438.
... storing 'Rank_Label' as categorical
2025-03-21 17:39:57,262 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6
Processing datasets for repeat 7:  50%|█████     | 5/10 [2:24:52<2:34:37, 1855.45s/it]2025-03-21 17:39:57,264 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5
[I 2025-03-21 17:40:29,700] A new study created in memory with name: no-name-794277e7-9382-4335-a163-b93ae2f11362
[I 2025-03-21 17:40:38,311] Trial 0 finished with value: 0.6106533408164978 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6106533408164978.
[I 2025-03-21 17:40:46,625] Trial 1 finished with value: 0.7276210784912109 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6106533408164978.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:40:49,538] A new study created in memory with name: no-name-68708276-ad75-4137-aeaa-ee0c3efc4235
[I 2025-03-21 17:40:57,927] Trial 0 finished with value: 0.7109143435955048 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7109143435955048.
[I 2025-03-21 17:41:05,905] Trial 1 finished with value: 0.742202639579773 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7109143435955048.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:41:08,736] A new study created in memory with name: no-name-148f9170-f3f2-4914-a1a9-6521e84a74bf
[I 2025-03-21 17:41:19,094] Trial 0 finished with value: 0.8570873737335205 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8570873737335205.
[I 2025-03-21 17:41:27,552] Trial 1 finished with value: 0.7540949583053589 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7540949583053589.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:41:31,524] A new study created in memory with name: no-name-de339a81-da5c-4aa2-ab4f-686ecce6160b
[I 2025-03-21 17:41:43,626] Trial 0 finished with value: 0.7932500541210175 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7932500541210175.
[I 2025-03-21 17:41:54,153] Trial 1 finished with value: 0.8104453086853027 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7932500541210175.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:41:56,959] A new study created in memory with name: no-name-d6c5a0b3-9d45-40c9-bc6b-43b5600d49c5
[I 2025-03-21 17:42:05,425] Trial 0 finished with value: 0.7072694003582001 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7072694003582001.
[I 2025-03-21 17:42:14,659] Trial 1 finished with value: 0.7351092100143433 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7072694003582001.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:42:17,508] A new study created in memory with name: no-name-a4e2dbc6-4392-4309-8919-c36c1b3cbfdf
[I 2025-03-21 17:42:27,016] Trial 0 finished with value: 0.7484390735626221 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7484390735626221.
[I 2025-03-21 17:42:38,905] Trial 1 finished with value: 0.8300136923789978 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7484390735626221.
{'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 6(0.37%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8175
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7952
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6107
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.4, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 535(33.35%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7109
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8571
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7541
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 0 with 4 components.
Reject 895(55.80%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7933
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7073
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 143(8.92%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7484
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
... storing 'Rank_Label' as categorical
2025-03-21 17:42:41,730 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data5
Processing datasets for repeat 7:  60%|██████    | 6/10 [2:27:36<1:25:22, 1280.51s/it]2025-03-21 17:42:41,731 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4
[I 2025-03-21 17:43:20,303] A new study created in memory with name: no-name-c4b02c4d-11f2-4623-a352-c187ee9c99b6
[I 2025-03-21 17:43:23,847] Trial 0 finished with value: 0.7411564588546753 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7411564588546753.
[I 2025-03-21 17:43:28,582] Trial 1 finished with value: 0.7030912637710571 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7030912637710571.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:43:31,367] A new study created in memory with name: no-name-73e0e918-1d6f-4324-9235-bfef805b2715
[I 2025-03-21 17:43:36,143] Trial 0 finished with value: 0.6648769974708557 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6648769974708557.
[I 2025-03-21 17:43:42,585] Trial 1 finished with value: 0.6850878596305847 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6648769974708557.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:43:45,331] A new study created in memory with name: no-name-1b3383e0-eb67-49e3-bd2e-7ed30fe3def7
[I 2025-03-21 17:43:47,778] Trial 0 finished with value: 0.7371098399162292 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7371098399162292.
[I 2025-03-21 17:43:51,060] Trial 1 finished with value: 0.6444827318191528 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 1 with value: 0.6444827318191528.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:43:53,855] A new study created in memory with name: no-name-74d8d2e8-791a-4cfd-9b4a-f1122823d42b
[I 2025-03-21 17:43:57,540] Trial 0 finished with value: 0.7634304761886597 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7634304761886597.
[I 2025-03-21 17:44:01,124] Trial 1 finished with value: 0.7044773697853088 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7044773697853088.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:44:03,858] A new study created in memory with name: no-name-adc5e0fb-891b-4c27-9e3f-cf96d12eb975
[I 2025-03-21 17:44:07,972] Trial 0 finished with value: 0.6998037695884705 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6998037695884705.
[I 2025-03-21 17:44:10,856] Trial 1 finished with value: 0.7229004502296448 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6998037695884705.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:44:13,595] A new study created in memory with name: no-name-1131881f-718f-4ee0-840b-20341898ccc1
[I 2025-03-21 17:44:18,302] Trial 0 finished with value: 0.775407612323761 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.775407612323761.
[I 2025-03-21 17:44:22,986] Trial 1 finished with value: 0.8188836574554443 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.775407612323761.
... storing 'Rank_Label' as categorical
2025-03-21 17:44:25,896 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4
Processing datasets for repeat 7:  70%|███████   | 7/10 [2:29:20<44:47, 895.94s/it]   2025-03-21 17:44:25,898 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3
[I 2025-03-21 17:45:03,020] A new study created in memory with name: no-name-32f0b493-bc27-4740-8a26-d4759b4627ab
[I 2025-03-21 17:45:06,866] Trial 0 finished with value: 0.7397772669792175 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7397772669792175.
[I 2025-03-21 17:45:11,042] Trial 1 finished with value: 0.7270857095718384 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7270857095718384.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7412
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7031
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 9(2.78%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6649
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 161(49.69%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7371
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6445
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 13 components.
Reject 292(90.12%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7634
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7045
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6998
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 104(32.10%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7754
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7398
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7271
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:45:13,825] A new study created in memory with name: no-name-5be66314-8390-4ca1-a3b4-d83d8343714b
[I 2025-03-21 17:45:19,355] Trial 0 finished with value: 0.7164801955223083 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7164801955223083.
[I 2025-03-21 17:45:24,866] Trial 1 finished with value: 0.8033501505851746 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7164801955223083.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:45:27,615] A new study created in memory with name: no-name-30a8e226-5092-4b1b-81ad-dd67de914a32
[I 2025-03-21 17:45:30,933] Trial 0 finished with value: 0.6451807618141174 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6451807618141174.
[I 2025-03-21 17:45:34,212] Trial 1 finished with value: 0.777786135673523 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6451807618141174.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:45:36,997] A new study created in memory with name: no-name-f7f24b88-1ff7-4cff-b13b-79efd37ad64a
[I 2025-03-21 17:45:41,496] Trial 0 finished with value: 0.8053048849105835 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8053048849105835.
[I 2025-03-21 17:45:45,209] Trial 1 finished with value: 0.7321909070014954 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7321909070014954.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:45:48,118] A new study created in memory with name: no-name-e9a5f0c9-a613-400c-9234-c23f99ce9d7c
[I 2025-03-21 17:45:50,889] Trial 0 finished with value: 0.7067157030105591 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7067157030105591.
[I 2025-03-21 17:45:55,202] Trial 1 finished with value: 0.7826805114746094 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7067157030105591.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:45:57,928] A new study created in memory with name: no-name-5944851b-38b5-48ec-b197-9a3fb022e537
[I 2025-03-21 17:46:01,674] Trial 0 finished with value: 0.7602246999740601 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7602246999740601.
[I 2025-03-21 17:46:04,938] Trial 1 finished with value: 0.7733176946640015 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7602246999740601.
... storing 'Rank_Label' as categorical
2025-03-21 17:46:07,647 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3
Processing datasets for repeat 7:  80%|████████  | 8/10 [2:31:02<21:26, 643.11s/it]2025-03-21 17:46:07,648 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2
[I 2025-03-21 17:46:33,102] A new study created in memory with name: no-name-afee28a9-f020-48a8-9f18-59fa5fc6de53
[I 2025-03-21 17:46:39,873] Trial 0 finished with value: 0.7208707332611084 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7208707332611084.
[I 2025-03-21 17:46:44,212] Trial 1 finished with value: 0.7383131980895996 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7208707332611084.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:46:47,648] A new study created in memory with name: no-name-ed24eb9c-69de-4ed3-ac3a-c317529e0fb3
[I 2025-03-21 17:46:56,806] Trial 0 finished with value: 0.7324512600898743 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7324512600898743.
[I 2025-03-21 17:47:01,011] Trial 1 finished with value: 0.7881273627281189 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7324512600898743.
... storing 'Rank_Label' as categorical
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7165
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6452
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 12 components.
Reject 288(88.89%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8053
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7322
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7067
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 63(19.44%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7602
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7209
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 11 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7325
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 294(57.99%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 17:47:04,381] A new study created in memory with name: no-name-4633f68a-c712-45e4-af91-bb6f2a08b2e3
[I 2025-03-21 17:47:10,323] Trial 0 finished with value: 0.7644407749176025 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7644407749176025.
[I 2025-03-21 17:47:13,963] Trial 1 finished with value: 0.7688896059989929 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7644407749176025.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:47:17,318] A new study created in memory with name: no-name-87f4649b-3bf2-462d-b0ad-1fe012030124
[I 2025-03-21 17:47:20,209] Trial 0 finished with value: 0.7385944128036499 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7385944128036499.
[I 2025-03-21 17:47:25,670] Trial 1 finished with value: 0.732736349105835 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 1 with value: 0.732736349105835.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:47:29,024] A new study created in memory with name: no-name-ab961064-2e49-493f-8a20-c781b3a2af43
[I 2025-03-21 17:47:34,765] Trial 0 finished with value: 0.7892554402351379 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7892554402351379.
[I 2025-03-21 17:47:38,213] Trial 1 finished with value: 0.820399284362793 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7892554402351379.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:47:41,582] A new study created in memory with name: no-name-06ee10eb-f863-4aa9-8331-1ede85b70373
[I 2025-03-21 17:47:46,371] Trial 0 finished with value: 0.795767068862915 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.795767068862915.
[I 2025-03-21 17:47:50,182] Trial 1 finished with value: 0.7898157238960266 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7898157238960266.
... storing 'Rank_Label' as categorical
2025-03-21 17:47:53,540 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2
Processing datasets for repeat 7:  90%|█████████ | 9/10 [2:32:48<07:55, 475.16s/it]2025-03-21 17:47:53,541 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1
[I 2025-03-21 17:48:27,588] A new study created in memory with name: no-name-cac0d965-8f71-4218-a72d-67bb30cd60a5
[I 2025-03-21 17:48:32,504] Trial 0 finished with value: 0.7389143705368042 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7389143705368042.
[I 2025-03-21 17:48:36,344] Trial 1 finished with value: 0.6820006370544434 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6820006370544434.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:48:39,933] A new study created in memory with name: no-name-05c503e3-fe6b-42e2-97f1-0261a8779d8a
[I 2025-03-21 17:48:47,513] Trial 0 finished with value: 0.6281245350837708 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6281245350837708.
[I 2025-03-21 17:48:50,659] Trial 1 finished with value: 0.8892086148262024 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6281245350837708.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:48:54,017] A new study created in memory with name: no-name-1acc19c5-f4c8-4068-a9e7-b8e5e67912f2
[I 2025-03-21 17:48:56,955] Trial 0 finished with value: 0.8234476447105408 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.8234476447105408.
[I 2025-03-21 17:49:00,278] Trial 1 finished with value: 0.7889678478240967 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7889678478240967.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7644
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 27(5.33%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7386
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7327
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7893
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7958
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7898
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7389
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6820
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.20%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6281
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8234
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7890
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 131(25.84%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 17:49:03,647] A new study created in memory with name: no-name-b0049422-a18a-4b6d-89d4-421f895fcaf7
[I 2025-03-21 17:49:07,684] Trial 0 finished with value: 0.7771168947219849 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7771168947219849.
[I 2025-03-21 17:49:09,927] Trial 1 finished with value: 0.7761633396148682 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7761633396148682.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:49:13,264] A new study created in memory with name: no-name-259f6d03-9d3f-40a4-98dd-fcf4cf9057f8
[I 2025-03-21 17:49:18,089] Trial 0 finished with value: 0.8006942272186279 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8006942272186279.
[I 2025-03-21 17:49:20,313] Trial 1 finished with value: 0.8044678568840027 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8006942272186279.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:49:23,625] A new study created in memory with name: no-name-1c952cc8-37fe-452e-a64b-1d8724690180
[I 2025-03-21 17:49:27,934] Trial 0 finished with value: 0.7700042724609375 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7700042724609375.
[I 2025-03-21 17:49:30,806] Trial 1 finished with value: 0.8046542406082153 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7700042724609375.
... storing 'Rank_Label' as categorical
2025-03-21 17:49:34,127 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1
Processing datasets for repeat 7: 100%|██████████| 10/10 [2:34:29<00:00, 359.53s/it]Processing datasets for repeat 7: 100%|██████████| 10/10 [2:34:29<00:00, 926.91s/it]
2025-03-21 17:49:34,129 - Repeat 7 completed
2025-03-21 17:49:34,131 - Starting repeat 8
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7771
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7762
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8007
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 66(13.02%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_7/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7700
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 8:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 17:49:34,138 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10
[I 2025-03-21 17:49:57,607] A new study created in memory with name: no-name-f42a62ae-e27f-44b9-aebb-5af33fb09246
[I 2025-03-21 17:50:04,124] Trial 0 finished with value: 0.7407132387161255 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7407132387161255.
[I 2025-03-21 17:50:08,132] Trial 1 finished with value: 0.8057577610015869 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.7407132387161255.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:50:10,274] A new study created in memory with name: no-name-8e7797a8-17c4-4396-a849-a035b23d0e89
[I 2025-03-21 17:50:16,151] Trial 0 finished with value: 0.7906723618507385 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7906723618507385.
[I 2025-03-21 17:50:22,615] Trial 1 finished with value: 0.7438454031944275 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7438454031944275.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:50:24,568] A new study created in memory with name: no-name-5012b60e-3f0d-487c-b2f7-7dcc6cc4a69b
[I 2025-03-21 17:50:29,928] Trial 0 finished with value: 0.732606053352356 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.732606053352356.
[I 2025-03-21 17:50:35,349] Trial 1 finished with value: 0.7901086211204529 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.732606053352356.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:50:37,278] A new study created in memory with name: no-name-6570338f-317f-47bd-abdd-b61e873a7dcd
[I 2025-03-21 17:50:42,991] Trial 0 finished with value: 0.7184710502624512 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7184710502624512.
[I 2025-03-21 17:50:48,476] Trial 1 finished with value: 0.7897596955299377 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7184710502624512.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:50:50,386] A new study created in memory with name: no-name-626a0e2a-fd56-4a71-9a30-58d35dbf237c
[I 2025-03-21 17:50:56,129] Trial 0 finished with value: 0.7821918725967407 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7821918725967407.
[I 2025-03-21 17:51:00,888] Trial 1 finished with value: 0.7875704765319824 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7821918725967407.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:51:02,797] A new study created in memory with name: no-name-2c18f393-b964-44cf-9b05-ab5cdc265821
[I 2025-03-21 17:51:07,339] Trial 0 finished with value: 0.7904303669929504 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7904303669929504.
[I 2025-03-21 17:51:12,872] Trial 1 finished with value: 0.79207843542099 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7904303669929504.
... storing 'Rank_Label' as categorical
2025-03-21 17:51:14,756 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10
Processing datasets for repeat 8:  10%|█         | 1/10 [01:40<15:05, 100.62s/it]2025-03-21 17:51:14,758 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9
[I 2025-03-21 17:51:44,963] A new study created in memory with name: no-name-1ace0e32-2fe3-4e8e-a47a-315566ad223a
[I 2025-03-21 17:51:50,547] Trial 0 finished with value: 0.685453474521637 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.685453474521637.
[I 2025-03-21 17:51:53,587] Trial 1 finished with value: 0.7289266586303711 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.685453474521637.
... storing 'Rank_Label' as categorical
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7407
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 285(66.43%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7907
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7438
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7326
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 194(45.22%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7185
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7822
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7904
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6855
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 6 components.
Reject 247(57.58%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 17:51:55,563] A new study created in memory with name: no-name-8efcf773-d950-45f1-9a81-5c6088570f46
[I 2025-03-21 17:52:02,481] Trial 0 finished with value: 0.6896083950996399 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6896083950996399.
[I 2025-03-21 17:52:09,419] Trial 1 finished with value: 0.8660238981246948 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6896083950996399.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:52:11,351] A new study created in memory with name: no-name-fcab7ca6-80a6-4ea3-9ddd-24a8b949720c
[I 2025-03-21 17:52:15,310] Trial 0 finished with value: 0.6807584762573242 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.6807584762573242.
[I 2025-03-21 17:52:19,049] Trial 1 finished with value: 0.8508304357528687 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6807584762573242.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:52:20,930] A new study created in memory with name: no-name-c6f95fde-8112-4777-9695-6ee8572e1ac2
[I 2025-03-21 17:52:24,800] Trial 0 finished with value: 0.7867755889892578 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7867755889892578.
[I 2025-03-21 17:52:29,575] Trial 1 finished with value: 0.7441231608390808 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7441231608390808.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:52:31,465] A new study created in memory with name: no-name-f602543a-c1c3-474f-b156-4228e64d046f
[I 2025-03-21 17:52:34,634] Trial 0 finished with value: 0.7199367880821228 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7199367880821228.
[I 2025-03-21 17:52:39,439] Trial 1 finished with value: 0.7290527820587158 and parameters: {'lr': 0.0001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7199367880821228.
... storing 'Rank_Label' as categorical
[I 2025-03-21 17:52:41,340] A new study created in memory with name: no-name-d4f47f58-8295-4c70-858a-e1682d964c51
[I 2025-03-21 17:52:44,730] Trial 0 finished with value: 0.8391720652580261 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.8391720652580261.
[I 2025-03-21 17:52:48,455] Trial 1 finished with value: 0.8296319842338562 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.8296319842338562.
... storing 'Rank_Label' as categorical
2025-03-21 17:52:50,383 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9
Processing datasets for repeat 8:  20%|██        | 2/10 [03:16<13:01, 97.68s/it] 2025-03-21 17:52:50,386 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8
[I 2025-03-21 18:01:49,810] A new study created in memory with name: no-name-7f85750f-7f3d-4ec7-9cac-7a06053d5ef3
[I 2025-03-21 18:05:05,829] Trial 0 finished with value: 0.655278029649154 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.655278029649154.
[I 2025-03-21 18:08:56,136] Trial 1 finished with value: 1.0362476473269255 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.655278029649154.
... storing 'Rank_Label' as categorical
[I 2025-03-21 18:11:08,300] A new study created in memory with name: no-name-ca56af52-3ad3-40ba-8d5a-61ff9317dc7c
[I 2025-03-21 18:16:28,186] Trial 0 finished with value: 0.5599403951479041 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.5599403951479041.
[I 2025-03-21 18:21:18,881] Trial 1 finished with value: 0.6001044874605925 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.5599403951479041.
... storing 'Rank_Label' as categorical
[I 2025-03-21 18:23:50,609] A new study created in memory with name: no-name-445469ab-7a10-4fee-997b-074b1d70941a
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6896
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6808
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7868
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7441
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7199
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 24(5.59%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8392
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.8296
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6553
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 11204(47.81%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5599
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 8466(36.13%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
[I 2025-03-21 18:28:54,595] Trial 0 finished with value: 0.5873679259549016 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.5873679259549016.
[I 2025-03-21 18:32:24,997] Trial 1 finished with value: 0.599624312442282 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.5873679259549016.
... storing 'Rank_Label' as categorical
[I 2025-03-21 18:34:16,091] A new study created in memory with name: no-name-5519be91-df39-4fab-a059-56737288ccd8
[I 2025-03-21 18:39:21,620] Trial 0 finished with value: 0.8181362385335176 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.8181362385335176.
[I 2025-03-21 18:42:18,484] Trial 1 finished with value: 0.7521697386451389 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7521697386451389.
... storing 'Rank_Label' as categorical
[I 2025-03-21 18:44:07,678] A new study created in memory with name: no-name-c07be620-eb78-432c-af6c-a40fb1e53ce2
[I 2025-03-21 18:49:10,485] Trial 0 finished with value: 0.6910860668057981 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6910860668057981.
[I 2025-03-21 18:53:46,599] Trial 1 finished with value: 0.6789948370145715 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.6789948370145715.
... storing 'Rank_Label' as categorical
[I 2025-03-21 18:55:36,543] A new study created in memory with name: no-name-39c9efa3-b12c-4ed3-a456-4dc44e89dec3
[I 2025-03-21 18:58:38,791] Trial 0 finished with value: 0.7968759407167849 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7968759407167849.
[I 2025-03-21 19:01:42,078] Trial 1 finished with value: 0.8144994896391163 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7968759407167849.
... storing 'Rank_Label' as categorical
2025-03-21 19:03:30,964 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8
Processing datasets for repeat 8:  30%|███       | 3/10 [1:13:56<3:52:05, 1989.42s/it]2025-03-21 19:03:30,967 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7
[I 2025-03-21 19:12:26,895] A new study created in memory with name: no-name-17092759-a186-464b-aa0b-43beaa338994
[I 2025-03-21 19:16:50,972] Trial 0 finished with value: 0.8203039117481398 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 1}. Best is trial 0 with value: 0.8203039117481398.
[I 2025-03-21 19:21:48,091] Trial 1 finished with value: 0.6548736147258593 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6548736147258593.
... storing 'Rank_Label' as categorical
[I 2025-03-21 19:23:39,578] A new study created in memory with name: no-name-44b1b2d9-517a-434b-98f6-2153850f484e
[I 2025-03-21 19:28:56,110] Trial 0 finished with value: 0.8983082641725955 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8983082641725955.
[I 2025-03-21 19:34:10,703] Trial 1 finished with value: 0.795601347218389 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 1 with value: 0.795601347218389.
... storing 'Rank_Label' as categorical
[I 2025-03-21 19:35:59,662] A new study created in memory with name: no-name-bd6b0b8b-aa23-48c1-872a-a40746ea89de
[I 2025-03-21 19:40:38,200] Trial 0 finished with value: 0.6775049230326777 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6775049230326777.
[I 2025-03-21 19:44:13,715] Trial 1 finished with value: 0.772454982218535 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.6775049230326777.
... storing 'Rank_Label' as categorical
[I 2025-03-21 19:46:03,026] A new study created in memory with name: no-name-30eaf91f-f450-40c4-8f57-64029b827c80
[I 2025-03-21 19:49:40,194] Trial 0 finished with value: 0.7676165544468424 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7676165544468424.
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5874
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 11876(50.68%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8181
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7522
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6911
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6790
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 2201(9.39%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7969
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8203
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6549
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 8 components.
Reject 11510(49.12%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8983
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7956
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6775
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 11504(49.09%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7676
[I 2025-03-21 19:54:16,802] Trial 1 finished with value: 0.8278731600097988 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7676165544468424.
... storing 'Rank_Label' as categorical
[I 2025-03-21 19:56:46,245] A new study created in memory with name: no-name-f53e1fee-c73d-48a5-86c5-407d6b0d30bc
[I 2025-03-21 20:00:56,302] Trial 0 finished with value: 0.720635605895001 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.720635605895001.
[I 2025-03-21 20:06:07,078] Trial 1 finished with value: 0.7444035203560538 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.720635605895001.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:08:02,841] A new study created in memory with name: no-name-0201eb9f-02ca-4894-b1d7-94b4be320a51
[I 2025-03-21 20:11:39,395] Trial 0 finished with value: 0.8293249684831371 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8293249684831371.
[I 2025-03-21 20:14:39,775] Trial 1 finished with value: 0.7556028029193049 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7556028029193049.
... storing 'Rank_Label' as categorical
2025-03-21 20:16:36,131 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7
Processing datasets for repeat 8:  40%|████      | 4/10 [2:27:01<4:53:31, 2935.23s/it]2025-03-21 20:16:36,138 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6
[I 2025-03-21 20:16:57,293] A new study created in memory with name: no-name-c88eb055-79b5-476e-8b9a-2bc4fd281b52
[I 2025-03-21 20:17:06,270] Trial 0 finished with value: 0.808123916387558 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.808123916387558.
[I 2025-03-21 20:17:15,247] Trial 1 finished with value: 0.7540094256401062 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7540094256401062.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:17:18,173] A new study created in memory with name: no-name-83ee2fbc-8eee-425d-a5f1-5d4eb61844f5
[I 2025-03-21 20:17:26,727] Trial 0 finished with value: 0.6576140522956848 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6576140522956848.
[I 2025-03-21 20:17:40,414] Trial 1 finished with value: 0.5620267689228058 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 1 with value: 0.5620267689228058.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:17:43,250] A new study created in memory with name: no-name-641fd36f-8980-4274-98b2-c24f0d12e814
[I 2025-03-21 20:17:54,372] Trial 0 finished with value: 0.555900365114212 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.555900365114212.
[I 2025-03-21 20:18:03,324] Trial 1 finished with value: 0.5306715369224548 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 1 with value: 0.5306715369224548.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:18:06,213] A new study created in memory with name: no-name-2838bad7-c2d1-4cf9-964a-e299e93a6c88
[I 2025-03-21 20:18:13,482] Trial 0 finished with value: 0.7892579138278961 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7892579138278961.
[I 2025-03-21 20:18:25,975] Trial 1 finished with value: 0.7790406942367554 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7790406942367554.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:18:28,796] A new study created in memory with name: no-name-8e0308e9-9ddb-4e6a-86f3-b200bdd87116
[I 2025-03-21 20:18:37,620] Trial 0 finished with value: 0.6171568334102631 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6171568334102631.
[I 2025-03-21 20:18:46,243] Trial 1 finished with value: 0.6341736912727356 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.6171568334102631.
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7206
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 3(0.01%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8293
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7556
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8081
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7540
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.05, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 4 components.
Reject 1174(73.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6576
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5620
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 669(41.71%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5559
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5307
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 437(27.24%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7893
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7790
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6172
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: ... storing 'Rank_Label' as categorical
[I 2025-03-21 20:18:50,087] A new study created in memory with name: no-name-1fe8496c-7990-4f48-b785-abfcae50b39c
[I 2025-03-21 20:18:57,733] Trial 0 finished with value: 0.7783360779285431 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7783360779285431.
[I 2025-03-21 20:19:07,798] Trial 1 finished with value: 0.784682959318161 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7783360779285431.
... storing 'Rank_Label' as categorical
2025-03-21 20:19:10,834 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6
Processing datasets for repeat 8:  50%|█████     | 5/10 [2:29:36<2:41:02, 1932.55s/it]2025-03-21 20:19:10,836 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5
[I 2025-03-21 20:19:42,640] A new study created in memory with name: no-name-95428bb3-0375-4af4-88f4-827968f468b4
[I 2025-03-21 20:19:51,112] Trial 0 finished with value: 0.5064729750156403 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.5064729750156403.
[I 2025-03-21 20:20:03,380] Trial 1 finished with value: 0.7373268008232117 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.5064729750156403.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:20:06,273] A new study created in memory with name: no-name-9ad760a7-c2c1-40dc-b84e-3ea54a6b142f
[I 2025-03-21 20:20:19,701] Trial 0 finished with value: 0.695167601108551 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.695167601108551.
[I 2025-03-21 20:20:31,076] Trial 1 finished with value: 0.7372646033763885 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.695167601108551.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:20:33,940] A new study created in memory with name: no-name-d89bfbc9-00c7-42dd-8466-04e23fe1f226
[I 2025-03-21 20:20:42,281] Trial 0 finished with value: 0.7620896995067596 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7620896995067596.
[I 2025-03-21 20:20:48,780] Trial 1 finished with value: 0.7916964292526245 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7620896995067596.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:20:51,602] A new study created in memory with name: no-name-bcce9db0-29ad-4bf8-b36d-0dfc67514205
[I 2025-03-21 20:20:58,671] Trial 0 finished with value: 0.8199205100536346 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.8199205100536346.
[I 2025-03-21 20:21:05,632] Trial 1 finished with value: 0.7285015285015106 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7285015285015106.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:21:08,438] A new study created in memory with name: no-name-b5b9a3c5-d4ae-4856-be31-f65ff40c4f79
[I 2025-03-21 20:21:17,846] Trial 0 finished with value: 0.6912093460559845 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6912093460559845.
[I 2025-03-21 20:21:29,612] Trial 1 finished with value: 0.7702834904193878 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.6912093460559845.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:21:32,450] A new study created in memory with name: no-name-218dd503-74b1-46a9-8618-31786fcbdf69
[I 2025-03-21 20:21:39,660] Trial 0 finished with value: 0.725592702627182 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.725592702627182.
[I 2025-03-21 20:21:48,964] Trial 1 finished with value: 0.7736994624137878 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.725592702627182.
... storing 'Rank_Label' as categorical
2025-03-21 20:21:51,812 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5
Processing datasets for repeat 8:  60%|██████    | 6/10 [2:32:17<1:28:40, 1330.22s/it]2025-03-21 20:21:51,813 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4
{'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 74(4.61%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7783
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5065
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6952
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 9(0.56%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7621
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.06%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8199
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7285
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6912
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 134(8.35%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7256
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
[I 2025-03-21 20:22:31,019] A new study created in memory with name: no-name-cd30d4ee-27b2-4ef9-82f9-72393e349202
[I 2025-03-21 20:22:34,923] Trial 0 finished with value: 0.7635946869850159 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7635946869850159.
[I 2025-03-21 20:22:37,855] Trial 1 finished with value: 0.735081136226654 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.735081136226654.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:22:40,611] A new study created in memory with name: no-name-a77cb66d-6568-4984-a709-c4ebe119bef8
[I 2025-03-21 20:22:46,132] Trial 0 finished with value: 0.7618382573127747 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7618382573127747.
[I 2025-03-21 20:22:55,251] Trial 1 finished with value: 0.8175170421600342 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.7618382573127747.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:22:57,973] A new study created in memory with name: no-name-e8f77c1c-d09f-41d6-bb9b-a1f32b4750ef
[I 2025-03-21 20:23:01,800] Trial 0 finished with value: 0.7298116087913513 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7298116087913513.
[I 2025-03-21 20:23:04,620] Trial 1 finished with value: 0.6694895625114441 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6694895625114441.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:23:07,371] A new study created in memory with name: no-name-383fa466-3b63-4615-883d-f5616e1e121f
[I 2025-03-21 20:23:10,620] Trial 0 finished with value: 0.7728240489959717 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7728240489959717.
[I 2025-03-21 20:23:14,264] Trial 1 finished with value: 0.7518822550773621 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7518822550773621.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:23:17,045] A new study created in memory with name: no-name-e5b10fc2-851f-4d3b-9c09-31d587e5ba9d
[I 2025-03-21 20:23:20,785] Trial 0 finished with value: 0.7614500522613525 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7614500522613525.
[I 2025-03-21 20:23:24,440] Trial 1 finished with value: 0.7301484942436218 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7301484942436218.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:23:27,182] A new study created in memory with name: no-name-9587dc1c-4612-4671-a775-16915a1ef619
[I 2025-03-21 20:23:29,974] Trial 0 finished with value: 0.8377527594566345 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8377527594566345.
[I 2025-03-21 20:23:33,210] Trial 1 finished with value: 0.760658860206604 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.760658860206604.
... storing 'Rank_Label' as categorical
2025-03-21 20:23:35,967 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4
Processing datasets for repeat 8:  70%|███████   | 7/10 [2:34:01<46:28, 929.39s/it]   2025-03-21 20:23:35,973 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3
[I 2025-03-21 20:24:14,753] A new study created in memory with name: no-name-8ad469c3-1658-492c-8f0f-320a36e9140b
[I 2025-03-21 20:24:18,496] Trial 0 finished with value: 0.633819043636322 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.633819043636322.
[I 2025-03-21 20:24:22,140] Trial 1 finished with value: 0.8335185050964355 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 0 with value: 0.633819043636322.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7636
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7351
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 5(1.54%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7618
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.001, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7298
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6695
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 229(70.68%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7728
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7519
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7615
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7301
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 100(30.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8378
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7607
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6338
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:24:24,934] A new study created in memory with name: no-name-8785c822-25a8-4f92-a945-3637603b453d
[I 2025-03-21 20:24:33,279] Trial 0 finished with value: 0.6686044931411743 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6686044931411743.
[I 2025-03-21 20:24:40,250] Trial 1 finished with value: 0.787579357624054 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.7, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6686044931411743.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:24:42,999] A new study created in memory with name: no-name-606bcfb3-d43e-44b8-b4ec-b8837597c31b
[I 2025-03-21 20:24:47,397] Trial 0 finished with value: 0.6417351961135864 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6417351961135864.
[I 2025-03-21 20:24:51,002] Trial 1 finished with value: 0.7076977491378784 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6417351961135864.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:24:53,867] A new study created in memory with name: no-name-816aeac6-c222-4194-97bb-f696d16b8cf6
[I 2025-03-21 20:24:56,793] Trial 0 finished with value: 0.7443826198577881 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7443826198577881.
[I 2025-03-21 20:24:59,549] Trial 1 finished with value: 0.808435320854187 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7443826198577881.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:25:02,310] A new study created in memory with name: no-name-ce3cac6a-b0ef-40ea-9a96-f47eb01f1f81
[I 2025-03-21 20:25:05,492] Trial 0 finished with value: 0.7272870540618896 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7272870540618896.
[I 2025-03-21 20:25:08,176] Trial 1 finished with value: 0.8175264596939087 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7272870540618896.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:25:10,903] A new study created in memory with name: no-name-c1c760b6-bac0-4200-8c38-5106b86e5547
[I 2025-03-21 20:25:14,804] Trial 0 finished with value: 0.7879319787025452 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7879319787025452.
[I 2025-03-21 20:25:16,834] Trial 1 finished with value: 0.7834665179252625 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7834665179252625.
... storing 'Rank_Label' as categorical
2025-03-21 20:25:19,567 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3
Processing datasets for repeat 8:  80%|████████  | 8/10 [2:35:45<22:12, 666.50s/it]2025-03-21 20:25:19,569 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2
[I 2025-03-21 20:25:44,768] A new study created in memory with name: no-name-b245bd25-bf63-4fb5-b9ff-02fe7bfabe35
[I 2025-03-21 20:25:49,415] Trial 0 finished with value: 0.7165979743003845 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7165979743003845.
[I 2025-03-21 20:25:55,703] Trial 1 finished with value: 0.7653282284736633 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7165979743003845.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:25:59,111] A new study created in memory with name: no-name-9e97bb41-6228-4220-9564-4de6d28e877c
[I 2025-03-21 20:26:04,934] Trial 0 finished with value: 0.7910375595092773 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 0 with value: 0.7910375595092773.
[I 2025-03-21 20:26:11,347] Trial 1 finished with value: 0.7866647839546204 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 1}. Best is trial 1 with value: 0.7866647839546204.
... storing 'Rank_Label' as categorical
Found distributions with means close to 0 and 1 with 3 components.
Reject 27(8.33%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6686
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.1, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 160(49.38%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6417
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 13 components.
Reject 248(76.54%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7444
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7273
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 33(10.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7879
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7835
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7166
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7910
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7867
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 20:26:14,731] A new study created in memory with name: no-name-640377a6-bc55-4cd1-9e87-5c28bfeb8d1c
[I 2025-03-21 20:26:20,435] Trial 0 finished with value: 0.7854812741279602 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7854812741279602.
[I 2025-03-21 20:26:25,547] Trial 1 finished with value: 0.7021375894546509 and parameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7021375894546509.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:26:28,972] A new study created in memory with name: no-name-f3a09344-3daf-41c5-8c3a-de95ca4d91fd
[I 2025-03-21 20:26:32,621] Trial 0 finished with value: 0.741150975227356 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.8}. Best is trial 0 with value: 0.741150975227356.
[I 2025-03-21 20:26:37,665] Trial 1 finished with value: 0.729261040687561 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 1 with value: 0.729261040687561.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:26:41,272] A new study created in memory with name: no-name-4230c1a1-a039-4e40-a966-05156155675f
[I 2025-03-21 20:26:47,001] Trial 0 finished with value: 0.7968251705169678 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7968251705169678.
[I 2025-03-21 20:26:51,877] Trial 1 finished with value: 0.8089538216590881 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7968251705169678.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:26:55,248] A new study created in memory with name: no-name-95dc26ee-5580-4866-8194-fdfaf3c808d3
[I 2025-03-21 20:26:59,168] Trial 0 finished with value: 0.7915008664131165 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7915008664131165.
[I 2025-03-21 20:27:04,108] Trial 1 finished with value: 0.7908319234848022 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7908319234848022.
... storing 'Rank_Label' as categorical
2025-03-21 20:27:07,461 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2
Processing datasets for repeat 8:  90%|█████████ | 9/10 [2:37:33<08:11, 491.87s/it]2025-03-21 20:27:07,463 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1
[I 2025-03-21 20:27:40,713] A new study created in memory with name: no-name-328401a0-9fc6-4227-8c47-9eaea07d539a
[I 2025-03-21 20:27:46,162] Trial 0 finished with value: 0.7234058380126953 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7234058380126953.
[I 2025-03-21 20:27:52,185] Trial 1 finished with value: 0.6160216927528381 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 1 with value: 0.6160216927528381.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:27:55,821] A new study created in memory with name: no-name-cb1a1f2f-9f29-4ae0-9a02-26a86446cf2a
[I 2025-03-21 20:28:01,947] Trial 0 finished with value: 0.9239033460617065 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.9239033460617065.
[I 2025-03-21 20:28:08,506] Trial 1 finished with value: 0.6733632683753967 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.8}. Best is trial 1 with value: 0.6733632683753967.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:28:11,874] A new study created in memory with name: no-name-f751b751-fd53-4e0c-afc4-42ce71a5ed62
[I 2025-03-21 20:28:16,775] Trial 0 finished with value: 0.7720310091972351 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7720310091972351.
[I 2025-03-21 20:28:20,768] Trial 1 finished with value: 0.7954808473587036 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7720310091972351.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7855
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7021
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 1, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 329(64.89%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7412
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7293
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7968
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 198(39.05%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7915
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7908
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7234
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6160
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.9239
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6734
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7720
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 20:28:24,135] A new study created in memory with name: no-name-546d4fea-306d-4c96-923a-42c2ff2db291
[I 2025-03-21 20:28:27,561] Trial 0 finished with value: 0.821086049079895 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.8}. Best is trial 0 with value: 0.821086049079895.
[I 2025-03-21 20:28:30,867] Trial 1 finished with value: 0.7438670992851257 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 1 with value: 0.7438670992851257.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:28:34,437] A new study created in memory with name: no-name-fd3a194d-b0d6-432c-b1c7-820ad9dcef39
[I 2025-03-21 20:28:37,437] Trial 0 finished with value: 0.7894991636276245 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7894991636276245.
[I 2025-03-21 20:28:40,848] Trial 1 finished with value: 0.778932511806488 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.778932511806488.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:28:44,193] A new study created in memory with name: no-name-6559cb74-b560-4814-9990-e6202e3964c9
[I 2025-03-21 20:28:47,219] Trial 0 finished with value: 0.7825051546096802 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7825051546096802.
[I 2025-03-21 20:28:50,108] Trial 1 finished with value: 0.8002113103866577 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7825051546096802.
... storing 'Rank_Label' as categorical
2025-03-21 20:28:53,455 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1
Processing datasets for repeat 8: 100%|██████████| 10/10 [2:39:19<00:00, 372.74s/it]Processing datasets for repeat 8: 100%|██████████| 10/10 [2:39:19<00:00, 955.93s/it]
2025-03-21 20:28:53,457 - Repeat 8 completed
2025-03-21 20:28:53,457 - Starting repeat 9
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.8211
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7439
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7895
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7789
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_8/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7825
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Processing datasets for repeat 9:   0%|          | 0/10 [00:00<?, ?it/s]2025-03-21 20:28:53,464 - Processing dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10
[I 2025-03-21 20:29:16,116] A new study created in memory with name: no-name-e6c43928-1b95-4170-95a5-7e5c5ab95a7e
[I 2025-03-21 20:29:21,370] Trial 0 finished with value: 0.7744086980819702 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7744086980819702.
[I 2025-03-21 20:29:28,507] Trial 1 finished with value: 0.7494436502456665 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7494436502456665.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:29:30,495] A new study created in memory with name: no-name-7dbc65d8-47f2-4ebf-a2c4-49a4baa45125
[I 2025-03-21 20:29:36,467] Trial 0 finished with value: 0.8218543529510498 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.8218543529510498.
[I 2025-03-21 20:29:46,570] Trial 1 finished with value: 0.7620065212249756 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7620065212249756.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:29:48,526] A new study created in memory with name: no-name-46bf01d2-f437-4b24-a4e5-7720308ce3aa
[I 2025-03-21 20:29:53,052] Trial 0 finished with value: 0.7856945991516113 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7856945991516113.
[I 2025-03-21 20:29:57,116] Trial 1 finished with value: 0.7948556542396545 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.4, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7856945991516113.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:29:59,040] A new study created in memory with name: no-name-5079fb4f-d33c-4512-b747-8f745ecda46c
[I 2025-03-21 20:30:03,413] Trial 0 finished with value: 0.788777232170105 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 0 with value: 0.788777232170105.
[I 2025-03-21 20:30:09,471] Trial 1 finished with value: 0.7677642107009888 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7677642107009888.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:30:11,420] A new study created in memory with name: no-name-29ccf779-e32a-488e-8537-4f4ebd00ec9b
[I 2025-03-21 20:30:17,083] Trial 0 finished with value: 0.7788541913032532 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7788541913032532.
[I 2025-03-21 20:30:22,488] Trial 1 finished with value: 0.7811089754104614 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7788541913032532.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:30:24,405] A new study created in memory with name: no-name-b3e6cd60-df86-4a08-93d6-36f02be7975b
[I 2025-03-21 20:30:30,334] Trial 0 finished with value: 0.7902007102966309 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7902007102966309.
[I 2025-03-21 20:30:35,250] Trial 1 finished with value: 0.7928878664970398 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7902007102966309.
... storing 'Rank_Label' as categorical
2025-03-21 20:30:37,170 - Finished dataset Data10 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10
Processing datasets for repeat 9:  10%|█         | 1/10 [01:43<15:33, 103.71s/it]2025-03-21 20:30:37,171 - Processing dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9
[I 2025-03-21 20:31:07,753] A new study created in memory with name: no-name-0e71d8c5-5d16-4cb9-9861-1a3836a6a0c7
[I 2025-03-21 20:31:11,211] Trial 0 finished with value: 0.739719033241272 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.739719033241272.
[I 2025-03-21 20:31:15,301] Trial 1 finished with value: 0.7449535131454468 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.739719033241272.
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 322 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7744
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7494
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 168(39.16%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8219
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7620
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 70(16.32%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7857
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7888
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7678
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7789
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 100(23.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data10/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7902
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 263 genes up-regulated in Group 0 and 460 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7397
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:31:17,227] A new study created in memory with name: no-name-18abf5cc-7154-48a8-ad56-809a5546eb32
[I 2025-03-21 20:31:25,523] Trial 0 finished with value: 0.7523735761642456 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7523735761642456.
[I 2025-03-21 20:31:33,837] Trial 1 finished with value: 0.770455539226532 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7523735761642456.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:31:35,954] A new study created in memory with name: no-name-f77faf6a-889a-4ad9-81ae-3632a8b27a35
[I 2025-03-21 20:31:38,875] Trial 0 finished with value: 0.7026729583740234 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7026729583740234.
[I 2025-03-21 20:31:41,429] Trial 1 finished with value: 0.7038158178329468 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7026729583740234.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:31:43,451] A new study created in memory with name: no-name-a5fae6a6-e19d-4d50-ac7a-8dab00a3f9d3
[I 2025-03-21 20:31:47,259] Trial 0 finished with value: 0.7007735371589661 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.7007735371589661.
[I 2025-03-21 20:31:51,347] Trial 1 finished with value: 0.6970391869544983 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 1 with value: 0.6970391869544983.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:31:53,235] A new study created in memory with name: no-name-c6f3407b-c35c-4429-860f-fcaa856db904
[I 2025-03-21 20:31:57,034] Trial 0 finished with value: 0.7523308992385864 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7523308992385864.
[I 2025-03-21 20:32:00,231] Trial 1 finished with value: 0.6664218902587891 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.6664218902587891.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:32:02,151] A new study created in memory with name: no-name-81515018-5013-4641-9b86-30f1b88c8ca6
[I 2025-03-21 20:32:05,396] Trial 0 finished with value: 0.7980425357818604 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7980425357818604.
[I 2025-03-21 20:32:08,861] Trial 1 finished with value: 0.7914044857025146 and parameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7914044857025146.
... storing 'Rank_Label' as categorical
2025-03-21 20:32:10,995 - Finished dataset Data9 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9
Processing datasets for repeat 9:  20%|██        | 2/10 [03:17<13:03, 97.89s/it] 2025-03-21 20:32:10,997 - Processing dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8
[I 2025-03-21 20:40:45,562] A new study created in memory with name: no-name-1e141e1b-d1a4-48e4-b239-38e4e37fd181
[I 2025-03-21 20:45:03,605] Trial 0 finished with value: 0.5518820596777875 and parameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.7}. Best is trial 0 with value: 0.5518820596777875.
[I 2025-03-21 20:48:52,467] Trial 1 finished with value: 0.5688893691353176 and parameters: {'lr': 1e-05, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.5518820596777875.
... storing 'Rank_Label' as categorical
[I 2025-03-21 20:50:42,871] A new study created in memory with name: no-name-d5b2011c-6690-4261-a80a-39fee00d1b13
[I 2025-03-21 20:54:55,812] Trial 0 finished with value: 0.6205990703209586 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6205990703209586.
[I 2025-03-21 20:58:36,906] Trial 1 finished with value: 0.7208089958066526 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.4}. Best is trial 0 with value: 0.6205990703209586.
... storing 'Rank_Label' as categorical
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7524
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7027
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.1, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 245(57.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7008
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.6970
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7523
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6664
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Two distribution rejection faild.
Perform single distribution rejection.
Found distributions with means close to 1 with 2 components.
Reject 16(3.73%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data9/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7980
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7914
Best hyperparameters: {'lr': 0.006, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 811 genes up-regulated in Group 0 and 701 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.5519
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.1, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 7 components.
Reject 20995(89.59%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6206
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.3, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 21:00:25,928] A new study created in memory with name: no-name-4216a4c0-dcca-4bdb-bd0b-c482f03837fc
[I 2025-03-21 21:03:26,165] Trial 0 finished with value: 0.805109467195428 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.4}. Best is trial 0 with value: 0.805109467195428.
[I 2025-03-21 21:06:57,660] Trial 1 finished with value: 0.58405035475026 and parameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.1}. Best is trial 1 with value: 0.58405035475026.
... storing 'Rank_Label' as categorical
[I 2025-03-21 21:08:53,155] A new study created in memory with name: no-name-50dcc97e-8fd7-4e49-9973-8fec778e94f9
[I 2025-03-21 21:12:19,729] Trial 0 finished with value: 0.7783899670061858 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 1}. Best is trial 0 with value: 0.7783899670061858.
[I 2025-03-21 21:15:18,968] Trial 1 finished with value: 0.767881805482118 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 1 with value: 0.767881805482118.
... storing 'Rank_Label' as categorical
[I 2025-03-21 21:17:46,465] A new study created in memory with name: no-name-9487a583-4108-409e-ba2b-9f483a0a2d71
[I 2025-03-21 21:21:43,937] Trial 0 finished with value: 0.6935550363167472 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6935550363167472.
[I 2025-03-21 21:25:43,146] Trial 1 finished with value: 0.6607962924501171 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.6607962924501171.
... storing 'Rank_Label' as categorical
[I 2025-03-21 21:27:31,837] A new study created in memory with name: no-name-d863c992-3d99-47f7-a321-26dff40a267c
[I 2025-03-21 21:32:01,934] Trial 0 finished with value: 0.8181934900905775 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8181934900905775.
[I 2025-03-21 21:35:27,137] Trial 1 finished with value: 0.762173082517541 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 1 with value: 0.762173082517541.
... storing 'Rank_Label' as categorical
2025-03-21 21:37:15,984 - Finished dataset Data8 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8
Processing datasets for repeat 9:  30%|███       | 3/10 [1:08:22<3:34:14, 1836.29s/it]2025-03-21 21:37:15,987 - Processing dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7
[I 2025-03-21 21:49:29,651] A new study created in memory with name: no-name-62a0e992-76b4-4491-b28c-712d93274fe4
[I 2025-03-21 21:52:44,673] Trial 0 finished with value: 0.7541612853174624 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7541612853174624.
[I 2025-03-21 21:57:03,251] Trial 1 finished with value: 0.8311033119326052 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7541612853174624.
... storing 'Rank_Label' as categorical
[I 2025-03-21 21:58:52,560] A new study created in memory with name: no-name-860f9332-15cf-4ee0-aad5-97257ae3eeaf
[I 2025-03-21 22:03:03,126] Trial 0 finished with value: 0.7687639749568441 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7687639749568441.
[I 2025-03-21 22:07:40,234] Trial 1 finished with value: 0.847996825757234 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7687639749568441.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:09:37,507] A new study created in memory with name: no-name-e7c413af-f8f8-4f60-b870-66c0a77a853b
[I 2025-03-21 22:13:11,222] Trial 0 finished with value: 0.7548361161480779 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7548361161480779.
[I 2025-03-21 22:16:46,934] Trial 1 finished with value: 0.7346784524295641 and parameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7346784524295641.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8051
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.5841
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 10935(46.66%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7784
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7679
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6936
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6608
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 254(1.08%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data8/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8182
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7622
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 707 genes up-regulated in Group 0 and 445 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7542
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.6, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 96(0.41%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7688
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.01, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7548
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7347
Best hyperparameters: {'lr': 0.003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.001, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 747(3.19%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 22:19:38,310] A new study created in memory with name: no-name-78fb783c-18b2-4af3-9aa9-c7e7cd82fef7
[I 2025-03-21 22:23:43,171] Trial 0 finished with value: 0.7399998203567837 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7399998203567837.
[I 2025-03-21 22:27:16,604] Trial 1 finished with value: 0.7986515449440997 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7399998203567837.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:29:17,526] A new study created in memory with name: no-name-30f59e85-3faf-414c-b380-1d12cffc779d
[I 2025-03-21 22:34:19,874] Trial 0 finished with value: 0.7858625209849813 and parameters: {'lr': 1e-06, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0.8, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7858625209849813.
[I 2025-03-21 22:37:54,852] Trial 1 finished with value: 0.7308610677719116 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 1 with value: 0.7308610677719116.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:39:45,502] A new study created in memory with name: no-name-c5f5567e-47af-4239-a1c6-58671778c291
[I 2025-03-21 22:44:53,157] Trial 0 finished with value: 0.8059371398842853 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8059371398842853.
[I 2025-03-21 22:47:54,750] Trial 1 finished with value: 0.7614734561546989 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7614734561546989.
... storing 'Rank_Label' as categorical
2025-03-21 22:49:43,380 - Finished dataset Data7 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7
Processing datasets for repeat 9:  40%|████      | 4/10 [2:20:49<4:42:45, 2827.65s/it]2025-03-21 22:49:43,386 - Processing dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6
[I 2025-03-21 22:50:04,678] A new study created in memory with name: no-name-dee44dcc-6ff3-4245-959a-79e1c772539c
[I 2025-03-21 22:50:17,817] Trial 0 finished with value: 0.7517012357711792 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7517012357711792.
[I 2025-03-21 22:50:31,242] Trial 1 finished with value: 0.6976775527000427 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.2}. Best is trial 1 with value: 0.6976775527000427.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:50:34,332] A new study created in memory with name: no-name-48a0f004-9856-4316-b3fd-23064e420606
[I 2025-03-21 22:50:43,074] Trial 0 finished with value: 0.7738150954246521 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.05, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7738150954246521.
[I 2025-03-21 22:50:53,195] Trial 1 finished with value: 0.7190706431865692 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 1 with value: 0.7190706431865692.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:50:56,056] A new study created in memory with name: no-name-796a53c3-e501-48fe-a2fb-e636f088aaf0
[I 2025-03-21 22:51:09,084] Trial 0 finished with value: 0.6687223315238953 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6687223315238953.
[I 2025-03-21 22:51:17,516] Trial 1 finished with value: 0.651305764913559 and parameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 1 with value: 0.651305764913559.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:51:20,349] A new study created in memory with name: no-name-7e3b44e0-23b6-4015-a1da-f1bef4287f36
[I 2025-03-21 22:51:29,181] Trial 0 finished with value: 0.7727290987968445 and parameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7727290987968445.
[I 2025-03-21 22:51:41,640] Trial 1 finished with value: 0.795494556427002 and parameters: {'lr': 0.0006, 'n_epochs': 500, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7727290987968445.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7400
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7859
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.7309
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 9 components.
Reject 577(2.46%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data7/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8059
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7615
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 826 genes up-regulated in Group 0 and 707 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7517
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6977
Best hyperparameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.06, 'alpha_1': 0.9, 'alpha_2': 0.005, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7738
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7191
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6687
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6513
Best hyperparameters: {'lr': 0.01, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 19(1.18%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7727
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 22:51:44,472] A new study created in memory with name: no-name-938b0cca-35b2-4a0e-8a97-e289f9ba13e0
[I 2025-03-21 22:51:57,291] Trial 0 finished with value: 0.769048422574997 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 0 with value: 0.769048422574997.
[I 2025-03-21 22:52:08,598] Trial 1 finished with value: 0.7957021296024323 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.769048422574997.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:52:11,440] A new study created in memory with name: no-name-f92f6c84-1da0-4f3b-94d1-8c37c0bd47cd
[I 2025-03-21 22:52:20,265] Trial 0 finished with value: 0.8145232796669006 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8145232796669006.
[I 2025-03-21 22:52:27,319] Trial 1 finished with value: 0.7617126107215881 and parameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7617126107215881.
... storing 'Rank_Label' as categorical
2025-03-21 22:52:30,109 - Finished dataset Data6 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6
Processing datasets for repeat 9:  50%|█████     | 5/10 [2:23:36<2:35:40, 1868.10s/it]2025-03-21 22:52:30,115 - Processing dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5
[I 2025-03-21 22:53:01,497] A new study created in memory with name: no-name-9dce4d55-a1b3-4af4-aa76-aaec6090d570
[I 2025-03-21 22:53:09,682] Trial 0 finished with value: 0.7548553645610809 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7548553645610809.
[I 2025-03-21 22:53:17,833] Trial 1 finished with value: 0.7636692523956299 and parameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.7548553645610809.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:53:21,337] A new study created in memory with name: no-name-985f5b16-4844-4a81-99dd-3791b84f0640
[I 2025-03-21 22:53:29,968] Trial 0 finished with value: 0.7854239642620087 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7854239642620087.
[I 2025-03-21 22:53:37,772] Trial 1 finished with value: 0.8654508888721466 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7854239642620087.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:53:40,607] A new study created in memory with name: no-name-b4236a18-ef69-4eb7-afa2-2daed3407f33
[I 2025-03-21 22:53:47,716] Trial 0 finished with value: 0.821781188249588 and parameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0.7, 'alpha_2': 0.001, 'alpha_3': 0.4}. Best is trial 0 with value: 0.821781188249588.
[I 2025-03-21 22:53:57,436] Trial 1 finished with value: 0.7570530474185944 and parameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 1 with value: 0.7570530474185944.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:54:00,252] A new study created in memory with name: no-name-584decae-b8ee-4d7c-80c4-e7cc06816d1b
[I 2025-03-21 22:54:07,163] Trial 0 finished with value: 0.7517700493335724 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7517700493335724.
[I 2025-03-21 22:54:15,226] Trial 1 finished with value: 0.7451352775096893 and parameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 1 with value: 0.7451352775096893.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:54:18,058] A new study created in memory with name: no-name-153b1816-da86-4a5d-a767-25eed9ed1536
[I 2025-03-21 22:54:27,711] Trial 0 finished with value: 0.6929635107517242 and parameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}. Best is trial 0 with value: 0.6929635107517242.
[I 2025-03-21 22:54:35,894] Trial 1 finished with value: 0.7030074894428253 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.6929635107517242.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7690
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.005, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 5 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data6/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8145
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7617
Best hyperparameters: {'lr': 0.003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 766 genes up-regulated in Group 0 and 417 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7549
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 11 components.
Reject 1329(82.86%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7854
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0.05, 'alpha_3': 0.4}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8218
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7571
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0.05, 'alpha_3': 0.6}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7518
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7451
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.6930
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 38(2.37%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: [I 2025-03-21 22:54:38,745] A new study created in memory with name: no-name-56f01386-b764-4bab-8903-0b67de266999
[I 2025-03-21 22:54:47,946] Trial 0 finished with value: 0.834169328212738 and parameters: {'lr': 1e-06, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.834169328212738.
[I 2025-03-21 22:54:58,676] Trial 1 finished with value: 0.7876375019550323 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}. Best is trial 1 with value: 0.7876375019550323.
... storing 'Rank_Label' as categorical
2025-03-21 22:55:01,464 - Finished dataset Data5 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5
Processing datasets for repeat 9:  60%|██████    | 6/10 [2:26:08<1:25:37, 1284.41s/it]2025-03-21 22:55:01,465 - Processing dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4
[I 2025-03-21 22:55:40,921] A new study created in memory with name: no-name-dc910c01-5014-4372-b980-ad2fea63a054
[I 2025-03-21 22:55:46,209] Trial 0 finished with value: 0.7070154547691345 and parameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7070154547691345.
[I 2025-03-21 22:55:50,290] Trial 1 finished with value: 0.8462088108062744 and parameters: {'lr': 0.006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7070154547691345.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:55:53,078] A new study created in memory with name: no-name-b8567bb4-7149-4312-934b-6be76b0c3d51
[I 2025-03-21 22:56:00,492] Trial 0 finished with value: 0.7415710687637329 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7415710687637329.
[I 2025-03-21 22:56:07,707] Trial 1 finished with value: 0.7479500770568848 and parameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.1, 'alpha_1': 0.4, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7415710687637329.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:56:10,457] A new study created in memory with name: no-name-78e37362-33a2-4bf4-a92d-fc03fa305293
[I 2025-03-21 22:56:13,322] Trial 0 finished with value: 0.6492902040481567 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.9}. Best is trial 0 with value: 0.6492902040481567.
[I 2025-03-21 22:56:17,478] Trial 1 finished with value: 0.7011114358901978 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 1}. Best is trial 0 with value: 0.6492902040481567.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:56:20,194] A new study created in memory with name: no-name-10eb2b9b-02ab-4a7a-b822-5ddaa6499db6
[I 2025-03-21 22:56:23,091] Trial 0 finished with value: 0.7734619379043579 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7734619379043579.
[I 2025-03-21 22:56:27,212] Trial 1 finished with value: 0.7800984978675842 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7734619379043579.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:56:29,934] A new study created in memory with name: no-name-bc68bcd8-ad7f-473d-9cb2-52694fc63111
[I 2025-03-21 22:56:34,465] Trial 0 finished with value: 0.7328636646270752 and parameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7328636646270752.
[I 2025-03-21 22:56:39,129] Trial 1 finished with value: 0.7486661076545715 and parameters: {'lr': 0.001, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7328636646270752.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:56:41,842] A new study created in memory with name: no-name-26f99e39-5a7f-4508-9ce3-09f42df24215
[I 2025-03-21 22:56:44,420] Trial 0 finished with value: 0.7545797228813171 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7545797228813171.
[I 2025-03-21 22:56:47,726] Trial 1 finished with value: 0.7635741829872131 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7545797228813171.
... storing 'Rank_Label' as categorical
2025-03-21 22:56:50,428 - Finished dataset Data4 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4
Processing datasets for repeat 9:  70%|███████   | 7/10 [2:27:56<45:00, 900.13s/it]   2025-03-21 22:56:50,431 - Processing dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data5/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8342
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7876
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7070
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.8, 'alpha_2': 0.005, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 36(11.11%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7416
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.001, 'n_epochs': 400, 'alpha_0': 0.01, 'alpha_1': 1, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 1(0.31%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6493
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 52(16.05%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7735
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7329
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 4 components.
Reject 129(39.81%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data4/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7546
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 414 genes up-regulated in Group 0 and 465 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: [I 2025-03-21 22:57:28,291] A new study created in memory with name: no-name-b5e82952-c198-4966-ac52-1275286c7e89
[I 2025-03-21 22:57:32,833] Trial 0 finished with value: 0.7780975103378296 and parameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7780975103378296.
[I 2025-03-21 22:57:36,475] Trial 1 finished with value: 0.8279944062232971 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.3, 'alpha_2': 0.01, 'alpha_3': 0.9}. Best is trial 0 with value: 0.7780975103378296.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:57:39,242] A new study created in memory with name: no-name-19531d30-2b99-4d59-b00d-ac61f89c0371
[I 2025-03-21 22:57:44,783] Trial 0 finished with value: 0.7843202352523804 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 1, 'alpha_2': 0.001, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7843202352523804.
[I 2025-03-21 22:57:50,290] Trial 1 finished with value: 0.7291558384895325 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 1 with value: 0.7291558384895325.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:57:53,050] A new study created in memory with name: no-name-b1c93e8c-8357-4458-b398-1a35cbff8e30
[I 2025-03-21 22:57:56,234] Trial 0 finished with value: 0.6839574575424194 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 1, 'alpha_2': 0.01, 'alpha_3': 0.5}. Best is trial 0 with value: 0.6839574575424194.
[I 2025-03-21 22:58:00,500] Trial 1 finished with value: 0.6799713969230652 and parameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}. Best is trial 1 with value: 0.6799713969230652.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:58:03,267] A new study created in memory with name: no-name-3b2608f5-e4e9-42d9-b003-2f93bfdcdea5
[I 2025-03-21 22:58:06,111] Trial 0 finished with value: 0.7177462577819824 and parameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7177462577819824.
[I 2025-03-21 22:58:09,786] Trial 1 finished with value: 0.7938278913497925 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.005, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7177462577819824.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:58:12,529] A new study created in memory with name: no-name-e06a5ada-ec79-4096-9561-6cfa67354b97
[I 2025-03-21 22:58:16,630] Trial 0 finished with value: 0.7628077864646912 and parameters: {'lr': 1e-05, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.6, 'alpha_2': 0, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7628077864646912.
[I 2025-03-21 22:58:19,381] Trial 1 finished with value: 0.6962826251983643 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 1 with value: 0.6962826251983643.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:58:22,137] A new study created in memory with name: no-name-1e8280fd-43b1-4673-b4ff-a2493eed82d7
[I 2025-03-21 22:58:25,874] Trial 0 finished with value: 0.8002519011497498 and parameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}. Best is trial 0 with value: 0.8002519011497498.
[I 2025-03-21 22:58:29,939] Trial 1 finished with value: 0.8003711104393005 and parameters: {'lr': 0.003, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.4}. Best is trial 0 with value: 0.8002519011497498.
... storing 'Rank_Label' as categorical
2025-03-21 22:58:32,652 - Finished dataset Data3 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3
Processing datasets for repeat 9:  80%|████████  | 8/10 [2:29:39<21:32, 646.11s/it]2025-03-21 22:58:32,654 - Processing dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2
[I 2025-03-21 22:58:57,988] A new study created in memory with name: no-name-278edfaa-47da-4a3c-a666-1e4a58873120
[I 2025-03-21 22:59:03,209] Trial 0 finished with value: 0.7556564211845398 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7556564211845398.
[I 2025-03-21 22:59:07,343] Trial 1 finished with value: 0.7757138013839722 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.1}. Best is trial 0 with value: 0.7556564211845398.
... storing 'Rank_Label' as categorical
{'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7781
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.9, 'alpha_2': 0.01, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7843
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7292
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.6840
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.6800
Best hyperparameters: {'lr': 0.006, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.8, 'alpha_2': 0.05, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 6 components.
Reject 189(58.33%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7177
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 0.006, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0.1, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7628
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.6963
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.7, 'alpha_2': 0, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 5 components.
Reject 90(27.78%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data3/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8003
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Best hyperparameters: {'lr': 0.003, 'n_epochs': 500, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 459 genes up-regulated in Group 0 and 283 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7557
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0.6, 'alpha_2': 0.005, 'alpha_3': 0.7}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 51(10.06%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}[I 2025-03-21 22:59:10,789] A new study created in memory with name: no-name-e51d3a82-af2c-4a26-8948-55adce434e07
[I 2025-03-21 22:59:16,523] Trial 0 finished with value: 0.7843008041381836 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7843008041381836.
[I 2025-03-21 22:59:23,681] Trial 1 finished with value: 0.8349646329879761 and parameters: {'lr': 0.0006, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.4, 'alpha_2': 0.001, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7843008041381836.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:59:27,026] A new study created in memory with name: no-name-29709063-f5cc-42e7-9c0f-56227d2ee48c
[I 2025-03-21 22:59:33,232] Trial 0 finished with value: 0.7667956948280334 and parameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7667956948280334.
[I 2025-03-21 22:59:36,984] Trial 1 finished with value: 0.7899834513664246 and parameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0.9, 'alpha_2': 0.05, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7667956948280334.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:59:40,371] A new study created in memory with name: no-name-42f4fd67-ad18-473e-ab67-223d55aaaf2a
[I 2025-03-21 22:59:44,036] Trial 0 finished with value: 0.7891000509262085 and parameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 0 with value: 0.7891000509262085.
[I 2025-03-21 22:59:50,190] Trial 1 finished with value: 0.7909586429595947 and parameters: {'lr': 1e-05, 'n_epochs': 500, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.001, 'alpha_3': 0.7}. Best is trial 0 with value: 0.7891000509262085.
... storing 'Rank_Label' as categorical
[I 2025-03-21 22:59:53,519] A new study created in memory with name: no-name-d5110f20-2c76-4631-b23f-00a844a4a8e0
[I 2025-03-21 22:59:57,507] Trial 0 finished with value: 0.7668861746788025 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 0 with value: 0.7668861746788025.
[I 2025-03-21 23:00:03,177] Trial 1 finished with value: 0.8577883243560791 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7668861746788025.
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:00:06,623] A new study created in memory with name: no-name-08c312c3-5470-4a0d-af50-d96f99e0df7c
[I 2025-03-21 23:00:11,173] Trial 0 finished with value: 0.7962745428085327 and parameters: {'lr': 0.001, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.7962745428085327.
[I 2025-03-21 23:00:14,544] Trial 1 finished with value: 0.7911080121994019 and parameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}. Best is trial 1 with value: 0.7911080121994019.
... storing 'Rank_Label' as categorical
2025-03-21 23:00:17,872 - Finished dataset Data2 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2
Processing datasets for repeat 9:  90%|█████████ | 9/10 [2:31:24<07:57, 477.02s/it]2025-03-21 23:00:17,874 - Processing dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1
[I 2025-03-21 23:00:50,506] A new study created in memory with name: no-name-39bb1600-e5ff-403b-a254-5c4c70914c1c
[I 2025-03-21 23:00:55,376] Trial 0 finished with value: 0.7470030188560486 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.2}. Best is trial 0 with value: 0.7470030188560486.
[I 2025-03-21 23:01:00,368] Trial 1 finished with value: 0.7640718817710876 and parameters: {'lr': 0.001, 'n_epochs': 450, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.1, 'alpha_3': 0.4}. Best is trial 0 with value: 0.7470030188560486.
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:01:03,745] A new study created in memory with name: no-name-80d24bfa-709e-4bd9-9b14-1fec1f8592bc
[I 2025-03-21 23:01:10,547] Trial 0 finished with value: 0.7929177284240723 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}. Best is trial 0 with value: 0.7929177284240723.
[I 2025-03-21 23:01:14,689] Trial 1 finished with value: 0.8258423209190369 and parameters: {'lr': 0.0003, 'n_epochs': 450, 'alpha_0': 0.1, 'alpha_1': 0.2, 'alpha_2': 0.01, 'alpha_3': 0.3}. Best is trial 0 with value: 0.7929177284240723.
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:01:18,012] A new study created in memory with name: no-name-62ea0b93-c127-4ac8-b0c6-43527acb4888
[I 2025-03-21 23:01:22,775] Trial 0 finished with value: 0.8115854859352112 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.8, 'alpha_2': 0.01, 'alpha_3': 0.2}. Best is trial 0 with value: 0.8115854859352112.
[I 2025-03-21 23:01:26,213] Trial 1 finished with value: 0.7605063915252686 and parameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.9}. Best is trial 1 with value: 0.7605063915252686.

Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7843
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 1e-06, 'n_epochs': 300, 'alpha_0': 0.1, 'alpha_1': 0.5, 'alpha_2': 0.005, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7668
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 500, 'alpha_0': 0.01, 'alpha_1': 0.3, 'alpha_2': 0.005, 'alpha_3': 0.5}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 118(23.27%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7891
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Best hyperparameters: {'lr': 1e-05, 'n_epochs': 300, 'alpha_0': 0.03, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.7669
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0.5, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 210(41.42%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data2/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.7963
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7911
Best hyperparameters: {'lr': 0.006, 'n_epochs': 350, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.3}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
Starting load data for gene pair transformation.
Starting gene pair extraction.
Get candidate genes done.
There are 219 genes up-regulated in Group 0 and 1096 genes up-regulated in Group 1.
Get candidate gene pairs done.
Profile transformation done.
Starting save gene pair matrices.
Save gene pair matrices done.
Save informative gene matrices done.
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'DenseNet', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7470
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: DenseNet on device: cuda.
Best hyperparameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0.2, 'alpha_2': 0.001, 'alpha_3': 0.2}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'Transformer', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.7929
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: Transformer on device: cuda.
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.03, 'alpha_1': 0.5, 'alpha_2': 0.01, 'alpha_3': 0.8}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 3 components.
Reject 12(2.37%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 0 with Validation Loss = 0.8116
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda.
Saving model and plot for Trial 1 with Validation Loss = 0.7605
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 350, 'alpha_0': 0.1, 'alpha_1': 0.1, 'alpha_2': 0.1, 'alpha_3': 0.9}
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:01:29,596] A new study created in memory with name: no-name-5e7520d9-8226-48b9-9cd5-d9992e617cec
[I 2025-03-21 23:01:32,697] Trial 0 finished with value: 0.7479401230812073 and parameters: {'lr': 0.0006, 'n_epochs': 300, 'alpha_0': 0.005, 'alpha_1': 0, 'alpha_2': 0.05, 'alpha_3': 0.6}. Best is trial 0 with value: 0.7479401230812073.
[I 2025-03-21 23:01:35,726] Trial 1 finished with value: 0.7234605550765991 and parameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}. Best is trial 1 with value: 0.7234605550765991.
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:01:39,053] A new study created in memory with name: no-name-3750abfd-f250-4a8d-9758-be50014b1def
[I 2025-03-21 23:01:43,462] Trial 0 finished with value: 0.8643987774848938 and parameters: {'lr': 0.01, 'n_epochs': 450, 'alpha_0': 0.005, 'alpha_1': 0.2, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 0 with value: 0.8643987774848938.
[I 2025-03-21 23:01:47,103] Trial 1 finished with value: 0.8178960084915161 and parameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}. Best is trial 1 with value: 0.8178960084915161.
... storing 'Rank_Label' as categorical
[I 2025-03-21 23:01:50,440] A new study created in memory with name: no-name-6b2f6755-08c0-407f-aff1-86ec5fea9f9b
[I 2025-03-21 23:01:54,488] Trial 0 finished with value: 0.8048610687255859 and parameters: {'lr': 0.01, 'n_epochs': 400, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 0.5}. Best is trial 0 with value: 0.8048610687255859.
[I 2025-03-21 23:01:57,525] Trial 1 finished with value: 0.7642157673835754 and parameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}. Best is trial 1 with value: 0.7642157673835754.
... storing 'Rank_Label' as categorical
2025-03-21 23:02:00,886 - Finished dataset Data1 in /mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1
Processing datasets for repeat 9: 100%|██████████| 10/10 [2:33:07<00:00, 361.56s/it]Processing datasets for repeat 9: 100%|██████████| 10/10 [2:33:07<00:00, 918.74s/it]
2025-03-21 23:02:00,888 - Repeat 9 completed
2025-03-21 23:02:00,888 - All repeats completed
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 14 components.
Reject 360(71.01%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 0 with Validation Loss = 0.7479
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1.
Saving model and plot for Trial 1 with Validation Loss = 0.7235
Best hyperparameters: {'lr': 0.0003, 'n_epochs': 300, 'alpha_0': 0.01, 'alpha_1': 0, 'alpha_2': 0.01, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 0 with Validation Loss = 0.8644
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 2.
Saving model and plot for Trial 1 with Validation Loss = 0.8179
Best hyperparameters: {'lr': 0.0006, 'n_epochs': 450, 'alpha_0': 0.01, 'alpha_1': 0.1, 'alpha_2': 0, 'alpha_3': 0.9}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Found distributions with means close to 0 and 1 with 9 components.
Reject 60(11.83%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
The parameters setting of model is: {'n_features': 1000, 'nhead': 2, 'nhid1': 96, 'nhid2': 8, 'n_output': 32, 'nlayers': 3, 'n_pred': 2, 'n_patho': 0, 'dropout': 0.5, 'mode': 'Classification', 'infer_mode': 'SC', 'encoder_type': 'MLP', 'model_save_path': '/mnt/NAS_21T/ProjectResult/TiRank/results/ablation/intera_9/Data1/3_Analysis/checkpoints'}
Initiate model in trail 0 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 0 with Validation Loss = 0.8049
Initiate model in trail 1 with mode: Classification, infer mode: SC encoder type: MLP on device: cuda with abation on 1,2.
Saving model and plot for Trial 1 with Validation Loss = 0.7642
Best hyperparameters: {'lr': 0.001, 'n_epochs': 300, 'alpha_0': 0.06, 'alpha_1': 0, 'alpha_2': 0, 'alpha_3': 1}
Loading the Best Model.
Starting Inference.
Perform Rejection with GMM mode with tolerance=0.05, components=[3,15]!
Underfitting!
Found distributions with means close to 0 and 1 with 3 components.
Reject 0(0.00%) cells.
Inference Done.
We set Rank score < 0.5 as Rank- () while > 0.5 as Rank+ 
