

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tirank.Visualization &mdash; TiRank 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tirank.Visualization.DEG_analysis" href="tirank.Visualization.DEG_analysis.html" />
    <link rel="prev" title="tirank.Imageprocessing.ImageDataset" href="tirank.Imageprocessing.ImageDataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TiRank
              <img src="../_static/TiRank_white.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_input.html">Model Input</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CLI Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_st_survival.html">Tutorial 1: Spatial Transcriptomics (ST) + Cox Survival Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_sc_classification.html">Tutorial 2: scRNA-seq + Classification Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GUI Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial_web.html">TiRank Web App Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features Document</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../result_interpretation.html">Result Interpretation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hyperparameters.html">Hyperparameters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#core-model-training">Core Model &amp; Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#data-handling-preprocessing">Data Handling &amp; Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#feature-engineering">Feature Engineering</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#plotting-visualization">Plotting &amp; Visualization</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">tirank.Visualization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.DEG_analysis.html">tirank.Visualization.DEG_analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.DEG_volcano.html">tirank.Visualization.DEG_volcano</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.Pathway_Enrichment.html">tirank.Visualization.Pathway_Enrichment</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.create_boxplot.html">tirank.Visualization.create_boxplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.create_comparison_density_plot.html">tirank.Visualization.create_comparison_density_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.create_density_plot.html">tirank.Visualization.create_density_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.create_hist_plot.html">tirank.Visualization.create_hist_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.create_tensor.html">tirank.Visualization.create_tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.evaluate_on_test_data.html">tirank.Visualization.evaluate_on_test_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.model_predict.html">tirank.Visualization.model_predict</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_STmap.html">tirank.Visualization.plot_STmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_genepair.html">tirank.Visualization.plot_genepair</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_label_distribution_among_conditions.html">tirank.Visualization.plot_label_distribution_among_conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_loss.html">tirank.Visualization.plot_loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_score_distribution.html">tirank.Visualization.plot_score_distribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="tirank.Visualization.plot_score_umap.html">tirank.Visualization.plot_score_umap</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TiRank</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API Reference</a></li>
      <li class="breadcrumb-item active">tirank.Visualization</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/tirank.Visualization.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tirank-visualization">
<h1>tirank.Visualization<a class="headerlink" href="#tirank-visualization" title="Link to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">create_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_matrix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#create_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Converts a numpy array or list-like object to a float32 PyTorch tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_matrix</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – The input data matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data converted to a float32 PyTorch tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loss_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./loss_on_epoch.png'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Plots and saves the training loss curves over epochs.</p>
<p>This function takes a dictionary of loss values recorded at each epoch,
plots the trends for each loss type on a single graph, and saves
the plot to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loss_dict</strong> (<em>dict</em>) – A dictionary where keys are epoch identifiers
(e.g., ‘Epoch_1’) and values are dictionaries mapping loss
names (e.g., ‘total_loss’) to their numerical values.</p></li>
<li><p><strong>savePath</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path to save the resulting
loss plot. Defaults to “./loss_on_epoch.png”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">model_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#model_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generates predictions from a trained model based on the specified mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained PyTorch model to use for prediction.</p></li>
<li><p><strong>data_tensor</strong> (<em>torch.Tensor</em>) – The input data as a PyTorch tensor.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – The operational mode, determining how to interpret the
model’s output. Expected values are “Cox”, “Classification”,
or “Regression”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>pred_label (np.ndarray): Predicted labels. For “Classification”,
these are the class indices. For “Regression” and “Cox”,
this is the same as <cite>pred_prob</cite>.</p></li>
<li><p>pred_prob (np.ndarray): Predicted probability scores. For
“Classification”, this is the probability of class 1.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_score_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_score_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Plots the density distribution of prediction scores for bulk and single-cell data.</p>
<p>This function loads prediction dataframes for bulk and single-cell
experiments from pickled files, plots their “Pred_score” distributions
on a single density plot, and saves the figure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>savePath</strong> (<em>str</em>) – The root directory containing the ‘3_Analysis’
subfolder, which must hold ‘saveDF_bulk.pkl’ and
‘saveDF_sc.pkl’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_score_umap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_mode</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_score_umap"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Visualizes TiRank prediction scores and labels on UMAP and spatial plots.</p>
<p>This function loads an AnnData object and corresponding prediction scores.
It then generates and saves visualization plots based on the inference mode.
- For “SC” (single-cell) mode, it saves UMAP plots colored by score and label.
- For “ST” (spatial) mode, it saves UMAP and spatial plots colored by</p>
<blockquote>
<div><p>score and label.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing ‘2_preprocessing’ and
‘3_Analysis’ subdirectories.</p></li>
<li><p><strong>infer_mode</strong> (<em>str</em>) – The type of data being plotted, either “SC” or “ST”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <cite>infer_mode</cite> is not “SC” or “ST”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_label_distribution_among_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_label_distribution_among_conditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Plots the proportional distribution of TiRank labels within different groups.</p>
<p>This function loads prediction scores and calculates the frequency and
proportion of each ‘Rank_Label’ (‘Rank+’, ‘Rank-’, ‘Background’)
within the categories of a specified ‘group’ column (e.g., cell type,
cluster). It then saves a bar plot of these proportions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing the ‘3_Analysis’
subfolder.</p></li>
<li><p><strong>group</strong> (<em>str</em>) – The column name in ‘spot_predict_score.csv’ to use
for grouping the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the specified <cite>group</cite> column is not found in the
    loaded DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_STmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_STmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generates a composite spatial map for ST data showing cluster hubs.</p>
<p>This function is for Spatial Transcriptomics (ST) data. It loads
prediction scores, cluster-to-rank mappings from a JSON file, and the
AnnData object. It creates a new ‘new_Rank_Label’ based on the hub
classification (‘Rank+’, ‘Rank-’, ‘Background’) of each spot’s <cite>group</cite>.
It then saves a figure with three subplots:
1. Spatial plot colored by the original <cite>group</cite>.
2. The H&amp;E image alone.
3. Spatial plot colored by ‘new_Rank_Label’ overlaid on the H&amp;E image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing ‘2_preprocessing’ and
‘3_Analysis’.</p></li>
<li><p><strong>group</strong> (<em>str</em>) – The column name used for grouping (e.g., ‘cluster’)
which corresponds to the JSON file
(f”{group}_category_dict.json”).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the specified <cite>group</cite> column is not found in the
    loaded DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">DEG_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pvalue_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_p_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#DEG_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Performs and saves Differential Gene Expression (DEG) analysis.</p>
<p>This function loads a finalized AnnData object, computes DEGs between
‘Rank+’ and ‘Rank-’ groups using ‘wilcoxon’, saves all results,
and then saves a filtered list of DEGs based on log-fold-change and
p-value thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing the ‘3_Analysis’
subfolder, where ‘final_anndata.h5ad’ is located and
results will be saved.</p></li>
<li><p><strong>fc_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The fold-change threshold for
filtering. Defaults to 2.</p></li>
<li><p><strong>Pvalue_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – The p-value threshold for
filtering. Defaults to 0.05.</p></li>
<li><p><strong>do_p_adjust</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use adjusted p-values for
filtering. If False, use raw p-values. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">DEG_volcano</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pvalue_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_p_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#DEG_volcano"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Generates and saves a volcano plot for DEG results.</p>
<p>This function loads the ‘All DEGs dataframe.csv’ file, creates a
volcano plot (Log2(FoldChange) vs -Log10(P-value)), colors genes
based on significance thresholds, and annotates the top N most
significant up- and down-regulated genes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing the ‘3_Analysis’
subfolder.</p></li>
<li><p><strong>fc_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Fold-change threshold for coloring
and vertical lines. Defaults to 2.</p></li>
<li><p><strong>Pvalue_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – P-value threshold for coloring
and the horizontal line. Defaults to 0.05.</p></li>
<li><p><strong>do_p_adjust</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use adjusted p-values for
the Y-axis and filtering. If False, use raw p-values.
Defaults to True.</p></li>
<li><p><strong>top_n</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of top up- and down-regulated
genes to annotate. Defaults to 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">Pathway_Enrichment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KEGG_2016'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#Pathway_Enrichment"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Performs and plots pathway enrichment analysis on DEGs.</p>
<p>This function loads the filtered ‘Differentially expressed genes data frame.csv’,
separates genes into up-regulated and down-regulated lists, and
runs ‘gseapy.enrichr’ on the up, down, and all DEG lists using the
specified database. It saves the enrichment tables and dot plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savePath</strong> (<em>str</em>) – The base directory containing the ‘3_Analysis’
subfolder.</p></li>
<li><p><strong>database</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – The gene set library or libraries
to use for enrichment (e.g., “KEGG_2016”, [“GO_Biological_Process_2021”]).
Defaults to “KEGG_2016”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">evaluate_on_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_set</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bulk_gene_pairs_mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#evaluate_on_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Evaluates the model on external bulk RNA-seq test datasets.</p>
<p>This function iterates through a list of test dataset IDs. For each
dataset, it loads the expression and clinical metadata, transforms the
expression data into the gene-pair format, predicts labels using the
model, and saves the predictions along with a confusion matrix plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – The trained classification model.</p></li>
<li><p><strong>test_set</strong> (<em>list</em><em> of </em><em>str</em>) – A list of dataset identifiers (e.g., [‘GSE_ID1’])
to be loaded from <cite>data_path</cite>.</p></li>
<li><p><strong>data_path</strong> (<em>str</em>) – The directory containing the test data files, which
should be named like ‘{data_id}_meta.csv’ and ‘{data_id}_exp.csv’.</p></li>
<li><p><strong>save_path</strong> (<em>str</em>) – The root directory where results will be saved. A
‘bulk_test’ subdirectory will be created here.</p></li>
<li><p><strong>bulk_gene_pairs_mat</strong> (<em>pd.DataFrame</em>) – The gene-pair matrix used as a
template to transform the test expression data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">create_boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'True</span> <span class="pre">Label'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_column</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Predicted</span> <span class="pre">Score'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#create_boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a boxplot on a given axis with a Mann-Whitney U test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – DataFrame containing the plot data.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the subplot.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib axis to plot on.</p></li>
<li><p><strong>group_column</strong> (<em>str</em><em>, </em><em>optional</em>) – The column for the x-axis groups
(must contain two groups, 0 and 1). Defaults to “True Label”.</p></li>
<li><p><strong>score_column</strong> (<em>str</em><em>, </em><em>optional</em>) – The column for the y-axis numerical
values. Defaults to “Predicted Score”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">create_density_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#create_density_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a single density (KDE) plot on a given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – The data to plot.</p></li>
<li><p><strong>label</strong> (<em>str</em>) – The label for the data series in the legend.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib axis to plot on.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the subplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">create_hist_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#create_hist_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a histogram with a KDE overlay on a given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – The data to plot.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib axis to plot on.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the subplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">create_comparison_density_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#create_comparison_density_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Creates a density plot comparing two distributions on a given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data1</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – The first data series.</p></li>
<li><p><strong>label1</strong> (<em>str</em>) – Label for the first data series.</p></li>
<li><p><strong>data2</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – The second data series.</p></li>
<li><p><strong>label2</strong> (<em>str</em>) – Label for the second data series.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em>) – The matplotlib axis to plot on.</p></li>
<li><p><strong>title</strong> (<em>str</em>) – Title for the subplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">tirank.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_genepair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savePath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tirank/Visualization.html#plot_genepair"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Plots and saves a clustered heatmap of a gene-pair matrix.</p>
<p>If the input DataFrame has more rows than columns, it is sampled to be
square. Hierarchical clustering (‘average’ linkage, ‘euclidean’ metric)
is then applied to both rows and columns, and the resulting reordered
DataFrame is plotted as a heatmap.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The gene-pair DataFrame (e.g., samples vs. gene-pairs).</p></li>
<li><p><strong>data_type</strong> (<em>str</em>) – A string identifier (e.g., “bulk”, “sc”) used to
name the output file.</p></li>
<li><p><strong>savePath</strong> (<em>str</em><em>, </em><em>optional</em>) – The root directory containing the
‘2_preprocessing’ subfolder where the plot will be saved.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.DEG_analysis.html#tirank.Visualization.DEG_analysis" title="tirank.Visualization.DEG_analysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.DEG_analysis</span></code></a></p></td>
<td><p>Performs and saves Differential Gene Expression (DEG) analysis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.DEG_volcano.html#tirank.Visualization.DEG_volcano" title="tirank.Visualization.DEG_volcano"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.DEG_volcano</span></code></a></p></td>
<td><p>Generates and saves a volcano plot for DEG results.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.Pathway_Enrichment.html#tirank.Visualization.Pathway_Enrichment" title="tirank.Visualization.Pathway_Enrichment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.Pathway_Enrichment</span></code></a></p></td>
<td><p>Performs and plots pathway enrichment analysis on DEGs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.create_boxplot.html#tirank.Visualization.create_boxplot" title="tirank.Visualization.create_boxplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.create_boxplot</span></code></a></p></td>
<td><p>Creates a boxplot on a given axis with a Mann-Whitney U test.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.create_comparison_density_plot.html#tirank.Visualization.create_comparison_density_plot" title="tirank.Visualization.create_comparison_density_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.create_comparison_density_plot</span></code></a></p></td>
<td><p>Creates a density plot comparing two distributions on a given axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.create_density_plot.html#tirank.Visualization.create_density_plot" title="tirank.Visualization.create_density_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.create_density_plot</span></code></a></p></td>
<td><p>Creates a single density (KDE) plot on a given axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.create_hist_plot.html#tirank.Visualization.create_hist_plot" title="tirank.Visualization.create_hist_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.create_hist_plot</span></code></a></p></td>
<td><p>Creates a histogram with a KDE overlay on a given axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.create_tensor.html#tirank.Visualization.create_tensor" title="tirank.Visualization.create_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.create_tensor</span></code></a></p></td>
<td><p>Converts a numpy array or list-like object to a float32 PyTorch tensor.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.evaluate_on_test_data.html#tirank.Visualization.evaluate_on_test_data" title="tirank.Visualization.evaluate_on_test_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.evaluate_on_test_data</span></code></a></p></td>
<td><p>Evaluates the model on external bulk RNA-seq test datasets.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.model_predict.html#tirank.Visualization.model_predict" title="tirank.Visualization.model_predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.model_predict</span></code></a></p></td>
<td><p>Generates predictions from a trained model based on the specified mode.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.plot_STmap.html#tirank.Visualization.plot_STmap" title="tirank.Visualization.plot_STmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_STmap</span></code></a></p></td>
<td><p>Generates a composite spatial map for ST data showing cluster hubs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.plot_genepair.html#tirank.Visualization.plot_genepair" title="tirank.Visualization.plot_genepair"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_genepair</span></code></a></p></td>
<td><p>Plots and saves a clustered heatmap of a gene-pair matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.plot_label_distribution_among_conditions.html#tirank.Visualization.plot_label_distribution_among_conditions" title="tirank.Visualization.plot_label_distribution_among_conditions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_label_distribution_among_conditions</span></code></a></p></td>
<td><p>Plots the proportional distribution of TiRank labels within different groups.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.plot_loss.html#tirank.Visualization.plot_loss" title="tirank.Visualization.plot_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_loss</span></code></a></p></td>
<td><p>Plots and saves the training loss curves over epochs.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="tirank.Visualization.plot_score_distribution.html#tirank.Visualization.plot_score_distribution" title="tirank.Visualization.plot_score_distribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_score_distribution</span></code></a></p></td>
<td><p>Plots the density distribution of prediction scores for bulk and single-cell data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="tirank.Visualization.plot_score_umap.html#tirank.Visualization.plot_score_umap" title="tirank.Visualization.plot_score_umap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tirank.Visualization.plot_score_umap</span></code></a></p></td>
<td><p>Visualizes TiRank prediction scores and labels on UMAP and spatial plots.</p></td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tirank.Imageprocessing.ImageDataset.html" class="btn btn-neutral float-left" title="tirank.Imageprocessing.ImageDataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tirank.Visualization.DEG_analysis.html" class="btn btn-neutral float-right" title="tirank.Visualization.DEG_analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, LenisLin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>